<!DOCTYPE html>
<html lang="en" class="ie8">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<title>Spine Admin | Manage Everything Here</title>
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
	<meta content="" name="description" />
	<meta content="" name="author" />
	<!-- ================== BEGIN WEBQR JS ================== -->
	<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	
	<script src="js/login.js" type="text/javascript"></script>
	<script src="js/app_user.js" type="text/javascript"></script>
	<script src="js/camera.js" type="text/javascript"></script>
	<script src="cordova.js" type="text/javascript"></script>
	<script src="js/Measure.js" type="text/javascript"></script>
	<script src="js/OnlineMeasureEdit.js" type="text/javascript"></script>
	
	
	<!-- ================== END WEBQR JS ================== -->
	<style>
	    .btn-group{
		margin-bottom: 0;
	    }  
	    *{
	      font-size: 20px;
	    }
	    input{
		font-size: 17px !important;
	    }
	    /*
	    @media only screen and (max-width: 768px){
	    .rowfixedtop{
		margin-top: -54px
	      }
	    .input-group{
	      width: 100% !important;
	    }
	    }*/
	    .panel-default > .panel-heading {
	      background-color: #00acac !important;
	    }
	    
	</style>

	<!-- ================== BEGIN BASE CSS STYLE ================== -->
	<link href="assets/plugins/jquery-ui/themes/base/minified/jquery-ui.min.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="assets/css/intlTelInput.css">
	<!--<link rel="stylesheet" href="assets/css/demo.css">-->
	<link href="assets/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" />
	<link href="assets/css/animate.min.css" rel="stylesheet" />
		<link href="assets/css/theme/default-spine.css" rel="stylesheet" id="theme" />
	<link href="assets/css/style-spine.min.css" rel="stylesheet" />
		<link href="assets/css/style-responsive.min.css" rel="stylesheet" />
        <link href="assets/plugins/bootstrap-validation/css/bootstrapValidator.css" rel="stylesheet" />
	
	<!--<link href="assets/css/awesomplete.css" rel="stylesheet" />-->
	<!-- ================== END BASE CSS STYLE ================== -->
	
	<!--Date Time Picker Plugin Start-->
        <link rel="stylesheet" type="text/css" href="assets/timepicker/css/jquery.countdownTimer.css" />
	<!--Date Time Picker Plugin End-->
	
	<!-- ================== BEGIN PAGE LEVEL STYLE  wizard================== -->
	<link href="assets/plugins/bootstrap-wizard/css/bwizard.min.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
	<!-- apps lable css-->
	  <link rel="stylesheet" type="text/css" href="assets/css/appslable.css" />
	<!-- end-->
		
	<!-- ================== START SELECT PICKER GO================== -->
	
	<!--<link rel="stylesheet" href="assets/selectpicker/css/bootstrap-select_table.css">-->
	<!--loader-->
	<link href="css/jquery.loader.css" rel="stylesheet" />
	<!--end loader-->
	
	<!-- ================== END SELECT PICKER GO================== -->
	
	
	<!-- ================== BEGIN PAGE LEVEL STYLE Data tables================== -->
	<link href="assets/plugins/DataTables/css/data-table.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL STYLE Form plugin================== -->
	<link href="assets/plugins/bootstrap-datetimepicker2/css/bootstrap-datetimepicker.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-datepicker/css/datepicker.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-datepicker/css/datepicker3.css" rel="stylesheet" />
	<link href="assets/plugins/ionRangeSlider/css/ion.rangeSlider.css" rel="stylesheet" />
	<link href="assets/plugins/ionRangeSlider/css/ion.rangeSlider.skinNice.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css" rel="stylesheet" />
	<link href="assets/plugins/password-indicator/css/password-indicator.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-combobox/css/bootstrap-combobox.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-select/bootstrap-select.min.css" rel="stylesheet" />
	<link href="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.css" rel="stylesheet" />
	<link href="assets/plugins/jquery-tag-it/css/jquery.tagit.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
       <!-- ================== CART CSS START ================== -->
       <link href="assets/css/checkout-cornerflat.css" rel="stylesheet" />
       <!-- ================== CART CSS END ================== -->
	<!-- ================== BEGIN PAGE LEVEL STYLE show or hide column================== -->
	<link href="assets/plugins/DataTables/css/data-table.css" rel="stylesheet" />
    <link href="assets/plugins/gritter/css/jquery.gritter.css" rel="stylesheet" />
	<!-- ================== END PAGE LEVEL STYLE ================== -->
	
	<!-- ================== Browse button custom and switchery================== -->
	<link href="assets/plugins/browse-button/filecss.css" rel="stylesheet" />
	<link href="assets/plugins/switchery/switchery.min.css" rel="stylesheet" />
	<link href="assets/Burtlanassets/include/css/chosen.css" rel="stylesheet" />
	<!-- ================== START PAGE LEVEL STYLE ================== -->
	<!--cropper css-->
	<link rel="stylesheet" href="assets/plugins/cropper/css/cropper.min.css">
	<link rel="stylesheet" href="assets/plugins/cropper/css/main.css">
	<!--cropper css ends-->
	<!--lc switch start by pravinkmr on 11/5/2015-->
	<link href="assets/plugins/LC-switch-master/lc_switch.css" rel="stylesheet" />
	<!--lc switch start by pravinkmr-->
	
	<!-- ================== JS ================== -->
	
	<!-- sweetalert start -->
	<link href="assets/sweetalert/dist/sweetalert-override.min.css" rel="stylesheet">
	<script src="assets/sweetalert/dist/sweetalert.min.js"></script>
	<!-- sweetalert ends -->

        <!-- ================== BEGIN BASE JS ================== -->
	
	
	<!--==========ITS ONLY WORKING FOR THE REPORT MAP CONCEPT===========--->
	<script src="assets/js/jquery-1.11.3.min.js"></script>
	<!--==========ITS ONLY WORKING FOR THE REPORT MAP CONCEPT===========--->
	
	<!--Added by Elango for sale invoice report-->
	<!--<link href="assets/css/jquery.dataTables.min.css" rel="stylesheet" />-->
	<script src="assets/js/jquery.dataTables.min.js"></script>
	<!--CHART ASSETS-->
	<script src="assets/plugins/chart/amcharts.js"></script>
	<script src="assets/plugins/chart/pie.js"></script>
	<script src="assets/plugins/chart/serial.js"></script>

	<link href="assets/scrollplugin/jquery.mCustomScrollbar.css" rel="stylesheet" />
	<script src="assets/scrollplugin/jquery.mCustomScrollbar.concat.min.js"></script>
	<!--CHART ASSETS-->
	<!--Added by Elango for sale invoice report-->
	<script src="assets/plugins/browse-button/filejs.js"></script>

	
	
	<!--FOR FLIP CLOCLK TIMER START-->
	<link rel="stylesheet" href="assets/compiled/flipclock.css">
	<link rel="stylesheet" href="assets/plugins/bootstrap-wysihtml5/src/bootstrap-wysihtml5.css"  />
	<link rel="stylesheet" href="assets/plugins/BootstrapStar/star-rating.css" />
	
	<script src="assets/compiled/flipclock.js"></script>
			<!--FOR FLIP CLOCLK TIMER END-->
		<!-- ================== BEGIN BASE JS ================== -->
	<script src="assets/plugins/pace/pace.min.js"></script>
	<!-- ================== END BASE JS ================== -->
        
		<!--<script src="http://cdn.jagansindia.in/webrupee" type="text/javascript"></script>-->
	<script src="assets/plugins/jquery/jquery-migrate-1.1.0.min.js"></script>
	<script src="assets/plugins/jquery-ui/ui/minified/jquery-ui.min.js"></script>
	
	<script src="assets/js/intlTelInput.js"></script>
	<script src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
        <script src="assets/plugins/bootstrap-validation/js/bootstrapValidator.js"></script>
	<!--Dashboard Start-->
	<script src="assets/js/dashboard.min.js"></script>
	<script src="assets/plugins/flot/jquery.flot.min.js"></script>
	<script src="assets/plugins/sparkline/jquery.sparkline.js"></script>
	<!--Dashboard End-->
	
	<!--[if lt IE 9]>
		<script src="assets/crossbrowserjs/html5shiv.js"></script>
		<script src="assets/crossbrowserjs/respond.min.js"></script>
		<script src="assets/crossbrowserjs/excanvas.min.js"></script>
	<![endif]-->
	<!--Added by Elango for sale Order-->
	<script src="assets/plugins/slimscroll/jquery.slimscroll.min.js"></script>
	<script src="assets/plugins/jquery-cookie/jquery.cookie.js"></script>
	<script src="assets/plugins/isotope/jquery.isotope.min.js"></script>
	<script src="assets/plugins/lightbox/js/lightbox-2.6.min.js"></script>
	<script src="assets/js/gallery.demo.min.js"></script>
	<link href="assets/plugins/isotope/isotope.css" rel="stylesheet" />
	<link href="assets/plugins/lightbox/css/lightbox.css" rel="stylesheet" />
        <!--Added by Elango for sale Order-->
	
	<!--Added by Senthil for sale Quotation-->
	<script src="assets/plugins/bootstrap-wysihtml5/lib/js/wysihtml5-0.3.0.js"></script>
	<script src="assets/plugins/bootstrap-wysihtml5/src/bootstrap-wysihtml5.js"></script>
	<script src="assets/js/form-wysiwyg.demo.min.js"></script>
	<!--Added by Senthil for sale Quotation-->
	<!--====================== MOMENT JS INCLUDE ===============-->
	<script src="assets/plugins/moment/moment.min.js"></script>
	<!--====================== MOMENT JS INCLUDE ===============-->

	<!-- ================== START EXPORT================== -->
	<script type="text/javascript" src="assets/plugins/export/tableExport.js"></script>
        <script type="text/javascript" src="assets/plugins/export/jquery.base64.js"></script>
	<script type="text/javascript" src="assets/plugins/export/jspdf/libs/sprintf.js"></script>
	<script type="text/javascript" src="assets/plugins/export/jspdf/jspdf.js"></script>
	<script type="text/javascript" src="assets/plugins/export/jspdf/libs/base64.js"></script>
	<!-- ================== END EXPORT================== -->
	<!--<script src="assets/selectpicker/js/bootstrap-select_table.js"></script>-->
	 
	<script src="assets/plugins/bootstrap-select/bootstrap-select.min.js"></script>
	<!--<script src="assets/Burtlanassets/bootstrap-select/bootstrap-select1.min.js"></script>-->
	<!-- ================== END BASE JS ================== -->
	


	
	<!-- ================== BEGIN PAGE LEVEL JS Form plugin================== -->
	<script src="assets/plugins/bootstrap-datetimepicker2/js/moment-with-locales.js"></script>
	<script src="assets/plugins/bootstrap-datetimepicker2/js/bootstrap-datetimepicker.min.js"></script>
	<!--<script src="assets/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>-->
	<script src="assets/plugins/ionRangeSlider/js/ion-rangeSlider/ion.rangeSlider.min.js"></script>
	<script src="assets/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.min.js"></script>
	<script src="assets/plugins/masked-input/masked-input.min.js"></script>
	<script src="assets/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
	<script src="assets/plugins/password-indicator/js/password-indicator.js"></script>
	<script src="assets/plugins/bootstrap-combobox/js/bootstrap-combobox.js"></script>
	<script src="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput.min.js"></script>
	<script src="assets/plugins/bootstrap-tagsinput/bootstrap-tagsinput-typeahead.js"></script>
	<script src="assets/plugins/jquery-tag-it/js/tag-it.min.js"></script>
	<script src="assets/js/form-plugins.demo.min.js"></script>
	<script src="assets/js/apps.min.js"></script>
	<!--<script src="assets/js/polyfiller.js"></script>-->
	<!-- ================== END PAGE LEVEL JS ================== -->
	
	<!-- ================== BEGIN PAGE LEVEL JS hide column================== -->
	<script src="assets/plugins/DataTables/js/jquery.dataTables.js"></script>
	<script src="assets/plugins/DataTables/js/dataTables.autoFill.js"></script>
	<!--<script src="assets/plugins/DataTables/js/dataTables.colReorder.js"></script>-->
	<script src="assets/plugins/DataTables/js/dataTables.colVis.js"></script>
	<script src="assets/plugins/DataTables/js/dataTables.fixedHeader.js"></script>
	<script src="assets/plugins/DataTables/js/dataTables.keyTable.js"></script>
	<script src="assets/plugins/DataTables/js/dataTables.tableTools.js"></script>
	<script src="assets/plugins/DataTables/js/dataTables.responsive.js"></script>
	<script src="assets/js/table-manage-responsive.demo.min.js"></script>	
	<script src="assets/plugins/gritter/js/jquery.gritter.js"></script>
	<script src="assets/js/table-manage-combine.demo.min.js"></script>
	<!-- ================== END PAGE LEVEL JS ================== -->
	
	
	<!-- ================== BEGIN PAGE LEVEL JS wizard ================== -->

	<script src="assets/plugins/bootstrap-wizard/js/bwizard.js"></script>
	<script src="assets/js/form-wizards.demo.min.js"></script>
	<script src="assets/js/apps.min.js"></script>
	<!-- ================== END PAGE LEVEL JS ================== -->
	<!-- ================== BEGIN PAGE LEVEL Currency Format ================== -->
	<script type="text/javascript" src="assets/js/jquery.formatCurrency-1.4.0.js"></script>
	<!-- ================== END PAGE LEVEL JS ================== -->
	
	<!-- ================== Begin Cropper packages================== -->
	<script src="assets/cropper/js/yui-min.js"></script>
	<link href="assets/cropper/css/style.css" rel="stylesheet" />
	<script src="assets/cropper/js/cropbox.js"></script>
	<script src="assets/cropper/js/cropbox-min.js"></script>
	<!-- ================== End Cropper packages================== -->
	
	
	<!-- ================== Begin formValidation packages================== -->
	<!--<link href="assets/plugins/formValidation/css/formValidation.css" rel="stylesheet" />
	<script src="assets/plugins/formValidation/js/formValidation.js"></script>
	<script src="assets/plugins/formValidation/js/framework/bootstrap.min.js"></script>-->
	<!-- ================== End formValidation packages================== -->
	
	<!-- ================== Begin switchery packages================== -->
	<script src="assets/plugins/switchery/switchery.min.js"></script>
	<script src="assets/js/form-slider-switcher.demo.min.js"></script>
	<!-- ================== end switchery packages================== -->
	<script src="assets/Burtlanassets/include/js/chosen.jquery.js"></script>
	<!--cropper js-->
	<script src="assets/plugins/cropper/js/cropper.min.js"></script>
	<script src="assets/plugins/cropper/js/main.js"></script>
	<script src="assets/plugins/BootstrapStar/star-rating.js"></script>
	<script>var WebBarCode = ""</script>
	
	<!--cropper js ends-->
	<!--lc switch js-->
	<script type="text/javascript" src="assets/plugins/LC-switch-master/lc_switch.js"></script>
	<!--lc switch js end-->
		
	<script>
		$(document).ready(function() {
			App.init();
						//FormWizardValidation.init();

			//FormPlugins.init();
			//TableManageResponsive.init();
		});
	</script>
	<!-- ================== BEGIN WEBQR JS ================== -->
			<script src="assets/js/bootbox.min.js"></script>
			<!--<script type="text/javascript" src="assets/plugins/qrjs/llqrcode.js"></script>-->
			<!--<script type="text/javascript" src="assets/plugins/qrjs/webqr.js"></script>-->
			<!--<script type="text/javascript" src="assets/plugins/qrjs/plusone.js"></script>-->
			
		<!-- ================== END WEBQR JS ================== -->
	<!--loader js-->
	<script type="text/javascript" src="assets/plugins/loader/jquery.loader.js"></script>
	<!-- <script type="text/javascript" src="assets/plugins/qrjs/plusone.js"></script>
	
	

	<!--unloader js-->
	<style>
	    .table_input{
		width: auto;
	    }
	    
	.dataTables_scroll{
		margin-bottom: 10px;
	}
	.btn-group{
	    margin-bottom: 0;
	}
	
	.btn-new {
	-moz-user-select: none;
	background-image: none;
	border: 1px solid transparent;
	border-radius: 4px;
	cursor: pointer;
	display: block;
	font-size: 14px;
	font-weight: 400;
	line-height: 1.42857;
	margin-bottom: 0;
	padding: 6px 12px;
	text-align:center;
	vertical-align: middle;
	white-space: nowrap;
	width: 85%;
	}
	
	.statusWidth{
	width: 100px;
	}
	
	.btn-new.btn-new-inverse {
	background: #2d353c none repeat scroll 0 0;
	border-color: #2d353c;
	color: #fff;
	}
	a:focus, a:hover {
        text-decoration: none;
	}
	.textRight{
	    text-align:right;
	}

	
	.dataTables_filter{  float: left !important;  margin-right: 10px; }
	.dataTables_length{  float: right !important; }
	.dataTables_filter input{margin-left: 0px;}
	.trcalign{float:left;}
	/*---------for responsive table line tab alignment------------*/
	
	/*for line alignment*/
	
	.forResponsiveLine{
		min-height:300px;
	}
	.responseBinLine{
		min-height: 170px;
	}	
	.bootstrap-select.btn-group .dropdown-menu{
		z-index: 1000 !important;
	}
	
	/*for line alignment*/
	
	
	/*READ ONLY FIELD LIGHTEN*/
	/*.form-control[disabled], .form-control[readonly], fieldset[disabled] .form-control {
	background: #e5e9ed none repeat scroll 0 0;
	opacity: 1;
	}*/
	
	/*READ ONLY FIELD LIGHTEN*/
	
	
	</style>
	<style>
	.forNewCustomer[readonly]{
	background-color: #7fdbff !important;
	color: black;
	font-weight: 700;
	opacity:1;
	}
	.forExistCustomer[readonly]{
	background-color:#FFCCE6 !important;
	color:black;
	font-weight: 700;
	opacity:1;
	}
	</style>
	<style>
	    .modal.modal-loading .modal-body{
		position:relative;
		z-index:0
	    }
	    .modal.modal-loading.modal-expand .modal-body{
		position:absolute
	    }
	    .modal.modal-loading .modal-body .modal-loader{
		position:absolute;
		left:0;
		right:0;
		top:0;
		bottom:0;
		background:#fff;
		opacity:.9;
		filter:alpha(opacity=90);
		animation:fadeIn .2s;
		-webkit-animation:fadeIn .2s;
		z-index:1020;
		-webkit-border-radius:0 0 4px 4px;
		-moz-border-radius:0 0 4px 4px;
		border-radius:0 0 4px 4px
	    }
	    @keyframes fadeIn{
		from{
		    opacity:0
		}
		to{
		    opacity:1
		}
	    }
	    @-webkit-keyframes fadeIn{
		from{
		    opacity:0
		}
		to{
		    opacity:1
		}
	    }
	    .color-icon{
		 color:#005452;
	    }
	</style>
	<style>
	    /*added by rafeeq */
	/*for responsive selectpicker in tablet added on 22-Sep-2015*/
	.printPadding{ /*for print in transaction*/
	    padding: 0px;
	}
	.dropdown-menu > li > a {
	   white-space: normal !important;
	}
	/*for responsive selectpicker in tablet added on 22-Sep-2015*/
	.sendLogi {
	    background-color: yellowgreen;
	    color: black;
	    font-weight: 600;
	    padding: 5px;
	    white-space: nowrap;
	    border-radius: 5px;
	}
	.tableAttachment {
	    margin-bottom: 20px;
	    max-width: 100%;
	    width: 65%;
	}
	.oppButton{
	    padding: 15px;
	}
	.journeyClicked{
	    background-color: green !important;
	    border-color: green !important;
	    color: white;
	    width: 103%;
	}
	.journey{
	    background-color: grey;
	    border-color: grey !important;
	    color: white;
	    width: 103%;
	}
	
	.journey:hover{
	    background-color: #558255;
	    color: white;
	}
	.journeyClicked:hover{
	    background-color: #558255;
	    color: white;
	}
	/*.bootstrap-select:not([class*="span"]):not([class*="col-"]):not([class*="form-control"]):not([class*="table_input"]):not(.input-group-btn) {
	    width: 135px !important;
	}*/
	.goLeft{ /*added for pagination */
	    float: left; 
	    margin-left: 5px;
	}
	.goRight{ /*added for align right in price values */
	    direction: rtl;
	}
	.goRightAd{ /*added for align right in price values */
	    direction: rtl;
	}
	/*added by rafeeq */
	/*added by DarrenSelva */
	#addedWrap li a{
	 white-space: nowrap !important;
	}
	.tableTextwap{
	    width: 160px;
	    white-space: nowrap;
	    overflow: hidden;
	    text-overflow: ellipsis;
	}
	</style>
	<style>
		    #model-bgCss{
				    width: 50px;
				    border-radius:50%;
				    height: 50px;
				    padding: 12px;
				    color:#fff;
		    }
		    .form-control[readonly]{
			    opacity: 1 !important;
		    }
		    a.ex1:hover, a.ex1:active {color: red;}
		    
		    .media-object.bg-red {
				border-radius: 50%;
				color: #fff;
				font-size: 14px;
				height: 36px;
				line-height: 36px;
				text-align: center;
				width: 36px;
			}
	    .testmedia:hover
	    {
	    color:#262626;
	    text-decoration:none;
	    background-color:#f5f5f5;
	    }
	    
	    </style>
		<style>
		#measurementTab {
		    max-height: 500px;
		    overflow-y: scroll;
			box-shadow: 10px 10px 5px #888888;
		}
		.table_input2
		{
		    width:270px;
		}
		.continer {
		    margin-bottom: 15px;
		}		
		#myCanvas {
		    display: block;
		    padding: 0;
		    margin: 0 auto;
		}		
		@media(max-width:1200px) {
		    .container {
			margin: 0 50px;
		    }
		    #myCanvas {
			width: 100%;
			height: auto;
			background-color:#0C6CD0;
		    }
		}
	    </style>
	    <style>
		
		#wallDesign
		{
		    background-image: url(assets/img/bgm.jpg);
		    float: left;
		}
		
		#productDesign
		{
		   float: left;
		}
		
		#productDesign img
		{
		    width: 100%;
		}
		
		#previewBox
		{
		    float: left;
		    height: 50%;
		    width: 50%;
		}
		#measurementTab li{
		    list-style: none;
		}
		.fa{
		    cursor:pointer;
		}
		.tree ul li.active > a:before {
		    background-position: 0 center;
		}
		.tree ul{
		    padding-left: 15px;
		}
		.tree ul li ul {
		    border-left: 1px dotted #756a6c;
		    display: none;
		    margin: 1px 0 0 4px;
		    overflow: hidden;
		    padding-left: 12px;
		}
		.tree ul li ul li {
		    position: relative;
		}
		.tree ul li ul li:before {
		    border-bottom: 1px dotted #756a6c;
		    content: "";
		    left: -39px;
		    position: absolute;
		    top: 33px;
		    width: 38px;
		}
		.label.sedar-color {
		    margin: 0 0 0 11px;
		    border-radius: 3px 3px 0 0;
		}
		.form-control.input-sm.sedar{
		    border: 2px solid #FC992B;
		    border-radius:0 0 0 3px !important;
		}
		.btn-group-xs > .btn, .btn-xs {
		    font-size: 8px;
		    padding: 0 1px;
		}
		.sedar-color{
		    background-color:#FC992B;
		}
		.fa-trash{
		    color: #7A92A4;
		}
		.sedar-white{
		    background-color: #DCD6D1;
		}
		.btn-success{
		    background-color:#2E8591 !important;
		}
		.fa-road{
		    color: #FC992B;
		}
		.panel-heading {
		    border: 1px solid #ddd !important;
		}
		.pull-left.width-full.custom {
		    position: absolute;
		}
	    </style>	
	    
	<link href="assets/plugins/formValidation/css/formValidation.css" rel="stylesheet"/>
	    <script src="assets/plugins/formValidation/js/formValidation.js"></script>
	    <script src="assets/plugins/formValidation/js/framework/bootstrap.min.js"></script>
</head>
<body>
    <!-- begin #page-container -->
    <div id="page-container" class="fade in page-sidebar-fixed page-header-fixed">
        <!-- begin #header -->
        <div id="header" class="header navbar navbar-default navbar-fixed-top">
            <!--<div class="navbar-header">-->
                    <a class="navbar-brand">
		      <span class="">
			<img src="assets/img/mantis_logo.jpg" data-id="login-cover-image" alt="" />
		      </span>
		    </a>
                   <ul class="nav navbar-nav navbar-right">
                  <!--   <li  class="dropdown navbar-user">
                        <a  style="color:#000;" href="javascript:;" class="dropdown-toggle" data-toggle="dropdown">
                            <span id="User_id"></span> <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu animated fadeInLeft">
                            <li class="arrow"></li>
				  <li class="active"><a href="#">Schedule Tracking Dashboard</a></li>
				  <li><a href="MeasurementTransaction_Add.html">Measurement Transaction </a></li>
				  <li><a href="map.html">GPS</a></li>
				  <li><a href="Measure_Add.html">Test</a></li>
				  <li><a href="AlertBox.html">Sync</a></li>
			      </li> -->
					<li class="has-sub"><a onclick="logout()"> <i class="fa fa-sign-out"></i><span>Log Out</span></a></li>
                        </ul>
                    </li>
                </ul>
	</div>
            <!-- end container-fluid -->
        </div>
        <!-- end #header -->
	    
	    
	    	    <input type="hidden" name="MH_STATUS" id="MH_STATUS" value="Incomplete"/>
	    
	   
	    <div class="" id="content">
		<!--<ol class="breadcrumb pull-right">
		    <li>Logistics</li>
		    <li class="active">Add </li>
		</ol>-->
		<!--<h1 class="page-header">Edit <small> Enter the correct details here...</small></h1>-->
		<div class="rowfixedtop">
		    <div class="">
			<div class="panel panel-inverse" data-sortable-id="form-stuff-1">
			    <div class="panel-heading">
				<div class="panel-heading-btn"></div>
				<h4 class="panel-title"><strong>Measurement Transaction Edit</strong></h4>
			    </div>
			    <div class="panel-body">
				<p id="errorMessage"style="color:#ea0000"></p>
				<form class="" id="form_validation" method="POST" enctype="multipart/form-data">
				    <div id="viewHeadSystemId">
										    <input type="hidden" name="head_sys_id" id="head_sys_id" >
					    <input type="hidden" name="mainId" id="mainId" >
									    </div>
				    <div id="wizard">
					<ol>
					    <li>Reference</li>
					    <li>Details & Product</li>
					</ol>
					<div>
					    <fieldset>
						<legend class=" width-full">Reference						    							<!--<button class="pull-right btn btn-primary" id="existEdit"><i class="fa fa-edit"></i> Edit Existings</button>-->
						    						</legend>
						<div class="form-horizontal tab-pane headTab">
						    <div class="row">
							<div class="col-md-3">
							    <div class="col-md-12 form-group">
								<label class="control-label">Customer Name</label>
								<input type="text" class="form-control input-sm" name="MH_CUST_AC_DESC" id="MH_CUST_AC_DESC" readonly>
								<input type="hidden" name="lsl_sys_id" id="lsl_sys_id">
							    </div>
							</div>
							<div class="col-md-3">
							    <div class="col-md-12 form-group">
								<label class="control-label">Contact Person</label>
								<input type="text" class="form-control input-sm" name="MH_CONTACT_PERSON" id="MH_CONTACT_PERSON" readonly>
							    </div>
							</div>
							<div class="col-md-3">
							    <div class="col-md-12 form-group">
								<label class="control-label">Address</label>
								<input type="text" class="form-control input-sm" name="MH_ADD1" id="MH_ADD1" readonly>
							    </div>
							</div>
							<div class="col-md-3">
							    <div class="col-md-12 form-group">
								<label class="control-label">City</label>
								<input type="text" class="form-control input-sm" id="City" name="City" readonly>
								<input type="hidden" class="form-control" name="MH_CT_CODE" id="MH_CT_CODE" >
							    </div>
							</div>
						    </div>
						    <div class="row">
							<div class="col-md-3">
							    <div class="col-md-12 form-group">
								<label class="control-label">Ref Transaction</label>
								<input type="text" class="form-control input-sm" name="MH_SALE_REF_TXN_CODE" id="MH_SALE_REF_TXN_CODE" readonly>
							    </div>
							</div>
							<div class="col-md-3">
							    <div class="col-md-12 form-group">
								<label class="control-label">Ref No</label>
								<input type="text" class="form-control input-sm" name="MH_SALE_REF_TXN_NO" id="MH_SALE_REF_TXN_NO" readonly>
							    </div>
							</div>
						    </div>						    
						</div>
					    </fieldset>
					</div>
					<div class="row">
					    <input type="hidden" name="headSysId" >
					    <fieldset class="col-sm-4 treeTab">
						<legend class="pull-left width-full">Details</legend>
						<div class="form-horizontal tab-pane buildingTab">
						    <div class="row">
							<div class="col-md-10">
							    <div class="col-sm-12 form-group">
								<label class="control-label">Building Type</label>
								<select class="form-control selectpicker btn-sm" name="ML_BULD_TYPE" id="ML_BULD_TYPE" data-live-search="true" data-style="btn-white btn-sm">
								    <option value="">Select</option>
								</select>
							    </div>
							</div>
						    </div>
						    <div class="row">
								<div id="buildingDetails" class="col-md-12 form-group" style="display: block ;">
									<div class="tree">								
										<ul class="activeNode" id="measurementTab">
										</ul>
									</div>
								</div>
							</div>
					    </fieldset>
					    <fieldset class="col-sm-8">
						<legend class="pull-left width-full"> &nbsp </legend>
												<div class="tab-pane active_measurement" id="measurementId_1" style="display: none;">
						    <input type="hidden" name="mode[]" value="edit">
						    <input type="hidden" name="headSysIdLines[]" id="headSysIdLines">
							<input type="hidden" name="USER_ID[]" id="USER_ID">
							<input type="hidden" name="USER_COMP_CODE[]" id="USER_COMP_CODE">
						    <input type="hidden" name="LINE_SYS_ID[]" >
						    <input type="hidden" name="buildingValue[]" >
						    <input type="hidden" name="floorValue[]" >
						    <input type="hidden" name="appartmentValue[]" >
						    <input type="hidden" name="roomValue[]" >
						    <input type="hidden" name="wallValue[]" >
						    <input type="hidden" name="windowValue[]" >
						    <input type="hidden" name="buildingTypeValue[]">
						    <input type="hidden" name="roomTypeValue[]">
						    <input type="hidden" name="ML_Line_Value[]">
						    <button type="button" name="deleteLine[]" onclick="deleteMeasurementLinesInDb(9150)" class="hide" ></button>
						    <div class="hide">
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSH_TXN_CODE[]" id="LSH_TXN_CODE" >
								<input type="hidden" class="form-group" name="LSH_TXN_NO[]" id="LSH_TXN_NO" >
							    <input type="hidden" class="form-group" name="MH_TXN_CODE[]" id="MH_TXN_CODE">
								<input type="hidden" class="form-group" name="LSH_TXN_DT[]" id="LSH_TXN_DT">
							    <input type="hidden" class="form-control" name="MH_SALE_REF_SYS_ID[]" id="MH_SALE_REF_SYS_ID" readonly>
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSH_TXN_DT[]" id="defaultdate4">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSH_DOC_REF[]" id="LSH_DOC_REF">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_LOCN_CODE[]" id="LSL_LOCN_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_SR_CODE[]" id="LSL_SR_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_SYS_ID[]" id="LSL_REF_SYS_ID">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_TXN_CODE[]" id="LSL_REF_TXN_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_TXN_NO[]" id="LSL_REF_TXN_NO">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_TXN_DT[]" id="LSL_REF_TXN_DT">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CONTACT_NO[]" id="LSL_CONTACT_NO">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CN_CODE[]" id="LSL_CN_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ST_CODE[]" id="LSL_ST_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_POSTAL[]" id="LSL_POSTAL" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_MOBILE[]" id="LSL_MOBILE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_PHONE[]" id="LSL_PHONE" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_FAX[]" id="LSL_FAX" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_EMAIL[]" id="LSL_EMAIL">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_DESC[]" id="LSL_DESC" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_JOB_STATUS[]" id="LSL_JOB_STATUS">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_APPOINT_DT[]" id="defaultdate2">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CUST_AC_CODE[]" id="LSL_CUST_AC_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CT_AREA_CODE[]" id="LSL_CT_AREA_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD1[]" id="LSL_ADD1">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD2[]" id="LSL_ADD2">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD3[]" id="LSL_ADD3" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="P_MH_SALE_REF_TXN_DT[]" id="P_MH_SALE_REF_TXN_DT">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD4[]" id="LSL_ADD4" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CUST_ID[]" id="LSL_CUST_ID">
							</div>
						    </div>
						    <div class="roomTab"><legend class="pull-left width-full custom">Room</legend>
							<div class="row">
							    <div class="col-md-12 form-group">
								<label class="control-label">Room Type</label>
								<select class="form-control btn-sm" name="ML_UNIT[]" id="ML_UNIT" data-live-search="true" data-style="btn-white btn-sm">
								    <option value="">Select</option>
								 </select>
							    </div>
							</div>
						    </div>
						    <div class="wallTab"><legend class="pull-left width-full custom">Wall</legend>
							<div class="row">
							    <section class="col-md-3 form-group">
								<label class="control-label">Wall Width</label>
								<input type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="valueMappingToWindow();previewChanges($(this));" name="ML_FULL_WIDTH[]" id="ML_FULL_WIDTH" value="" placeholder="999.99 cm">
							    </section>
							</div>
							<div class="row">
							    <section class="col-md-3 form-group">
								<label class="control-label">Wall Height</label>
								<input type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="valueMappingToWindow();previewChanges($(this));" name="ML_FULL_HEIGHT[]" id="ML_FULL_HEIGHT" value=""  placeholder="999.99 cm">
							    </section>
							</div>
						    </div>
						    <div class="windowTab"><legend class="pull-left width-full custom">Window</legend><br><br><br>
							<div class="panel-group" id="measurementCollapse_1" role="tablist" aria-multiselectable="true">
							    <div class="panel panel-success">
							      <div class="panel-heading" role="tab" id="headingOne">
								<h4 class="panel-title">
								  <a role="button" data-toggle="collapse" data-parent="#measurementCollapse_1" href="#dimensions_9150" aria-expanded="true" aria-controls="collapseOne">
								    Dimensions
								  </a>
								</h4>
							      </div>
							      <div id="dimensions_9150" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
								<div class="panel-body">
								  <div class="col-sm-12">
								    <div class="row">
									<section class="col-md-3 form-group">
									    <label class="control-label">Window Type</label>
									    <select class="form-control btn-sm" name="MT_LEVEL_TYPE[]" id="MT_LEVEL_TYPE" onchange="windowTypeInputs($(this))" onclick="windowTypeInputForTrigger($(this))" data-live-search="true" data-style="btn-white btn-sm">
											<option value="">Select</option>
									    </select>
									</section>
									<section class="col-md-3 form-group ML_DOME_HEIGHT_SECTION" style="display: none;">
									    <label class="control-label">Dome Height</label>
									    <input value="" type="text" class="form-control input-sm" name="ML_DOME_HEIGHT[]" onkeyup="previewChanges($(this));" id="ML_DOME_HEIGHT" placeholder="999.99 cm">
									</section>
									<section class="col-md-3 form-group ML_CORNER_DEGREE_SECTION" style="display: none;">
									    <label class="control-label">Corner Degree</label>
									    <input value="" type="text" class="form-control input-sm" name="ML_CORNER_DEGREE[]" onkeyup="previewChanges($(this));" id="ML_CORNER_DEGREE" placeholder="999.99 cm">
									</section>
									<section class="col-md-3 form-group ML_CORVE_DEPTH_SECTION" style="display: none;">
									    <label class="control-label">Curve Depth</label>
									    <input value="" type="text" class="form-control input-sm" name="ML_CORVE_DEPTH[]" onkeyup="previewChanges($(this));" id="ML_CORVE_DEPTH" placeholder="999.99 cm">
									</section>
								    </div>
								      <div class="row noWindow noWindowValidation">
									  <section class="col-md-3 form-group">
									      <label class="control-label">Window Width</label>
									      <input type="text" class="form-control input-sm" name="ML_WIDTH[]" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this),'width');" id="ML_WIDTH" placeholder="999.99 cm">
									  </section>
									  <section class="col-md-3 form-group">
									      <label class="control-label">Window Height</label>
									      <input value="" type="text" class="form-control input-sm" name="ML_HEIGHT[]" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this),'height');" id="ML_HEIGHT" placeholder="999.99 cm">
									  </section>
									  <section class="col-md-3 form-group">
									      <label class="control-label">Wall to Left</label>
									      <input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this));" name="ML_LEFT_WALL[]" id="ML_LEFT_WALL" placeholder="999.99 cm">
									  </section>
									  <section class="col-md-3 form-group">
									      <label class="control-label">Wall to Right</label>
									      <input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" readonly="" name="ML_RIGHT_WALL[]" id="ML_RIGHT_WALL" placeholder="999.99 cm">
									  </section>
								      </div>
								      <div class="row noWindow noWindowValidation">
									    <section class="col-md-3 form-group">
										<label class="control-label">Up to Ceiling</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this));" name="ML_CEILING_UP[]" id="ML_CEILING_UP" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Down to Floor</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" readonly="" name="ML_FLOOR_DOWN[]" id="ML_FLOOR_DOWN" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Window Depth</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this));" name="ML_WINDOW_DEPTH[]" id="ML_WINDOW_DEPTH" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Window Opening</label>
										<select class="form-control btn-sm" name="ML_WINDOW_OPENING[]" id="ML_WINDOW_OPENING" data-live-search="true" data-style="btn-white btn-sm">
										    <option value="">Select</option>
										</select>
									    </section>
								      </div>
									  <div class="row noWindow">
										<!-- <section class="col-md-3 form-group">
										<label class="control-label">Design</label><br>
										<input type="hidden" name="ML_PELMET[]" id="pelment" value="N" onchange="linesModeCheck($(this),'switch');">
										<input type="checkbox" value="N" class="lcs_check"  id="ML_PELMET"/>
									    </section> -->
										<section class="col-md-3 form-group">
										<label class="control-label">Design</label><br>
										<input type="hidden" name="ML_PELMET[]" id="mlPelment"  onchange="linesModeCheck($(this),'switch');"  value="N">
										<input type="checkbox" value="" class="lcs_check"  id="ML_PELMET" />
									    </section>
									    <section class="col-md-3 form-group designDetail hide" id="projection">
											<label class="control-label">Design Width</label>
											<input value="" maxlength="10" type="text" class="form-control input-sm ML_PROJECTION" name="ML_PROJECTION[]" id="ML_PROJECTION" placeholder="Design Width">
									    </section>
										 <section class="col-md-3 form-group designDetail hide" id="fasica">
											<label class="control-label">Design Height</label>
											<input value="" maxlength="10" type="text" class="form-control input-sm ML_FASICA" name="ML_FASICA[]" id="ML_FASICA" placeholder="Design Height">
									    </section>
										 <section class="col-md-3 form-group designDetail hide" id="depth" >
											<label class="control-label">Design Depth</label>
											<input value="" maxlength="10" type="text" class="form-control input-sm ML_DESIGN_DEPTH" name="ML_DESIGN_DEPTH[]" id="ML_DESIGN_DEPTH" placeholder="Design Depth">
									    </section>
									</div>

									 <div class="row noWindow">
									 <section class="col-md-3 form-group">
										<label class="control-label">Gypsum Yes/No</label><br>
										<input type="hidden" name="ML_GYPSUM_YN[]" id="mlGypsumYN" value="N" onchange="linesModeCheck($(this),'switch');">
										<input type="checkbox" value="N" class="lcs_check"  id="ML_GYPSUM_YN"/>
									    </section>
									    <section class="col-md-3 form-group gypsumDetail hide" id="gypsumWidth">
											<label class="control-label">Gypsum Width</label>
											<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_WIDTH[]" id="ML_GYPSUM_WIDTH" placeholder="999.99 cm">
									    </section>
										 <section class="col-md-3 form-group gypsumDetail hide" id="gypsumHeight">
											<label class="control-label">Gypsum Height</label>
											<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_HEIGHT[]" id="ML_GYPSUM_HEIGHT" placeholder="999.99 cm">
									    </section>
										 <section class="col-md-3 form-group gypsumDetail hide" id="gypsumDepth" >
											<label class="control-label">Gypsum Depth</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_DEPTH[]" id="ML_GYPSUM_DEPTH" placeholder="999.99 cm">
									    </section>
									</div>

									  <!-- <div class="row">
									    <section class="col-md-3 form-group">
										<label class="control-label">Gypsum Yes/No</label>
										<input value="N" type="hidden" name="ML_GYPSUM_YN[]" id="mlGypsumYN">
										<input type="checkbox"  class="lcs_check"  id="ML_GYPSUM_YN" />
									    </section>
									    <section class="col-md-3 form-group gypsumDetail hide">
										<label class="control-label">Gypsum Width</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_WIDTH[]" id="ML_GYPSUM_WIDTH" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group gypsumDetail hide">
										<label class="control-label">Gypsum Height</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_HEIGHT[]" id="ML_GYPSUM_HEIGHT" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group gypsumDetail hide">
										<label class="control-label">Gypsum Depth</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_DEPTH[]" id="ML_GYPSUM_DEPTH" placeholder="999.99 cm">
									    </section>
									</div> -->
									
								  </div>
								</div>
							      </div>
							    </div>
							    <div class="panel panel-success">
							      <div class="panel-heading" role="tab" id="measurementCollapse_1">
								<h4 class="panel-title">
								  <a class="collapsed" role="button" data-toggle="collapse" data-parent="#measurementCollapse_1" href="#operations_9150" aria-expanded="false" aria-controls="collapseTwo">
								    Operations
								  </a>
								</h4>
							      </div>
							      <div id="operations_9150" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
								<div class="panel-body">
								    <div class="row noWindow noWindowValidation">
									<div class="col-sm-12">
									    <section class="col-md-3 form-group">
										<label class="control-label">Mount Type</label>
										<select class="form-control btn-sm" name="ML_MOUNT_TYPE[]" id="ML_MOUNT_TYPE" data-live-search="true" data-style="btn-white btn-sm">
										    <option value="">Select</option>
										 </select>
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Mount On</label>
										<select class="form-control btn-sm" name="ML_MOUNT_ON[]" id="ML_MOUNT_ON" data-live-search="true" data-style="btn-white btn-sm">
										    <option value="">Select</option>
										</select>
									    </section>
									    <!-- <section class="col-md-3 form-group">
										<label class="control-label">Operation</label>
										<select class="form-control btn-sm" name="ML_OPERATE[]" id="ML_OPERATE" data-live-search="true" data-style="btn-white btn-sm">
										    <option value="">Select</option>
										    <option value="Manual">Manual</option>
										    <option  value="Motorized">Motorized</option>
										</select>
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Control</label>
										<select class="form-control btn-sm" name="ML_CONTROL[]" id="ML_CONTROL" data-live-search="true" data-style="btn-white btn-sm">
										    <option value="">Select</option>
										    <option value="Left">Left</option>
										    <option  value="Right">Right</option>
										</select>
									    </section> -->
										<section class="col-md-3 form-group">
											<label class="control-label">Operation</label>
											<select class="form-control btn-sm" name="ML_OPERATE[]" id="ML_OPERATE" data-live-search="true" data-style="btn-white btn-sm">
												<option value="">Select</option>
											</select>
										</section>
										<section class="col-md-3 form-group">
											<label class="control-label">Control</label>
											<select class="form-control btn-sm" name="ML_CONTROL[]" id="ML_CONTROL" data-live-search="true" data-style="btn-white btn-sm">
												<option value="">Select</option>
											</select>
										</section>
									</div>
								    </div>
								    <div class="row">
									<div class="col-sm-12">
										<section class="col-md-3 form-group noWindow noWindowValidation">
											<label class="control-label">Opening</label>
											<select class="form-control btn-sm" name="ML_OPENING[]" id="ML_OPENING" data-live-search="true" data-style="btn-white btn-sm">
												<option value="">Select</option>
											</select>
										</section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Remarks</label>
										<input  value="" maxlength="1000" type="text" class="form-control input-sm ML_REMARKS" name="ML_REMARKS[]" id="ML_REMARKS" placeholder="Remarks">
									    </section>
									   
									</div>
								    </div>
								    <div class="row">
									<div class="col-sm-12">
									   <section class="col-md-3 form-group">
										<label class="control-label"></label>
										<input type="hidden" class="form-control input-sm" name="MH_TXN_NO[]" id="MH_TXN_NO" value="4231">
									    </section>
									    									    <section class="col-md-3 form-group">
										<label class="control-label"></label>
										<input type="hidden" class="form-control input-sm" name="MH_TXN_DT[]" id="defaultdate1" value="17-Feb-2016">
									    </section>
									</div>
								    </div>								  
								</div>
							      </div>
							    </div>
							    <div class="panel panel-success">
							      <div class="panel-heading" role="tab" id="measurementCollapse_1">
								<h4 class="panel-title">
								  <a class="collapsed" role="button" data-toggle="collapse" data-parent="#measurementCollapse_1" href="#others_9150" aria-expanded="false" aria-controls="collapseThree">
								    Others
								  </a>
								</h4>
							      </div>
							      <div id="others_9150" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
								<div class="panel-body">
								    <div class="col-sm-12">
									<div class="row noWindow noWindowValidation">
									<section class="col-md-3 form-group">
									    <label class="control-label">Handle Position</label>
									    <select class="form-control btn-sm" name="ML_HANDLE_POSITION[]" id="ML_HANDLE_POSITION" data-live-search="true" data-style="btn-white btn-sm">
											<option value="">Select</option>
										</select>
									</section>
									<section class="col-md-3 form-group">
									    <label class="control-label">Handle Size</label>
									    <input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_HANDLE_SIZE[]" id="ML_HANDLE_SIZE" placeholder="999.99 cm">
									</section>
									<section on class="col-md-3 form-group">
									    <label class="control-label">Power Distance</label>
									    <input value="" maxlength="12" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_POWER_DISTANCE[]" id="ML_POWER_DISTANCE" placeholder="999.99 cm">
									</section>
									<section class="col-md-3 form-group">
									    <label class="control-label">Power Point</label>
									    <select class="form-control btn-sm" name="ML_POWER_SIDE[]" id="ML_POWER_SIDE" data-live-search="true" data-style="btn-white btn-sm">
											<option value="">Select</option>
										</select>
									</section>
									
								      </div>
									<div class="row noWindow">
									    <section class="col-md-6 form-group">
										<label class="control-label">Partitioned Window Yes/No</label><br>
										<input type="hidden" value="N" name="ML_PARTITIONED_WINDOW_YN[]" id="partitionYN" onchange="linesModeCheck($(this),'switch');">
										<input type="checkbox" class="lcs_check" id="ML_PARTITIONED_WINDOW_YN" />
									    </section>
									</div>
									<div class="row noWindow">
									    <section class="col-md-3 form-group partitionDetail hide partition1">
										<label class="control-label">No. of Partition</label>
										<input value=""  maxlength="12" type="text" class="form-control input-sm" name="ML_NO_OF_PARTITION[]" id="ML_NO_OF_PARTITION" onkeyup="partitiontest($(this));" placeholder="">
									    </section>
									    <section class='col-md-3 partitionRemove form-group '><label class='control-label'>Partition Width-1</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group '><label class='control-label'>Partition Width-2</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group '><label class='control-label'>Partition Width-3</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-4</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-5</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-6</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-7</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-8</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-9</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									    <section class='col-md-3 partitionRemove form-group hide'><label class='control-label'>Partition Width-10</label><input value="" maxlength='12' type='text' name='partitionNewWidth[]' onkeyup="previewChanges($(this));" class='form-control input-sm'></section>
									</div>
									
									<div class="row">
									    <section class="col-md-6 form-group">
										<label class="control-label">Site Under Construction Yes/No</label><br>
										<input value="N" type="hidden" name="ML_SITE_READY_YN[]" id="SITE_READY_YN" onchange="linesModeCheck($(this),'switch');">
										<input  type="checkbox" value="" class="lcs_check"  id="ML_SITE_READY_YN" />
									    </section>
									</div>
								    </div>
								</div>
							      </div>
							    </div>
							</div>						    
							<div class="row">
							    <div class="col-sm-12">
							    	
							    	<input type="hidden" name="imageValid" id="imageValid" >
								<center><button type="button" id="imageAdd" class="btn btn-primary glyphicon glyphicon-picture" onclick="getImagePreview($(this))" data-toggle="modal" data-target="#measurementId_1_modal"> Add Image</button></center><br>
							    </div>
							</div>
							<div class="row noWindow">
							    <div class="col-sm-12 continer">
								<canvas id="myCanvas" width="400px" height="400px" data-touched-times='0'></canvas>
							    </div>
							</div>
							</div>
						    </div>
							<div class="tab-pane hide" id="productTab" data-product-id="" >
						    <input type="hidden" name="mode[]" value="add">
							<input type="hidden" name="USER_ID[]" id="USER_ID">
							<input type="hidden" name="USER_COMP_CODE[]" id="USER_COMP_CODE">
						    <input type="hidden" name="headSysIdLines[]" id="headSysIdLines" >
						    <input type="hidden" name="LINE_SYS_ID[]" >
						    <input type="hidden" name="buildingValue[]" >
						    <input type="hidden" name="floorValue[]" >
						    <input type="hidden" name="appartmentValue[]" >
						    <input type="hidden" name="roomValue[]" >
						    <input type="hidden" name="wallValue[]" >
						    <input type="hidden" name="windowValue[]" >
						    <input type="hidden" name="buildingTypeValue[]">
						    <input type="hidden" name="roomTypeValue[]">
						    <input type="hidden" name="ML_Line_Value[]">
						    <div class="hide">
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSH_TXN_CODE[]" id="LSH_TXN_CODE" >
								<input type="hidden" class="form-group" name="LSH_TXN_NO[]" id="LSH_TXN_NO" >
							    <input type="hidden" class="form-group" name="MH_TXN_CODE[]" id="MH_TXN_CODE" >
								<input type="hidden" class="form-group" name="LSH_TXN_DT[]" id="LSH_TXN_DT">
							    <input type="hidden" class="form-control" name="MH_SALE_REF_SYS_ID[]" id="MH_SALE_REF_SYS_ID" readonly>
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSH_TXN_DT[]" id="defaultdate4">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSH_DOC_REF[]" id="LSH_DOC_REF">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_LOCN_CODE[]" id="LSL_LOCN_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_SR_CODE[]" id="LSL_SR_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_SYS_ID[]" id="LSL_REF_SYS_ID">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_TXN_CODE[]" id="LSL_REF_TXN_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_TXN_NO[]" id="LSL_REF_TXN_NO">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_REF_TXN_DT[]" id="defaultdate3">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CONTACT_NO[]" id="LSL_CONTACT_NO">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CN_CODE[]" id="LSL_CN_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ST_CODE[]" id="LSL_ST_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_POSTAL[]" id="LSL_POSTAL">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_MOBILE[]" id="LSL_MOBILE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_PHONE[]" id="LSL_PHONE" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_FAX[]" id="LSL_FAX" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_EMAIL[]" id="LSL_EMAIL" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_DESC[]" id="LSL_DESC" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_JOB_STATUS[]" id="LSL_JOB_STATUS">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_APPOINT_DT[]" id="LSL_APPOINT_DT">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CUST_AC_CODE[]" id="LSL_CUST_AC_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CT_AREA_CODE[]" id="LSL_CT_AREA_CODE">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD1[]" id="LSL_ADD1">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD2[]" id="LSL_ADD2">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD3[]" id="LSL_ADD3">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="P_MH_SALE_REF_TXN_DT[]" id="P_MH_SALE_REF_TXN_DT">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_ADD4[]" id="LSL_ADD4" value="">
							</div>
							<div class="col-md-2">
							    <input type="hidden" class="form-group" name="LSL_CUST_ID[]" id="LSL_CUST_ID">
							</div>
						    </div>
						    <div class="roomTab">
							<legend class="pull-left width-full custom">Room</legend>
							<div class="row">
							    <div class="col-md-12 form-group">
								<label class="control-label">Room Type</label>
								<select disabled class="form-control btn-sm" name="ML_UNIT[]" id="ML_UNIT" data-live-search="true" data-style="btn-white btn-sm">
								    <option selected value="">Select</option>
								</select>
							    </div>
							</div>
						    </div>
						    <div class="wallTab"><legend class="pull-left width-full custom">Wall</legend>
							<div class="row">
							    <section class="col-md-3 form-group">
								<label class="control-label">Wall Width</label>
								<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="valueMappingToWindow();previewChanges($(this));" name="ML_FULL_WIDTH[]" id="ML_FULL_WIDTH" placeholder="999.99 cm">
							    </section>
							</div>
							<div class="row">
							    <section class="col-md-3 form-group">
								<label class="control-label">Wall Height</label>
								<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="valueMappingToWindow();previewChanges($(this));" name="ML_FULL_HEIGHT[]" id="ML_FULL_HEIGHT" placeholder="999.99 cm">
							    </section>
							</div>
						    </div>
						    <div class="windowTab"><legend class="pull-left width-full custom">Window</legend><br><br><br>
							<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
							    <div class="panel panel-success">
								<div class="panel-heading" role="tab" id="headingOne">
								  <h4 class="panel-title">
								    <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
								      Dimensions
								    </a>
								  </h4>
								</div>
								<div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
								  <div class="panel-body">
								    <div class="col-sm-12">
									<div class="row">
									    <!-- <section class="col-md-3 form-group">
											<label class="control-label">Window Type</label>
											<select class="form-control btn-sm" name="MT_LEVEL_TYPE[]" id="MT_LEVEL_TYPE" onchange="windowTypeInputs($(this))" data-live-search="true" data-style="btn-white btn-sm">
												<option >Select</option>
											</select>
										</section> -->
										<section class="col-md-3 form-group">
											<label class="control-label">Window Type</label>
											<select disabled class="form-control btn-sm" name="MT_LEVEL_TYPE[]" id="MT_LEVEL_TYPE" onchange="windowTypeInputs($(this));" data-live-search="true" data-style="btn-white btn-sm">
												<option selected="selected" value="">Select</option>
											</select>
									    </section>
									    <section class="col-md-3 form-group ML_DOME_HEIGHT_SECTION" style="display: none;">
											<label class="control-label">Dome Height</label>
											<input disabled type="text" class="form-control input-sm" name="ML_DOME_HEIGHT[]" onkeyup="previewChanges($(this));" id="ML_DOME_HEIGHT" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group ML_CORNER_DEGREE_SECTION" style="display: none;">
											<label class="control-label">Corner Degree</label>
											<input disabled type="text" class="form-control input-sm" name="ML_CORNER_DEGREE[]" onkeyup="previewChanges($(this));" id="ML_CORNER_DEGREE" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group ML_CORVE_DEPTH_SECTION" style="display: none;">
											<label class="control-label">Curve Depth</label>
											<input disabled type="text" class="form-control input-sm" name="ML_CORVE_DEPTH[]" onkeyup="previewChanges($(this));" id="ML_CORVE_DEPTH" placeholder="999.99 cm">
									    </section>
									</div>
									<div class="row noWindow noWindowValidation">
									    <section class="col-md-3 form-group">
										<label class="control-label">Window Width</label>
										<input disabled type="text" class="form-control input-sm" name="ML_WIDTH[]" onblur="$(this).formatCurrency();"  onkeyup="previewChanges($(this),'width');" id="ML_WIDTH" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Window Height</label>
										<input disabled type="text" class="form-control input-sm" name="ML_HEIGHT[]" onblur="$(this).formatCurrency();"  onkeyup="previewChanges($(this),'height');" id="ML_HEIGHT" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Wall to Left</label>
										<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this));" name="ML_LEFT_WALL[]" id="ML_LEFT_WALL" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Wall to Right</label>
										<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" readonly="" name="ML_RIGHT_WALL[]" id="ML_RIGHT_WALL" placeholder="999.99 cm">
									    </section>
									</div>
									<div class="row noWindow noWindowValidation">
									    <section class="col-md-3 form-group">
										<label class="control-label">Up to Ceiling</label>
										<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this));" name="ML_CEILING_UP[]" id="ML_CEILING_UP" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Down to Floor</label>
										<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" readonly="" name="ML_FLOOR_DOWN[]" id="ML_FLOOR_DOWN" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Window Depth</label>
										<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" onkeyup="previewChanges($(this));" name="ML_WINDOW_DEPTH[]" id="ML_WINDOW_DEPTH" placeholder="999.99 cm">
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Window Opening</label>
										<select disabled class="form-control btn-sm" name="ML_WINDOW_OPENING[]" id="ML_WINDOW_OPENING" data-live-search="true" data-style="btn-white btn-sm">
										    <option selected value="">Select</option>
										</select>
									    </section>
									</div>
									<div class="row noWindow">
										<!-- <section class="col-md-3 form-group">
											<label class="control-label">Design</label><br>
											<input type="hidden" name="ML_PELMET[]" id="pelment" value="N" onchange="linesModeCheck($(this),'switch');">
											<input type="checkbox" value="N" class="lcs_check"  id="ML_PELMET" />
									    </section> -->
										<section class="col-md-3 form-group">
											<label class="control-label">Design</label><br>
											<input type="hidden" name="ML_PELMET[]" id="mlPelment"  onchange="linesModeCheck($(this),'switch');"  value="N">
											<input type="checkbox" value="" class="lcs_check"  id="ML_PELMET" />
									    </section>
									    <section class="col-md-3 form-group designDetail hide" id="projection">
											<label class="control-label">Design Width</label>
											<input disabled maxlength="10" type="text" class="form-control input-sm ML_PROJECTION" name="ML_PROJECTION[]" id="ML_PROJECTION" placeholder="Design Width">
									    </section>
										<section class="col-md-3 form-group designDetail hide" id="fasica">
											<label class="control-label">Design Height</label>
											<input disabled maxlength="10" type="text" class="form-control input-sm ML_FASICA" name="ML_FASICA[]" id="ML_FASICA" placeholder="Design Height">
									    </section>
										<section class="col-md-3 form-group designDetail hide" id="depth">
											<label class="control-label">Design Depth</label>
											<input maxlength="10" type="text" class="form-control input-sm ML_DESIGN_DEPTH" name="ML_DESIGN_DEPTH[]" id="ML_DESIGN_DEPTH" placeholder="Depth">
									    </section>
									</div>

									<div class="row noWindow">
									 <section class="col-md-3 form-group">
										<label class="control-label">Gypsum Yes/No</label><br>
										<input type="hidden" name="ML_GYPSUM_YN[]" id="mlGypsumYN" value="N" onchange="linesModeCheck($(this),'switch');">
										<input type="checkbox" value="N" class="lcs_check"  id="ML_GYPSUM_YN"/>
									    </section>
									    <section class="col-md-3 form-group gypsumDetail hide" id="gypsumWidth">
											<label class="control-label">Gypsum Width</label>
											<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_WIDTH[]" id="ML_GYPSUM_WIDTH" placeholder="999.99 cm">
									    </section>
										 <section class="col-md-3 form-group gypsumDetail hide" id="gypsumHeight">
											<label class="control-label">Gypsum Height</label>
											<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_HEIGHT[]" id="ML_GYPSUM_HEIGHT" placeholder="999.99 cm">
									    </section>
										 <section class="col-md-3 form-group gypsumDetail hide" id="gypsumDepth" >
											<label class="control-label">Gypsum Depth</label>
										<input value="" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_GYPSUM_DEPTH[]" id="ML_GYPSUM_DEPTH" placeholder="999.99 cm">
									    </section>
									</div>
								    </div>
								  </div>
								</div>
							    </div>
							    <div class="panel panel-success">
							      <div class="panel-heading" role="tab" id="headingTwo">
								<h4 class="panel-title">
								  <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
								    Operations
								  </a>
								</h4>
							      </div>
							      <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
								<div class="panel-body">
								    <div class="row noWindow noWindowValidation">
									<div class="col-sm-12">
									    <section class="col-md-3 form-group">
										<label class="control-label">Mount Type</label>
										<select disabled class="form-control btn-sm" name="ML_MOUNT_TYPE[]" id="ML_MOUNT_TYPE" data-live-search="true" data-style="btn-white btn-sm">
										    <option selected="selected" value="">Select</option>
										</select>
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Mount On</label>
										<select disabled class="form-control btn-sm" name="ML_MOUNT_ON[]" id="ML_MOUNT_ON" data-live-search="true" data-style="btn-white btn-sm">
										    <option selected="selected" value="">Select</option>
										</select>
									    </section>
									   <section class="col-md-3 form-group">
											<label class="control-label">Operation</label>
											<select class="form-control btn-sm" name="ML_OPERATE[]" id="ML_OPERATE" data-live-search="true" data-style="btn-white btn-sm">
												<option value="">Select</option>
											</select>
										</section>
										<section class="col-md-3 form-group">
											<label class="control-label">Control</label>
											<select class="form-control btn-sm" name="ML_CONTROL[]" id="ML_CONTROL" data-live-search="true" data-style="btn-white btn-sm">
												<option value="">Select</option>
											</select>
										</section>
										
										
									</div>
								    </div>
								    <div class="row">
									<div class="col-sm-12">
									   <section class="col-md-3 form-group noWindow noWindowValidation">
											<label class="control-label">Opening</label>
											<select class="form-control btn-sm" name="ML_OPENING[]" id="ML_OPENING" data-live-search="true" data-style="btn-white btn-sm">
												<option value="">Select</option>
											</select>
										</section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Remarks</label>
										<input disabled maxlength="1000" type="text" class="form-control input-sm ML_REMARKS" name="ML_REMARKS[]" id="ML_REMARKS" placeholder="Remarks">
									    </section>
									    
									</div>
								    </div>
								    <div class="row">
									<div class="col-sm-12">
									   <label class="control-label"></label>
										<input disabled type="hidden" class="form-control input-sm" name="MH_TXN_NO[]" id="MH_TXN_NO">
									    </section>
									    									    <section class="col-md-3 form-group">
										<label class="control-label"></label>
										<input type="hidden" class="form-control input-sm" name="MH_TXN_DT[]" id="defaultdate1">
									    </section>
									</div>
								    </div>								  
								</div>
							      </div>
							    </div>
							    <div class="panel panel-success">
							      <div class="panel-heading" role="tab" id="headingThree">
								<h4 class="panel-title">
								  <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
								    Others
								  </a>
								</h4>
							      </div>
							      <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
								<div class="panel-body">
								    <div class="col-sm-12">
									<div class="row noWindow noWindowValidation">
									    <section class="col-md-3 form-group">
										<label class="control-label">Handle Position</label>
										<select disabled class="form-control btn-sm" name="ML_HANDLE_POSITION[]" id="ML_HANDLE_POSITION" data-live-search="true" data-style="btn-white btn-sm">
										    <option selected value="">Select</option>
										</select>
									    </section>
									    <section class="col-md-3 form-group">
										<label class="control-label">Handle Size</label>
										<input disabled type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_HANDLE_SIZE[]" id="ML_HANDLE_SIZE" placeholder="999.99 cm">
									    </section>
									    <section on class="col-md-3 form-group">
										<label class="control-label">Power Distance</label>
										<input disabled maxlength="12" type="text" class="form-control input-sm" onblur="$(this).formatCurrency();" name="ML_POWER_DISTANCE[]" id="ML_POWER_DISTANCE" placeholder="999.99 cm">
									    </section>
										<section class="col-md-3 form-group">
									    <label class="control-label">Power Point</label>
									    <select class="form-control btn-sm" name="ML_POWER_SIDE[]" id="ML_POWER_SIDE" data-live-search="true" data-style="btn-white btn-sm">
											<option value="">Select</option>
										</select>
									</section>
										
									</div>
									<div class="row noWindow">
									    <section class="col-md-6 form-group">
										<label class="control-label">Partitioned Window Yes/No</label><br>
										<input type="hidden" value="N" name="ML_PARTITIONED_WINDOW_YN[]" id="partitionYN" onchange="linesModeCheck($(this),'switch');">
										<input type="checkbox" class="lcs_check" id="ML_PARTITIONED_WINDOW_YN" />
									    </section>
									</div>
									<div class="row noWindow">
									    <section class="col-md-3 form-group partitionDetail hide partition1">
										<label class="control-label">No. of Partition</label>
										<input disabled maxlength="12" type="text" class="form-control input-sm" name="ML_NO_OF_PARTITION[]" id="ML_NO_OF_PARTITION" onkeyup="partitiontest($(this));" placeholder="">
									    </section>
									</div>
									
									<div class="row">
									    <section class="col-md-6 form-group">
										<label class="control-label">Site Under Construction Yes/No</label><br>
										<input type="hidden" name="ML_SITE_READY_YN[]" id="SITE_READY_YN" onchange="linesModeCheck($(this),'switch');" value="N">
										<input type="checkbox"  class="lcs_check"  id="ML_SITE_READY_YN" />
									    </section>
									</div>
								    </div>
								</div>
							      </div>
							    </div>
							</div>						    
							<div class="row">
							    <div class="col-sm-12">
								<input type="hidden" name="imageValid" id="imageValid" >
								<center><button type="button" id="imageAdd" class="btn btn-primary glyphicon glyphicon-picture" onclick="getImagePreview($(this))" data-toggle="modal" data-target="#addImage"> Add Image</button></center><br>
							    </div>
							</div>
							<div class="row noWindow">
							    <div class="col-sm-12">
								<canvas id="myCanvas" width="400px" height="400px" data-touched-times='0'></canvas>
							    </div>
							</div>
						    </div>
						</div>
						<div class="row">
							<div class="col-md-12 pager form-group">
								<div class="col-md-offset-1 col-md-6 control-label">
									<input type="button" class="btn btn-sm btn-success" onclick="saveWholeData('proceed')" value="Save" name="save">
									<input type="button" class="btn btn-sm btn-primary" onclick="saveWholeData('wait')" value="Save & Edit" name="saveAndEdit">
									<!-- <input type="button" class="btn btn-sm btn-primary" onclick="Finderror()" value="Find error" name="Find error"> -->
								</div>
							</div>
					    </div>
					    </fieldset>
					</div>
				    </div>
					<input type="button" class="btn btn-sm btn-danger" onclick="getCancel();" value="Cancel" name="cancel">
				</form>
				<div class="modal fade" id="measurementId_1_modal" role="dialog">
				   <div class="modal-dialog">
					<div class="modal-content">
					    <div class="modal-header">
						<img src="assets/img/mantis_logo.jpg" data-id="login-cover-image" alt="" />
						<button aria-hidden="true" data-dismiss="modal" class="close" type="button" onClick="onClickHandler(this)"><i class="fa  fa-times-circle "></i></button>
					    </div>
					    <div class="modal-body">
						<div class="row">
						    <div class="col-sm-12">
							<form class="imageDisplay" id="measurementId_1_modal_data" method="POST" enctype="multipart/form-data">
							    <input type="hidden" name="USER_ID[]">
								<input type="hidden" name="USER_COMP_CODE[]">
								<input type="hidden" name="MI_SYS_ID[]">
								<input type="hidden" name="BP_MI_SYS_ID[]">
								<input type="hidden" name="linesys_id[]">
							    <input type="hidden" name="system_id[]">
								<input type="hidden" name="mode[]">
								<input type="hidden" name="mode_check[]">
								<input type="hidden" name="MI_DESC[]">
							    <center>
									<div class="form-group col-sm-12" id="Imagecount"></div>
									<div class="form-group col-sm-12">
										<button type="button"  onclick="captureImage($(this))" class="btn btn-add2 btn-sm btn-success" data-template="textbox">Capture</button>&nbsp; OR &nbsp;
										<button type="button"  onclick="getPhoto($(this))" class="btn btn-add2 btn-sm btn-success" data-template="textbox">Browse</button>
										<div id="captureScanresult"></div>
									</div>
							    </center>
							</form>

						    </div>
						</div>
					    </div>
					    <div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					    </div>
					</div>
				    </div>
				</div>
				  <div class="modal fade hide" id="addImage" role="dialog">
				    <div class="modal-dialog">
					<div class="modal-content">
					    <div class="modal-header">
						<img src="assets/img/mantis_logo.jpg" data-id="login-cover-image" alt="" />
						<button aria-hidden="true" data-dismiss="modal" class="close" type="button" onClick="onClickHandler(this)"><i class="fa  fa-times-circle "></i></button>
					    </div>
					    <div class="modal-body">
						<div class="row">
						    <div class="col-sm-12">
							<form class="imageDisplay" id="addImage" method="POST" enctype="multipart/form-data">
							<center>
								<input type="hidden" name="USER_ID[]">
								<input type="hidden" name="USER_COMP_CODE[]">
								<input type="hidden" name="MI_SYS_ID[]">
								<input type="hidden" name="BP_MI_SYS_ID[]">
							    <input type="hidden" name="linesys_id[]">
							    <input type="hidden" name="system_id[]">
								<input type="hidden" name="mode_check[]">
								<input type="hidden" name="mode[]" >
								<input type="hidden" name="MI_DESC[]" >
							      <div class="form-group col-sm-12" id="Imagecount">
							      </div>
								<div>
									<button type="button"  onclick="captureImage($(this))" class="btn btn-add2 btn-sm btn-success" data-template="textbox">Capture</button>&nbsp; OR &nbsp;
									<button type="button"  onclick="getPhoto($(this))" class="btn btn-add2 btn-sm btn-success" data-template="textbox">Browse</button>
								  
								</div>
							</center>
							</form>
						    </div>
						</div>
					    </div>
					    <div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					    </div>
					</div>
				    </div>
				</div>
			    </div>
			</div>
		    </div>
		</div>
	    </div>
	</div>	

<!-- Local Storage Script Start -->

 <script>
 function Finderror(){
	/*var errors=[];
	$('.has-error').each(function(){  
	  errors.push($(this).html());
	});
	prompt("",errors);
	*/
	$('div.wallTab, div.roomTab, div.windowTab').show();
 }
 
		var $measurement=1;
		var firstcount = Math.floor((Math.random() * 10000) + 1);
		localStorage.setItem("syncStatus","schedule");
		/* Logout function Start */
		var user_name = localStorage.getItem("user_id");
		document.getElementById("User_id").innerHTML = user_name;
		if(user_name==null){
			window.open('index.html', '_blank','location=no');
		}
		function logout(){
			localStorage.clear();
			window.open('index.html', '_blank','location=no');
		}
		/* Logout Function Ends*/
		var ajaxCount=0;
		function loadLoader() {
		    $('body').addClass('loading').loader('show', { overlay: true });
		}
		function unLoader() {
		    if (ajaxCount==0) {
			$('body').removeClass('loading').loader('hide');
		    }
		}
		
		function addChildNode($this,$className) {
			console.log('$class-',$className);
			$currentRow = $this.closest('li.activeNode');
			console.log('$currentRow-',$currentRow);
			$template   = $($className+'.hide');
			var $name=$template.children('li').children('div').children('input').attr("name");
			console.log('$template-',$template);
			$clone      = $template.clone().removeClass('hide').appendTo($currentRow);
			console.log('$clone-',$clone);
			$clone.addClass('activeNode');
			$clone.children('li').addClass('activeNode');
			$clone.children('li.activeNode').children('div').find("input").prop('disabled', false);
			$this.closest('li').children('ul').collapse('show');
			$this.closest('li').children('i').removeClass("fa-plus-square").addClass("fa-minus-square");
			$('#form_validation').formValidation('addField', $name);
			labelNumbering();
			removePagetext();
			localStorage.removeItem("DeletedWindow");
			mappingProductIdToWallAndRoom();
		}
		
		function addWindowAndProduct($this,$tab,$className){
			$measurement=Math.floor((Math.random() * 10000000) + 1);
			$nextElementLength=$this.closest('li.input-group.activeNode').children('ul.collapse.in.activeNode').find('[name="measurement[]"]').length;
		    console.log("$nextElementLength-",$nextElementLength);
			console.log("$measurement-",$measurement);
			if (($nextElementLength>=1 ) || $tab=='room') {			
				console.log('in');
		    }else{
				$productId=$this.prev().attr('data-product-id').split('_');			
				$measurement=$productId[1];
				console.log($measurement,'$measurement');
		    }
			
		    $nextElement=$this.closest('li.input-group.activeNode').children('ul.collapse.in.activeNode').find('[name="measurement[]"]').html();
			$currentRow = $this.closest('li.activeNode');
		    var $templateWindow = $($className+'.hide');
		    console.log("templateWindow",$templateWindow); 
			var windowElement=$templateWindow.children('li').children('div').children('input');
			var $name=windowElement.attr("name");
		    //alert($name);
		    $cloneWindow    = $templateWindow.clone().removeClass('hide').appendTo($currentRow);
		    $cloneWindow.addClass('activeNode')
		    $cloneWindow.children('li').addClass('activeNode');
		    $cloneWindow.children('li.activeNode').children('div').find("input").prop('disabled', false);
		    $measurementIdAfterClone=$cloneWindow.find('[name="measurement[]"]:visible');
		    $this.closest('li').children('ul').collapse('show');
		    $this.closest('li').children('i').removeClass("fa-plus-square").addClass("fa-minus-square");
		    $('#form_validation').formValidation('addField', $name);
			console.log("$measurement-",$measurement);
		    $cloneWindow.find('[name="measurement[]"]').attr('data-product-id','#measurementId_'+$measurement);
		    $('.active_measurement').hide();
		    $measurementIdAfterClone.click();		    
		    if ($nextElement==null && $tab!='room') {
		    }else if($nextElement!=null || $tab=='room'){			
			$templateProduct=$this.parents('#step2').find('#productTab');
			$cloneProduct=$templateProduct.clone().removeClass('hide').insertBefore($templateProduct);
			$cloneProduct.addClass('active_measurement').attr('id','measurementId_'+$measurement);
			$cloneProduct.find("input").prop('disabled', false);
			$cloneProduct.find("select").prop('disabled', false);
			$cloneProduct.find('#imageAdd').attr('data-target','#measurementId_'+$measurement+'_modal');
			$cloneProduct.find('select').addClass('selectpicker').selectpicker('refresh');
			$cloneProduct.find('#headingOne a').attr('href','#dimensions_'+$measurement);
			$cloneProduct.find('#collapseOne').attr('id','dimensions_'+$measurement);
			$cloneProduct.find('#headingTwo a').attr('href','#operations_'+$measurement);
			$cloneProduct.find('#collapseTwo').attr('id','operations_'+$measurement);
			$cloneProduct.find('#headingThree a').attr('href','#others_'+$measurement);
			$cloneProduct.find('#collapseThree').attr('id','others_'+$measurement);
			$cloneProduct.find('#accordion a').attr('data-parent','#measurementCollapse_'+$measurement);
			$cloneProduct.find('#accordion').attr('id','measurementCollapse_'+$measurement);
			//$cloneProduct.find('[name="MT_LEVEL_TYPE[]"]').change();
			//$cloneProduct.find('[name="ML_PELMET[]"]').change();
			
			$templateModal=$this.parents('div.panel-body').find('div#addImage');
			$cloneModal=$templateModal.clone().removeClass('hide').insertBefore($templateModal);
			$cloneModal.attr('id','measurementId_'+$measurement+'_modal').find('form').attr('id','measurementId_'+$measurement+'_modal_data');
			$measurementIdAfterClone.click();
			fieldsForMeasurement('addField',$cloneProduct);
			valueMappingToWindow();
			//$('#form_validation').formValidation('validate', windowElement);
		    }
		    labelNumbering();
			removePagetext();
			localStorage.removeItem("DeletedWindow");
		    mappingProductIdToWallAndRoom();
		}
		
		function fieldsForMeasurement(action,element) {
		    if (element.find('[name="mode[]"]').val()=='edit' || element.find('[name="mode[]"]').val()=='noUpdate') {
			$('#form_validation').formValidation(action, element.find("[name='ML_UNIT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_FULL_WIDTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_FULL_HEIGHT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_WIDTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_HEIGHT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_LEFT_WALL[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_CEILING_UP[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_WINDOW_DEPTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_WINDOW_OPENING[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_HANDLE_POSITION[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_HANDLE_SIZE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_POWER_DISTANCE[]']"));
			//$('#form_validation').formValidation(action, element.find("[name='ML_POWER_SIDE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='MT_LEVEL_TYPE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_MOUNT_TYPE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_MOUNT_ON[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPERATE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_CONTROL[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPENING[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_PROJECTION[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_FASICA[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_DESIGN_DEPTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_GYPSUM_WIDTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_GYPSUM_HEIGHT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_GYPSUM_DEPTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_NO_OF_PARTITION[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPENING[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPENING[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPENING[]']"));
		    }else if (action=="addField") {	
			$('#form_validation').formValidation(action, 'ML_UNIT[]');
			$('#form_validation').formValidation(action, 'ML_FULL_WIDTH[]');
			$('#form_validation').formValidation(action, 'ML_FULL_HEIGHT[]');
			$('#form_validation').formValidation(action, 'ML_WIDTH[]');
			$('#form_validation').formValidation(action, 'ML_HEIGHT[]');
			$('#form_validation').formValidation(action, 'ML_LEFT_WALL[]');
			$('#form_validation').formValidation(action, 'ML_RIGHT_WALL[]');
			$('#form_validation').formValidation(action, 'ML_FLOOR_DOWN[]');
			$('#form_validation').formValidation(action, 'ML_CEILING_UP[]');
			$('#form_validation').formValidation(action, 'ML_WINDOW_DEPTH[]');
			$('#form_validation').formValidation(action, 'ML_WINDOW_OPENING[]');
			$('#form_validation').formValidation(action, 'ML_HANDLE_POSITION[]');
			$('#form_validation').formValidation(action, 'ML_HANDLE_SIZE[]');
			$('#form_validation').formValidation(action, 'ML_POWER_DISTANCE[]');
			//$('#form_validation').formValidation(action, 'ML_POWER_SIDE[]');
			$('#form_validation').formValidation(action, 'MT_LEVEL_TYPE[]');
			$('#form_validation').formValidation(action, 'ML_MOUNT_TYPE[]');
			$('#form_validation').formValidation(action, 'ML_MOUNT_ON[]');
			$('#form_validation').formValidation(action, 'ML_OPERATE[]');
			$('#form_validation').formValidation(action, 'ML_CONTROL[]');
			$('#form_validation').formValidation(action, 'ML_OPENING[]');		    
		    }else{
			$('#form_validation').formValidation(action, element.find("[name='ML_UNIT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_FULL_WIDTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_FULL_HEIGHT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_WIDTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_HEIGHT[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_LEFT_WALL[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_RIGHT_WALL[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_FLOOR_DOWN[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_CEILING_UP[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_WINDOW_DEPTH[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_WINDOW_OPENING[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_HANDLE_POSITION[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_HANDLE_SIZE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_POWER_DISTANCE[]']"));
			//$('#form_validation').formValidation(action, element.find("[name='ML_POWER_SIDE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='MT_LEVEL_TYPE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_MOUNT_TYPE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_MOUNT_ON[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPERATE[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_CONTROL[]']"));
			$('#form_validation').formValidation(action, element.find("[name='ML_OPENING[]']"));
		    }
		}
		
		function showRoomTab($this) {
		    $('.active_measurement').hide();
		    var measuremetId=$this.attr('data-product-id');
		    //alert("showRoomTab->"+measuremetId);
		    $(measuremetId).show();
		    $(measuremetId).find('.roomTab').addClass('activeRoomTab').show().find('select').addClass('selectpicker').selectpicker('refresh');
		    $(measuremetId).find('.wallTab').hide();
		    $(measuremetId).find('.windowTab').hide();
		}
		function showWallTab($this) {
		    $('.active_measurement').hide();
		    var measuremetId=$this.attr('data-product-id');
		    //alert("showRoomTab->"+measuremetId);
		    $(measuremetId).show();
		    $(measuremetId).find('.roomTab').hide();
		    $(measuremetId).find('.wallTab').addClass('activeWallTab').show().find('select').addClass('selectpicker').selectpicker('refresh');
		    $(measuremetId).find('.windowTab').hide();
		}
		function showWindowTab($this) {
			//alert("showWindowTab");
		    $('.active_measurement').hide();
		    var measuremetId=$this.attr('data-product-id');
		    //alert("showWindowTab->"+measuremetId);
		    $(measuremetId).show();
		    $(measuremetId).find('.roomTab').hide();
		    $(measuremetId).find('.wallTab').hide();
		    $(measuremetId).find('.windowTab').addClass('activeWindowTab').show().find('select').addClass('selectpicker').selectpicker('refresh');
		    $(measuremetId).find('.activeWindowTab').find('[name="ML_WIDTH[]"]').trigger('keyup');
		    
		}/*
		function headingChange($this, tabName){
		    var measurementId = $this.siblings('span').find('[name="measurement[]"]').attr('data-product-id');
		    var inputValue = $this.val();
		    $(measurementId).children(tabName).find('legend').html(inputValue);
		}*/
		function removeCurrentNode($this,$deleteProduct,$id,$headId) {
		    //alert($deleteProduct+"--"+$id+"--"+$headId);
			bootbox.confirm("Are you sure you want to delete?", function(confirmed)
		    {
			if (confirmed) {
			    $parent= $this.closest('li');
			    var measurementId;
				var GetTreeID;
				localStorage.removeItem("DeletedWindow");
			    //alert($deleteProduct);
			    var windowCount=0;
			    if ($deleteProduct=='floor') {
					$('button').closest('ul.activeNode').find('input.floor').each(function(){windowCount++; /*alert(windowCount)*/});
			    }
				if ($deleteProduct=='appartment') {
					$('button').closest('ul.activeNode').find('input.appartment').each(function(){windowCount++; /*alert(windowCount)*/});
			    }
				if ($deleteProduct=='room') {
					$('button').closest('ul.activeNode').find('input.room').each(function(){windowCount++; /*alert(windowCount)*/});
			    }
				if ($deleteProduct=='wall') {
					$('button').closest('ul.activeNode').find('input.wall').each(function(){windowCount++; /*alert(windowCount)*/});
			    }
			    $this.closest('li').children('ul').children('li:first').find('.window');
			    if ($deleteProduct=='window') {
					$('button').closest('ul.activeNode').find('input.window').each(function(){windowCount++; /*alert(windowCount)*/});
			    }
			    if ($deleteProduct =='deleteProduct') {
					$parent.find('[name="measurement[]"]').each(function (){
						//alert($(this));
						measurementId =$(this).attr('data-product-id');
						$imageExist=$(measurementId+'_modal').find("[id='userfile1[]']").val();
						if ($imageExist!=null){
						$(measurementId+'_modal').find("[name='deleteImages[]']").click();
						}
						$(measurementId).find("[name='deleteLine[]']").click();
						fieldsForMeasurement('removeField',$(measurementId));
						$(measurementId).remove();
						$(measurementId+'_modal').remove();
					});
					$parent.find('input').each(function(){
						$name=$(this).attr('name');
						$('#form_validation').formValidation('removeField', $name);
					});
					$parent.find("[name='deleteTree[]']").click();
					$parent.remove();
					if($id==undefined){
						//alert("empty");
					}else{
						var networkState = navigator.network.connection.type;
						var states = {};
						states[Connection.UNKNOWN]  = 'Unknown connection';
						states[Connection.ETHERNET] = 'Ethernet connection';
						states[Connection.WIFI]     = 'WiFi connection';
						states[Connection.CELL_2G]  = 'Cell 2G connection';
						states[Connection.CELL_3G]  = 'Cell 3G connection';
						states[Connection.CELL_4G]  = 'Cell 4G connection'; 
						states[Connection.NONE]     = 'No network connection';
						//alert('[Connection](connection.html) type: ' + states[networkState]);
						if(states[networkState] == 'No network connection'){
							var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
							db.transaction(deleteValues, errorCB);
							function deleteValues(tx) {
								GetTreeID = $id;
								var Mode = localStorage.getItem("Mode");
								if(Mode == "edit_mode"){
									if ($deleteProduct=='window') {
										tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? AND MT_MH_SYS_ID=? ', [$id,$headId], function (tx, results) {});
										tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? AND ML_MH_SYS_ID=?', [$id,$headId], function (tx, results){});
									}else{
										tx.executeSql('SELECT * FROM LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=?', [$headId], function (tx, results) {
											var lineLength = results.rows.length;
											//alert("Linelength-"+lineLength);
											if(lineLength == 0){
												
											}else if(lineLength == 1){
												tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=? ', [$headId], function (tx, results) {});
												tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=? ', [$headId], function (tx, results) {});
											}else{
												tx.executeSql('SELECT * FROM LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=?', [$headId], function (tx, results) {
													var treeLength = results.rows.length;
													//alert("Treelength-"+treeLength);
													if(treeLength == 0){
													
													}else{
														for(var i=0;i<treeLength;i++){
															var TreeId = results.rows.item(i).MT_SYS_ID;
															//alert(GetTreeID);
															if(TreeId == GetTreeID){
																tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? ', [TreeId], function (tx, results) {
																	//alert("Tree deleted");
																});
																tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? ', [TreeId], function (tx, results) {
																	//alert("Tree deleted");
																});
																GetTreeID =parseInt(TreeId)+1;
															}
														}
													}
												});
											}
										});
									}
								}else{
									var GetTree = localStorage.getItem("GetDataTree");
									if(localStorage.getItem("GetDataTree")=="OnlineNewData"){
										if ($deleteProduct=='window') {
											tx.executeSql('DELETE FROM SelectedTreeDataValue WHERE MT_SYS_ID=? AND MT_MH_SYS_ID=? ', [$id,$headId], function (tx, results) {});
											tx.executeSql('DELETE FROM SelectedLineDataValue WHERE ML_SYS_ID=? AND ML_MH_SYS_ID=?', [$id,$headId], function (tx, results){
												//alert("delete Line");
											});
										}else{
											tx.executeSql('SELECT * FROM SelectedTreeDataValue WHERE MT_MH_SYS_ID=?', [$headId], function (tx, results) {
												var treeLength = results.rows.length;
												//alert("Treelength-"+treeLength);
												if(treeLength == 0){
												
												}else{
													for(var i=0;i<treeLength;i++){
														var TreeId = results.rows.item(i).MT_SYS_ID;
														//alert(GetTreeID);
														if(TreeId == GetTreeID){
															tx.executeSql('DELETE FROM SelectedTreeDataValue WHERE MT_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															tx.executeSql('DELETE FROM SelectedLineDataValue WHERE ML_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															GetTreeID =parseInt(TreeId)+1;
														}
													}
												}
											});
										}
									}else{
										if ($deleteProduct=='window') {
											tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? AND MT_MH_SYS_ID=? ', [$id,$headId], function (tx, results) {});
											tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? AND ML_MH_SYS_ID=?', [$id,$headId], function (tx, results){});
										}else{
											tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=?', [$headId], function (tx, results) {
												var treeLength = results.rows.length;
												//alert("Treelength-"+treeLength);
												if(treeLength == 0){
												
												}else{
													for(var i=0;i<treeLength;i++){
														var TreeId = results.rows.item(i).MT_SYS_ID;
														//alert(GetTreeID);
														if(TreeId == GetTreeID){
															tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															GetTreeID =parseInt(TreeId)+1;
														}
													}
												}
											});
										}
									}
								}
							}
							function errorCB(tx, err) {
								//alert("Error");
								//alert("Error processing SQL: "+err);
							}
						}else{
							var USER_ID = localStorage.getItem("user_id");
							var USER_COMP_CODE = localStorage.getItem("USER_COMP_CODE");
							//alert("one->"+USER_ID+"--"+USER_COMP_CODE+"--"+$id+"--"+$headId);
							$.ajax
							({
								type: "POST",                                
								url: "http://test.sedarspine.com/en/spineLogisticsApp/OnlineMeasurementTree_Delete",
								data:{MT_SYS_ID:$id,MT_MH_SYS_ID:$headId,USER_ID:USER_ID,USER_COMP_CODE:USER_COMP_CODE},
								dataType: "json",
								success: function (json)
								{
									//alert("Delete One-"+JSON.stringify(json));
									//alert(json);
								},error: function (xhr, ajaxOptions, thrownError) {
									//alert("Error");
									//alert(xhr);alert(ajaxOptions);alert(thrownError);
								}
							});
						}
					}
					mappingProductIdToWallAndRoom();
			    }else if (windowCount>=2) {
				$parent.find('[name="measurement[]"]').each(function (){
				    //alert($(this));
				    measurementId =$(this).attr('data-product-id');
					fieldsForMeasurement('removeField',$(measurementId));
				    $(measurementId).remove();
				    $(measurementId+'_modal').remove();
					localStorage.setItem("DeletedWindow","Deleted");
				});
				$parent.remove();
				if($id==undefined){
						//alert("empty");
					}else{
						var networkState = navigator.network.connection.type;
						var states = {};
						states[Connection.UNKNOWN]  = 'Unknown connection';
						states[Connection.ETHERNET] = 'Ethernet connection';
						states[Connection.WIFI]     = 'WiFi connection';
						states[Connection.CELL_2G]  = 'Cell 2G connection';
						states[Connection.CELL_3G]  = 'Cell 3G connection';
						states[Connection.CELL_4G]  = 'Cell 4G connection'; 
						states[Connection.NONE]     = 'No network connection';
						//alert('[Connection](connection.html) type: ' + states[networkState]);
						if(states[networkState] == 'No network connection'){
							var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
							db.transaction(deleteValues, errorCB);
							function deleteValues(tx) {
								GetTreeID = $id;
								var Mode = localStorage.getItem("Mode");
								if(Mode == "edit_mode"){
									if ($deleteProduct=='window') {
										tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? AND MT_MH_SYS_ID=? ', [$id,$headId], function (tx, results) {});
										tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? AND ML_MH_SYS_ID=?', [$id,$headId], function (tx, results){});
									}else{
										tx.executeSql('SELECT * FROM LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=?', [$headId], function (tx, results) {
											var lineLength = results.rows.length;
											//alert("Linelength-"+lineLength);
											if(lineLength == 0){
												
											}else if(lineLength == 1){
												tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=? ', [$headId], function (tx, results) {});
												tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=? ', [$headId], function (tx, results) {});
											}else{
												tx.executeSql('SELECT * FROM LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=?', [$headId], function (tx, results) {
													var treeLength = results.rows.length;
													//alert("Treelength-"+treeLength);
													if(treeLength == 0){
													
													}else{
														for(var i=0;i<treeLength;i++){
															var TreeId = results.rows.item(i).MT_SYS_ID;
															//alert(GetTreeID);
															if(TreeId == GetTreeID){
																tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? ', [TreeId], function (tx, results) {
																	//alert("Tree deleted");
																});
																tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? ', [TreeId], function (tx, results) {
																	//alert("Tree deleted");
																});
																GetTreeID =parseInt(TreeId)+1;
															}
														}
													}
												});
											}
										});
									}
								}else{
									//alert(localStorage.getItem("GetDataTree"));
									if(localStorage.getItem("GetDataTree")=="OnlineNewData"){
										if ($deleteProduct=='window') {
											tx.executeSql('DELETE FROM SelectedTreeDataValue WHERE MT_SYS_ID=? AND MT_MH_SYS_ID=? ', [$id,$headId], function (tx, results) {});
											tx.executeSql('DELETE FROM SelectedLineDataValue WHERE ML_SYS_ID=? AND ML_MH_SYS_ID=?', [$id,$headId], function (tx, results){
												//alert("Tree Deleted");
											});
										}else{
											tx.executeSql('SELECT * FROM SelectedTreeDataValue WHERE MT_MH_SYS_ID=?', [$headId], function (tx, results) {
												var treeLength = results.rows.length;
												//alert("Treelength-"+treeLength);
												if(treeLength == 0){
												
												}else{
													for(var i=0;i<treeLength;i++){
														var TreeId = results.rows.item(i).MT_SYS_ID;
														//alert(GetTreeID);
														if(TreeId == GetTreeID){
															tx.executeSql('DELETE FROM SelectedTreeDataValue WHERE MT_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															tx.executeSql('DELETE FROM SelectedLineDataValue WHERE ML_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															GetTreeID =parseInt(TreeId)+1;
														}
													}
												}
											});
										}
									}else{
										if ($deleteProduct=='window') {
											tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? AND MT_MH_SYS_ID=? ', [$id,$headId], function (tx, results) {});
											tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? AND ML_MH_SYS_ID=?', [$id,$headId], function (tx, results){});
										}else{
											tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=?', [$headId], function (tx, results) {
												var treeLength = results.rows.length;
												//alert("Treelength-"+treeLength);
												if(treeLength == 0){
												
												}else{
													for(var i=0;i<treeLength;i++){
														var TreeId = results.rows.item(i).MT_SYS_ID;
														//alert(GetTreeID);
														if(TreeId == GetTreeID){
															tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_LINES WHERE ML_SYS_ID=? ', [TreeId], function (tx, results) {
																//alert("Tree deleted");
															});
															GetTreeID =parseInt(TreeId)+1;
														}
													}
												}
											});
										}
									}
								}
							}
							function errorCB(tx, err) {
								//alert("Error");
								//alert("Error processing SQL: "+err);
							}
						}else{
							var USER_ID = localStorage.getItem("user_id");
							var USER_COMP_CODE = localStorage.getItem("USER_COMP_CODE");
							//alert("two->"+USER_ID+"--"+USER_COMP_CODE+"--"+$id+"--"+$headId);
							$.ajax
							({
								type: "POST",                                
								url: "http://test.sedarspine.com/en/spineLogisticsApp/OnlineMeasurementTree_Delete",
								data:{MT_SYS_ID:$id,MT_MH_SYS_ID:$headId,USER_ID:USER_ID,USER_COMP_CODE:USER_COMP_CODE},
								dataType: "json",
								success: function (json)
								{
									//alert("Delete One-"+JSON.stringify(json));
									//alert(json);
								},error: function (xhr, ajaxOptions, thrownError) {
									//alert("Error");
									//alert(xhr);alert(ajaxOptions);alert(thrownError);
								}
							});
						}
					}
				mappingProductIdToWallAndRoom();
			    }else{
				bootbox.alert('single '+$deleteProduct+' cannot be deleted');
			    }
			}			
		    });
		}
		function removeCurrentNodeForAdd($this,$deleteProduct) {
			//alert("Delete ID->"+$id+"--"+$headId);
			bootbox.confirm("Are you sure you want to delete?", function(confirmed)
		    {
			if (confirmed) {
				$parent= $this.closest('li');
				var measurementId;
				var GetTreeID;
				//alert(measurementId);
				if ($deleteProduct=='deleteProduct') {
				$parent.find('[name="measurement[]"]').each(function (){
					//alert($(this));
					measurementId =$(this).attr('data-product-id');
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_UNIT[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_FULL_WIDTH[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_FULL_HEIGHT[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_WIDTH[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_HEIGHT[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_LEFT_WALL[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_CEILING_UP[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_WINDOW_DEPTH[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_WINDOW_OPENING[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_HANDLE_POSITION[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_HANDLE_SIZE[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_POWER_DISTANCE[]']"));
					//$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_POWER_SIDE[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='MT_LEVEL_TYPE[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_MOUNT_TYPE[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_MOUNT_ON[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_OPERATE[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_CONTROL[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_OPENING[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_PELMET[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_PROJECTION[]']"));
					$('#form_validation').formValidation('removeField', $(measurementId).find("[name='ML_FASICA[]']"));
					$(measurementId).remove();
					$(measurementId+'_modal').remove();
				});
				}else{
				measurementId = $parent.find('[name="measurement[]"]').attr('data-product-id');
				$(measurementId).find('.wallTab').removeClass('activeWallTab');
				$(measurementId).find('.windowTab').removeClass('activeWindowTab');
				$this.closest('ul.collapse.in.activeNode').parent('li.input-group.activeNode').children('div').find('[name="measurement[]"]').click();
				}
				$parent.find('input').each(function(){
				$name=$(this).attr('name');
				$('#form_validation').formValidation('removeField', $name);
				});
				$parent.remove();
				
			}
			});
		   // mappingProductIdToWallAndRoom();
		}
		function valueMappingToWindow(){
		   $('[name="ML_WALL[]"]').parent().parent('li.activeNode').each(function (){
			//wall					    
			var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');
			$wallFullWidthValue=$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val();
			$wallFullHeightValue=$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val();
			$(this).children('ul.activeNode').children('li.activeNode').each(function (){
			    //window
			    var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');						
			    $(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val($wallFullHeightValue);
			    $(measurementId).find('[name="ML_FULL_WIDTH[]"]').val($wallFullWidthValue);
			});
		    });
		}
		function labelNumbering(){
		    $FloorLabelNo=1;
		    $('[name="ML_FLOOR[]"]:enabled').each(function(){
			$(this).parent('div').parent('li.activeNode').children('span.label').html('Floor (Count-'+$FloorLabelNo+')');
			$FloorLabelNo++;
		    });
		    $FlatLabelNo=1;
		    $('[name="ML_FLAT[]"]:enabled').each(function(){
			$(this).parent('div').parent('li.activeNode').children('span.label').html('Appartment (Count-'+$FlatLabelNo+')');
			$FlatLabelNo++;
		    });
		    $RoomLabelNo=1;
		    $('[name="ML_ROOM_NO[]"]:enabled').each(function(){
			$(this).parent('div').parent('li.activeNode').children('span.label').html('Room (Count-'+$RoomLabelNo+')');
			var measurementId=$(this).parent('div').parent('li.activeNode').children('div').find('[name="measurement[]"]').attr('data-product-id');
			$(measurementId).find('.roomTab').find('legend').html('Room (Count-'+$RoomLabelNo+')');
			$RoomLabelNo++;
		    });
		    $wallLabelNo=1;
		    $('[name="ML_WALL[]"]:enabled').each(function(){
			$(this).parent('div').parent('li.activeNode').children('span.label').html('Wall (Count-'+$wallLabelNo+')');
			var measurementId=$(this).parent('div').parent('li.activeNode').children('div').find('[name="measurement[]"]').attr('data-product-id');
			$(measurementId).find('.wallTab').find('legend').html('Wall (Count-'+$wallLabelNo+')');
			$wallLabelNo++;
		    });
		    $windowLabelNo=1;
		    $('[name="ML_WINDOW_NO[]"]:enabled').each(function(){
			$(this).parent('div').parent('li.activeNode').children('span.label').html('Window (Count-'+$windowLabelNo+')');
			var measurementId=$(this).parent('div').parent('li.activeNode').children('div').find('[name="measurement[]"]').attr('data-product-id');
			$(measurementId).find('.windowTab').find('legend').html('Window (Count-'+$windowLabelNo+')');
			$windowLabelNo++;
		    });
		}
		function closeChildren($this) {
		    if ($this.hasClass('glyphicon-plus')==true) {
			$this.closest('li').children('ul').collapse('show');
			$this.removeClass('glyphicon-plus').addClass('glyphicon-minus');
		    }else if ($this.hasClass('glyphicon-minus')==true) {
			$this.closest('li').children('ul').collapse('hide');
			$this.removeClass('glyphicon-minus').addClass('glyphicon-plus');
		    }
		}
		function mappingProductIdToWallAndRoom(){
		    $('[name="ML_ROOM_NO[]"]').each(function(){
			$windowMeasurementId=$(this).closest('ul').find('.window:first').attr('data-product-id');
			$(this).closest('ul').find('.wall:first').attr('data-product-id',$windowMeasurementId);
			$(this).closest('li').find('.room:first').attr('data-product-id',$windowMeasurementId);
		    });
		    $('[name="ML_WALL[]"]').each(function(){
			$windowMeasurementId=$(this).closest('li').find('.window:first').attr('data-product-id');
			$(this).closest('li').find('.wall:first').attr('data-product-id',$windowMeasurementId);
		    });
		}
		
		function loadLoader() {
		    $('body').addClass('loading').loader('show', { overlay: true });
		}
		function unLoader() {
			$('body').removeClass('loading').loader('hide');
		}
		
		function removePagetext(){
			$('[name="ML_BUILDING[]"]').closest('li').find('p').remove();
			$('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
				$(this).find('p').remove();
			});
		}
		
		$count=0;
		var $parentSysId="";
		function submitTreeFields(getSubmitMode){
			localStorage.setItem("SubmitMode", getSubmitMode);
			loadLoader();
			/* Internet Connection check */
			var networkState = navigator.network.connection.type;
			var states = {};
			states[Connection.UNKNOWN]  = 'Unknown connection';
			states[Connection.ETHERNET] = 'Ethernet connection';
			states[Connection.WIFI]     = 'WiFi connection';
			states[Connection.CELL_2G]  = 'Cell 2G connection';
			states[Connection.CELL_3G]  = 'Cell 3G connection';
			states[Connection.CELL_4G]  = 'Cell 4G connection'; 
			states[Connection.NONE]     = 'No network connection';
			//alert('[Connection](connection.html) type: ' + states[networkState]);
			if(states[networkState] == 'No network connection'){
				OfflinesubmitTreeFields(getSubmitMode);
			}else{
				OnlinesubmitTreeFields(getSubmitMode);
			}
		}
		
		
		<!-- Get The Measure Edit Data Start  -->
		
		// Online Values
function OnlinesubmitTreeFields(getSubmitMode) {
	$('.room').trigger('click');
	$('.wall').trigger('click');
	$('.window').trigger('click');
	
	/*if(getSubmitMode=='proceed'){
		setTimeout(OnlineSaveDataProceed, 20000);
	}else if(getSubmitMode=='wait'){
		setTimeout(OnlineSaveDataWait, 20000);
	}else{
		setTimeout(OnlineSaveDataType, 20000);
	}*/
	
	<!-- Online live Edit mode start -->
	
	var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
	
	//ajax
	var errorCount=0;
	$ML_Line_Value=0;
	if (errorCount==0) {
		var errorCount=0;
		$headSysId=1;
		if ($headSysId!=""){
			$buildingElement = $('[name="ML_BUILDING[]"]');
			$buildingValue = $buildingElement.val();
			//alert("build->"+$buildingValue);
			localStorage.setItem("fileldName", $buildingValue);
			localStorage.setItem("Data_level_id", '1');
			//alert("build"+$buildingElement.attr('data-mode'));
			
			if($buildingElement.attr('data-mode')=='edit'){
				insertNodesToDbInLive('', $buildingElement,'edit');
				$parentSysId=$buildingElement.attr('data-sys-id');
				//alert("parent-"+$parentSysId);
			}else if($buildingElement.attr('data-mode')=='noUpdate'){
				$parentSysId=$buildingElement.attr('data-sys-id');
			}else{
				$parentSysId = insertNodesToDbInLive($parentSysId, $buildingElement);
			}
			
			$('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
				//floor
				$floorInputElement=$(this).children('div').children('input');
				$floorValue = $floorInputElement.val();
				//alert("floor->"+$floorValue);
				localStorage.setItem("fileldName", $floorValue);
				localStorage.setItem("Data_level_id", '2');
				//alert("floor"+$floorInputElement.attr('data-mode'));
				if($floorInputElement.attr('data-mode')=='edit'){
					$floorParentSysId=$floorInputElement.attr('data-sys-id');
					//alert($(this).html());
					//alert("floor part-"+$parentSysId);
					insertNodesToDbInLive($parentSysId, $(this).children('div').children('input'),'edit');
				}else if($floorInputElement.attr('data-mode')=='noUpdate'){
					$floorParentSysId=$floorInputElement.attr('data-sys-id');
				}else{
					$floorParentSysId = insertNodesToDbInLive($parentSysId, $(this).children('div').children('input'));
				}
				
				$(this).children('ul.activeNode').children('li.activeNode').each(function (){								
					//appartment
					$appartmentInputElement=$(this).children('div').children('input');				    
					$appartmentValue = $appartmentInputElement.val();
					localStorage.setItem("fileldName", $appartmentValue);
					localStorage.setItem("Data_level_id", '3');
					//alert("aprt"+$appartmentInputElement.attr('data-mode'));
					if($appartmentInputElement.attr('data-mode')=='edit'){
						$appartmentParentSysId=$appartmentInputElement.attr('data-sys-id');
						insertNodesToDbInLive($floorParentSysId, $(this).children('div').children('input'),'edit');
					}else if($appartmentInputElement.attr('data-mode')=='noUpdate'){
						$appartmentParentSysId=$appartmentInputElement.attr('data-sys-id');
					}else{
						$appartmentParentSysId = insertNodesToDbInLive($floorParentSysId, $(this).children('div').children('input'));
					}
					
					$(this).children('ul.activeNode').children('li.activeNode').each(function (){
						//room
						$roomInputElement=$(this).children('div').children('input');
						$roomValue = $roomInputElement.val();
						localStorage.setItem("fileldName", $roomValue);
						localStorage.setItem("Data_level_id", '4');
						//alert("Room"+$roomInputElement.attr('data-mode'));
						if($roomInputElement.attr('data-mode')=='edit'){
						$roomParentSysId=$roomInputElement.attr('data-sys-id');
						insertNodesToDbInLive($appartmentParentSysId, $(this).children('div').children('input'),'edit');
						}else if($roomInputElement.attr('data-mode')=='noUpdate'){
						$roomParentSysId=$roomInputElement.attr('data-sys-id');
						}else{
						$roomParentSysId = insertNodesToDbInLive($appartmentParentSysId, $(this).children('div').children('input'));
						}
						var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');
						$roomTypeValue = $(measurementId).find('[name="ML_UNIT[]"]').val();
						
						$(this).children('ul.activeNode').children('li.activeNode').each(function (){
						
							//wall		
							$wallInputElement=$(this).children('div').children('input');
							$wallValue = $wallInputElement.val();
							localStorage.setItem("fileldName", $wallValue);
							localStorage.setItem("Data_level_id", '5');
							//alert("wall"+$wallInputElement.attr('data-mode'));
							if($wallInputElement.attr('data-mode')=='edit'){
								$wallParentSysId=$wallInputElement.attr('data-sys-id');
								insertNodesToDbInLive($roomParentSysId, $(this).children('div').children('input'),'edit');
							}else if($wallInputElement.attr('data-mode')=='noUpdate'){
								$wallParentSysId=$wallInputElement.attr('data-sys-id');
							}else{
								$wallParentSysId = insertNodesToDbInLive($roomParentSysId, $(this).children('div').children('input'));
							}
							var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');
							$wallFullWidthValue=$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val();
							$wallFullHeightValue=$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val();
							$levelType=$(measurementId).find('[name="MT_LEVEL_TYPE[]"]').val();
						
							$(this).children('ul.activeNode').children('li.activeNode').each(function (){
								//window
								$windowInputElement=$(this).children('div').children('input');
								$windowValue = $windowInputElement.val();
								localStorage.setItem("fileldName", $windowValue);
								localStorage.setItem("Data_level_id", '6');
								//alert("window-"+$windowInputElement.attr('data-mode'));
								if($windowInputElement.attr('data-mode')=='edit'){
								$windowParentSysId=$windowInputElement.attr('data-sys-id');
								insertNodesToDbInLive($wallParentSysId, $(this).children('div').children('input'),'edit',$levelType);
								}else if($windowInputElement.attr('data-mode')=='noUpdate'){
								$windowParentSysId=$windowInputElement.attr('data-sys-id');
								}else{
									$windowParentSysId = insertNodesToDbInLive($wallParentSysId, $(this).children('div').children('input'),'add',$levelType);
								}
								
								$buildingTypeValue = $(this).parents('div#step2').find('[name="ML_BULD_TYPE"]').val();
								$ML_Line_Value=$ML_Line_Value+1;
								$measurementId=localStorage.getItem("measurementId");
								$measurementId1=localStorage.getItem("measurementId");
								var measurementId=$(this).children('div').find('[name="measurement[]"]').attr('data-product-id');
								var modeOfLine = $(measurementId).find('[name="mode[]"]').val();
								//alert(modeOfLine);
								$measurementId1++;
								localStorage.setItem("measurementId", $measurementId1);
								var LSL_LOCN_CODE = localStorage.getItem("LSL_LOCN_CODE");
								$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val(LSL_LOCN_CODE);
								var headId = localStorage.getItem("HeadId");
								var USER_ID=localStorage.getItem("user_id");
								var USER_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
								$(measurementId).find('[name="headSysIdLines[]"]').val(headId);
								$(measurementId).find('[name="USER_ID[]"]').val(USER_ID);
								$(measurementId).find('[name="USER_COMP_CODE[]"]').val(USER_COMP_CODE);
								$(measurementId).find('[name="LINE_SYS_ID[]"]').val($windowParentSysId);
								$(measurementId).find('[name="buildingValue[]"]').val($buildingValue);
								$(measurementId).find('[name="floorValue[]"]').val($floorValue);
								$(measurementId).find('[name="appartmentValue[]"]').val($appartmentValue);
								$(measurementId).find('[name="roomValue[]"]').val($roomValue);
								$(measurementId).find('[name="wallValue[]"]').val($wallValue);
								$(measurementId).find('[name="windowValue[]"]').val($windowValue);
								$(measurementId).find('[name="buildingTypeValue[]"]').val($buildingTypeValue);
								var ML_UNIT_TEST=$(measurementId).find('[name="ML_UNIT[]"]').val();
								//alert("ML_UNIT_TEST->"+ML_UNIT_TEST);
								if(ML_UNIT_TEST == ""){
									var MlUnit = localStorage.getItem("NEW_ML_UNIT");
									//alert("MlUnit->"+MlUnit);
									$(measurementId).find('[name="roomTypeValue[]"]').val(MlUnit);
								}else{
									localStorage.removeItem("NEW_ML_UNIT");
									var ML_UNIT_NEW=$(measurementId).find('[name="ML_UNIT[]"]').val();
									//alert("ML_UNIT_NEW->"+ML_UNIT_NEW);
									$(measurementId).find('[name="roomTypeValue[]"]').val(ML_UNIT_NEW);
									localStorage.setItem("NEW_ML_UNIT",ML_UNIT_NEW);
								}
								$(measurementId).find('[name="ML_Line_Value[]"]').val($ML_Line_Value);
								$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val($wallFullHeightValue);
								$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val($wallFullWidthValue);
								var ML_OP_HEAD_SYS_ID_NEW = localStorage.getItem('ML_OP_HEAD_SYS_ID');
								var ML_SC_LINE_SYS_ID_NEW = localStorage.getItem('ML_SC_LINE_SYS_ID');
								var ML_LOCN_CODE = localStorage.getItem('ML_LOCN_CODE');
								//alert(ML_OP_HEAD_SYS_ID_NEW+"=="+ML_SC_LINE_SYS_ID_NEW);
								$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val(ML_OP_HEAD_SYS_ID_NEW);
								$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val(ML_SC_LINE_SYS_ID_NEW);
								$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val(ML_LOCN_CODE);
								var measurementInputs=$(measurementId+' :input').serializeArray();
								//$insertMeasurementLinesToDbInLive=insertMeasurementLinesToDbInLive(measurementId);
								insertMeasurementLinesToDbInLive(measurementInputs,measurementId);
							});
						});
					});
				});
			});
		}
	}
	return errorCount;
	
	<!-- Online live Edit mode end -->
}

function OnlineSaveDataProceed(){
	$('body').removeClass('loading').loader('hide');
	alert("Measurement Values Are Successfully Inserted");
	window.location="ScheduleTrackingDashboard_View.html";
	//alert("pro");
	localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
}

function OnlineSaveDataWait(){
	//alert("wait");
	//unLoader();
	window.location="Measure_Edit.html";
	//setTimeout(function(){ $(".next").click(); },1000);
	localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
}

function OnlineSaveDataType(){
	$('body').removeClass('loading').loader('hide');
	alert("Measurement Values Are Successfully Inserted");
	window.location="ScheduleTrackingDashboard_View.html";
	localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
	//window.location="index.html";
	
}


<!-- Online Edit Mode Data Insert Fn Start -->
		
function insertNodesToDbInLive($parentSysId,$inputElement,$mode,$levelType) {
	//firstcount=parseInt(firstcount)+1;
	//alert("$mode--"+$mode);
	var levelId=$inputElement.attr('data-level-id');
	var sysId=$inputElement.attr('data-sys-id');
	//alert(sysId+"--"+$mode);
	var MTDesc=$inputElement.val();
	var headSysId=localStorage.getItem("HeadId");
	var buildingTypeValue = $('[name="ML_BULD_TYPE"]').val();
	var USER_ID=localStorage.getItem("user_id");
	var USER_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
	//console.log(headSysId, 'getValfromHid');
	var resultData="";
	
	$.ajax({
	type:"POST",
	url:"http://test.sedarspine.com/en/spineLogisticsApp/insertMeasurementNodesToDbLogiApp",
	data:{levelId:levelId,MTDesc:MTDesc,parntSysId:$parentSysId,headSysId:headSysId,buildingTypeValue:buildingTypeValue,mode:$mode,levelType:$levelType,sysId:sysId,USER_ID:USER_ID,USER_COMP_CODE:USER_COMP_CODE},
	dataType:"json",
	async:false,
	success: function (result)
	{
		//alert("Tree-"+JSON.stringify(result));
		resultData=result.pSysId;
		$inputElement.attr('data-sys-id',result.pSysId);
		var sysId=$inputElement.attr('data-sys-id');
		//alert("after"+sysId);
		//$inputElement.attr('data-mode','noUpdate');
		//$inputElement.closest('div').append('<button class="hide" onclick="deleteMeasurementTreeInDb('+result.pSysId+')" name="deleteTree[]" type="button"></button>');
		if (levelId=='6') {
		$inputElement.closest('div').find('[name="measurement[]"]').addClass('window');
		$inputElement.closest('div').find('.sedar-white').attr('onClick','removeCurrentNode($(this),"window")');
		}else if (levelId=='5') {
		$inputElement.closest('div').find('.sedar-white').attr('onClick','removeCurrentNode($(this),"wall")');
		$inputElement.closest('div').find('[name="measurement[]"]').addClass('wall');
		}else{
		$inputElement.closest('div').find('.sedar-white').attr('onClick','removeCurrentNode($(this),"deleteProduct")');
		}
	}
	});
	
	return resultData;
}
var imageinertCount=1;
function insertMeasurementLinesToDbInLive(measurementInputs,measurementId){
	//alert("Line");
	
	$headSysId;
	$.ajax({
	type:"POST",
	url:"http://test.sedarspine.com/en/spineLogisticsApp/insertMeasurementLinesToDbLogiApp",
	data: measurementInputs,
	dataType:"json",
	async:false,
	success: function (result){
		//alert(result);
		//alert("Line-"+JSON.stringify(result));
		$headSysId=$('[name="headSysId"]').val();
		//alert("Line->"+result.Line_sys_Id);
		$(measurementId).find('[name="LINE_SYS_ID[]"]').val(result.Line_sys_Id);	
		//$(measurementId).find('[name="mode[]"]').val('noUpdate');
		$(measurementId).prepend('<button class="hide" onclick="deleteMeasurementLinesInDb('+result.Line_sys_Id+')" name="deleteLine[]" type="button"></button>');
		if (result.Line_sys_Id != null) {
			$('form'+measurementId+'_modal_data').find('[name="linesys_id[]"]').val(result.Line_sys_Id);
		}
		var headId = localStorage.getItem("HeadId");
		$('form'+measurementId+'_modal_data').find('[name="system_id[]"]').val(headId);
	   
		insertImagesInLive(measurementId);
		
	}
	});

	function successID(){
	  return true;
	}
	
	//images insert
	function insertImagesInLive(measurementId){
		//alert("img");
		var imageId=measurementId+'_modal_data';
		var mode_check = $(imageId).find('[name="mode_check[]"]').val();
		var mode = $(imageId).find('[name="mode[]"]').val();
		//alert(mode+"<- mode_check->"+mode_check);
		var MI_MH_SYS_ID=localStorage.getItem("HeadId");
		//alert("head->"+MI_MH_SYS_ID);
		var MI_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
		var USER_ID=localStorage.getItem("user_id");
		var MI_ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
		var LANG_CODE = "en";
		var MI_SYS_ID = $(imageId).find('[name="BP_MI_SYS_ID[]"]').val();
		//alert("Bp-"+MI_SYS_ID);
		var NameImage = Math.floor((Math.random() * 10000000000) + 1)+".png";
		var imgSrc1 = "https://sedarspine.s3.amazonaws.com/LOGI/"+NameImage;
		//prompt("img-",imgSrc1);
		var fileName = NameImage;
		var MI_DESC = "bluePrintImage";
		var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
		
		/*var className = $(imageId).find("#Imagecount").children('div#RemoveImg').attr('class');
		prompt("class",className);
		$(imageId).find("#Imagecount").children('div.'+className+'').each(function (){

		  $("#RemoveImg").html('<span onclick="DeleteImg($(this))" class="close glyphicon glyphicon-trash"></span><img id="imgProfile" name="imgProfile[]" src="'+dataURL+'" data-src="'+imgSrc1+'" style="width:50%;height:50%"><input type="hidden" name="mode[]" value="edit">');

		});*/
		
		//$(imageId).find("#Imagecount").html('<div id="RemoveImg" class="form-group"><span onclick="DeleteImg($(this))" class="close glyphicon glyphicon-trash"></span><img id="imgProfile" name="imgProfile[]" src="'+dataURL+'" data-src="'+imgSrc1+'" style="width:50%;height:50%"><input type="hidden" name="mode[]" value="edit"></div>');
		//prompt("dataURL->",dataURL);
		var blobBin = atob(dataURL.split(',')[1]);
		var array   = [];
		for(var i = 0; i < blobBin.length; i++) {
			array.push(blobBin.charCodeAt(i));
		}
		var file=new Blob([new Uint8Array(array)], {type: 'image/png'});
		var FileSize = (file.size/1024).toFixed(2)+"KB";
		var data = new FormData();
		data.append('file', file,fileName);
		//alert("BP desc-"+MI_DESC);
		$.ajax({
			type: "POST",
			url: "http://test.sedarspine.com/en/spineLogisticsApp/MeasureLinesCanvas_Upload",
			data :  data,
			contentType: false,
			processData: false,
			success: function (data){
				//alert("success");
				//alert(data);
				//prompt("data-",data);
			},error: function (xhr, ajaxOptions, thrownError) {
				//alert("Error");
				//alert(xhr);alert(ajaxOptions);alert(thrownError);
			}
		});
		//prompt("",mode_check+"--"+MI_SYS_ID+"--"+MI_ML_SYS_ID+"--"+MI_MH_SYS_ID+"--"+MI_IMAGE+"--"+USER_ID+"--"+MI_DESC+"--"+MI_SIZE+"--"+LANG_CODE+"--"+MI_COMP_CODE);
		$.ajax({
			type:"POST",
			url:'http://test.sedarspine.com/en/spineLogisticsApp/OnlineMeasureEditImages',
			data:{MODE:mode_check,MI_SYS_ID:MI_SYS_ID,MI_ML_SYS_ID:MI_ML_SYS_ID,MI_MH_SYS_ID:MI_MH_SYS_ID,MI_IMAGE:imgSrc1,USER_ID:USER_ID,MI_DESC:MI_DESC,MI_SIZE:FileSize,LANG_CODE:LANG_CODE,MI_COMP_CODE:MI_COMP_CODE},
			dataType:"json",
			async:false,
			success: function (addresult)
			{
				//alert(addresult);
				//alert("Bp->"+JSON.stringify(addresult));
			},error: function (xhr, ajaxOptions, thrownError) {
				//alert("Error");
				//alert(xhr);alert(ajaxOptions);alert(thrownError);
			}
		});
		$(imageId).find('[name="imgProfile[]"]').each(function(){
			//alert("image count tag");
			var Desc=$(this).attr('data-desc');
			//alert("Desc->"+Desc);
			if(Desc != "bluePrintImage"){
				var imgSrc=$(this).attr('data-src');
				//prompt("",imgSrc);
				var FileSize =$(this).attr('data-val');
				var mode =$(this).attr('data-mode');
				if(mode=='add'){
					var FileSize = $(imageId).find('[name="size[]"]').attr('value');
				}
				//alert("mode->"+mode);
				var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
				var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
				//prompt("",path);
				var MI_SYS_ID = $(imageId).find('[name="MI_SYS_ID[]"]').val();
				//alert("img-"+MI_SYS_ID);
				var ML_MH_SYS_ID=localStorage.getItem("HeadId");
				var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
				var USER_ID=localStorage.getItem("user_id");
				var MI_DESC = "otherImage";
				var LANG_CODE = "en";
				//alert("img desc-"+MI_DESC);
				$.ajax({
					type:"POST",
					url:'http://test.sedarspine.com/en/spineLogisticsApp/OnlineMeasureEditImages',
					data:{MODE:mode,MI_SYS_ID:MI_SYS_ID,MI_ML_SYS_ID:MI_ML_SYS_ID,MI_MH_SYS_ID:MI_MH_SYS_ID,MI_IMAGE:path,USER_ID:USER_ID,MI_DESC:MI_DESC,MI_SIZE:FileSize,LANG_CODE:LANG_CODE,MI_COMP_CODE:MI_COMP_CODE},
					dataType:"json",
					async:false,
					success: function (addresult)
					{
						//alert(result);
						//alert("img->"+JSON.stringify(addresult));
					}
				});
			}
			
		});
	}
	
}

<!-- Online Edit Mode Data Insert Fn End -->


// Offline Values

function OfflinesubmitTreeFields(getSubmitMode) {
	//alert("Offline");
	
	$('.room').trigger('click');
	$('.wall').trigger('click');
	$('.window').trigger('click');
	
	/*if(getSubmitMode=='proceed'){
		setTimeout(OfflineSaveDataProceed, 30000);
	}else if(getSubmitMode=='wait'){
		setTimeout(OfflineSaveDataWait, 30000);
	}else{
		setTimeout(OfflineSaveDataType, 30000);
	}*/
	
	
	<!-- CheckMode function start -->
			
	var CheckMode = localStorage.getItem("LiveMode");
	//alert(CheckMode);
	if(CheckMode=="live_edit_mode"){
		//alert("Offline live Edit mode start");
		<!-- Offline live Edit mode start -->
		
		<!-- Delete function start  -->
		var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
		db.transaction(function(tx){
			var HeadId=localStorage.getItem("HeadId");
			//alert("HeadId->"+HeadId);
			tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("Tree deleted");
			});

			tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("Line deleted");
			});

			tx.executeSql('DELETE FROM LIVE_BluePrintImage WHERE MI_ML_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("BluePrintImage deleted");
			});

			tx.executeSql('DELETE FROM LIVE_LOGI_T_MEASURE_IMAGE WHERE ML_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("image deleted");
			});

		});
		
		<!-- Delete function end -->
		/*
		 var errorCount=0;
		    $('[name="ML_BUILDING[]"]').closest('li').find('p').remove();
			if ($('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').html()==null) {
			    $('[name="ML_BUILDING[]"]').closest('li:visible').append('<p style="color:red">Please add until Window</p>');
			    errorCount++;
			}
		    $('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
			//floor		
			$(this).find('p').remove();
			if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
			    $(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
			    $(this).append('<p style="color:red">Please add until Window</p>');
			    errorCount++;
			}
			$(this).children('ul.activeNode').children('li.activeNode').each(function (){
			    //appartment
			    if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				$(this).append('<p style="color:red">Please add until Window</p>');
				errorCount++;
			    }
			    $(this).children('ul.activeNode').children('li.activeNode').each(function (){
				//room
				if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				    $(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				    $(this).append('<p style="color:red">Please add until Window</p>');
				    errorCount++;
				}
				$(this).children('ul.activeNode').children('li.activeNode').each(function (){
				    //wall
				    if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
					$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
					$(this).append('<p style="color:red">Please add until Window</p>');
					errorCount++;
				    }
				    $(this).children('ul.activeNode').children('li.activeNode').each(function (){
					
				    });
				});
			    });
			});
		    });*/
		
		//ajax
		var errorCount=0;
		$ML_Line_Value=0;
		if (errorCount==0) {
			var errorCount=0;
			$headSysId=1;
			if ($headSysId!=""){
				$buildingElement = $('[name="ML_BUILDING[]"]');
				$buildingValue = $buildingElement.val();
				//alert("build->"+$buildingValue);
				localStorage.setItem("fileldName", $buildingValue);
				localStorage.setItem("Data_level_id", '1');
				//alert("build"+$buildingElement.attr('data-mode'));
				
				if($buildingElement.attr('data-mode')=='edit'){
					insertNodesToDbInOffline('', $buildingElement,'edit');
					$parentSysId=$buildingElement.attr('data-sys-id');
					//alert("parent-"+$parentSysId);
				}else if($buildingElement.attr('data-mode')=='noUpdate'){
					$parentSysId=$buildingElement.attr('data-sys-id');
				}else{
					$parentSysId = insertNodesToDbInOffline($parentSysId, $buildingElement);
				}
				
				$('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
					//floor
					$floorInputElement=$(this).children('div').children('input');
					$floorValue = $floorInputElement.val();
					//alert("floor->"+$floorValue);
					localStorage.setItem("fileldName", $floorValue);
					localStorage.setItem("Data_level_id", '2');
					//alert("floor"+$floorInputElement.attr('data-mode'));
					if($floorInputElement.attr('data-mode')=='edit'){
						$floorParentSysId=$floorInputElement.attr('data-sys-id');
						//alert($(this).html());
						//alert("floor part-"+$parentSysId);
						insertNodesToDbInOffline($parentSysId, $(this).children('div').children('input'),'edit');
					}else if($floorInputElement.attr('data-mode')=='noUpdate'){
						$floorParentSysId=$floorInputElement.attr('data-sys-id');
					}else{
						$floorParentSysId = insertNodesToDbInOffline($parentSysId, $(this).children('div').children('input'));
					}
					
					$(this).children('ul.activeNode').children('li.activeNode').each(function (){								
						//appartment
						$appartmentInputElement=$(this).children('div').children('input');				    
						$appartmentValue = $appartmentInputElement.val();
						localStorage.setItem("fileldName", $appartmentValue);
						localStorage.setItem("Data_level_id", '3');
						//alert("aprt"+$appartmentInputElement.attr('data-mode'));
						if($appartmentInputElement.attr('data-mode')=='edit'){
							$appartmentParentSysId=$appartmentInputElement.attr('data-sys-id');
							insertNodesToDbInOffline($floorParentSysId, $(this).children('div').children('input'),'edit');
						}else if($appartmentInputElement.attr('data-mode')=='noUpdate'){
							$appartmentParentSysId=$appartmentInputElement.attr('data-sys-id');
						}else{
							$appartmentParentSysId = insertNodesToDbInOffline($floorParentSysId, $(this).children('div').children('input'));
						}
						
						$(this).children('ul.activeNode').children('li.activeNode').each(function (){
							//room
							$roomInputElement=$(this).children('div').children('input');
							$roomValue = $roomInputElement.val();
							localStorage.setItem("fileldName", $roomValue);
							localStorage.setItem("Data_level_id", '4');
							//alert("Room"+$roomInputElement.attr('data-mode'));
							if($roomInputElement.attr('data-mode')=='edit'){
							$roomParentSysId=$roomInputElement.attr('data-sys-id');
							insertNodesToDbInOffline($appartmentParentSysId, $(this).children('div').children('input'),'edit');
							}else if($roomInputElement.attr('data-mode')=='noUpdate'){
							$roomParentSysId=$roomInputElement.attr('data-sys-id');
							}else{
							$roomParentSysId = insertNodesToDbInOffline($appartmentParentSysId, $(this).children('div').children('input'));
							}
							var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');
							$roomTypeValue = $(measurementId).find('[name="ML_UNIT[]"]').val();
							
							$(this).children('ul.activeNode').children('li.activeNode').each(function (){
							
								//wall		
								$wallInputElement=$(this).children('div').children('input');
								$wallValue = $wallInputElement.val();
								localStorage.setItem("fileldName", $wallValue);
								localStorage.setItem("Data_level_id", '5');
								//alert("wall"+$wallInputElement.attr('data-mode'));
								if($wallInputElement.attr('data-mode')=='edit'){
									$wallParentSysId=$wallInputElement.attr('data-sys-id');
									insertNodesToDbInOffline($roomParentSysId, $(this).children('div').children('input'),'edit');
								}else if($wallInputElement.attr('data-mode')=='noUpdate'){
									$wallParentSysId=$wallInputElement.attr('data-sys-id');
								}else{
									$wallParentSysId = insertNodesToDbInOffline($roomParentSysId, $(this).children('div').children('input'));
								}
								var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');
								$wallFullWidthValue=$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val();
								$wallFullHeightValue=$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val();
								$levelType=$(measurementId).find('[name="MT_LEVEL_TYPE[]"]').val();
							
								$(this).children('ul.activeNode').children('li.activeNode').each(function (){
									//window
									$windowInputElement=$(this).children('div').children('input');
									$windowValue = $windowInputElement.val();
									localStorage.setItem("fileldName", $windowValue);
									localStorage.setItem("Data_level_id", '6');
									//alert("window-"+$windowInputElement.attr('data-mode'));
									if($windowInputElement.attr('data-mode')=='edit'){
									$windowParentSysId=$windowInputElement.attr('data-sys-id');
									insertNodesToDbInOffline($wallParentSysId, $(this).children('div').children('input'),'edit',$levelType);
									}else if($windowInputElement.attr('data-mode')=='noUpdate'){
									$windowParentSysId=$windowInputElement.attr('data-sys-id');
									}else{
										$windowParentSysId = insertNodesToDbInOffline($wallParentSysId, $(this).children('div').children('input'),'add',$levelType);
									}
									
									$buildingTypeValue = $(this).parents('div#step2').find('[name="ML_BULD_TYPE"]').val();
									$ML_Line_Value=$ML_Line_Value+1;
									$measurementId=localStorage.getItem("measurementId");
									$measurementId1=localStorage.getItem("measurementId");
									var measurementId=$(this).children('div').find('[name="measurement[]"]').attr('data-product-id');
									var modeOfLine = $(measurementId).find('[name="mode[]"]').val();
									//alert(modeOfLine);
									$measurementId1++;
									localStorage.setItem("measurementId", $measurementId1);
									var LSL_LOCN_CODE = localStorage.getItem("LSL_LOCN_CODE");
									$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val(LSL_LOCN_CODE);
									var headId = localStorage.getItem("HeadId");
									var USER_ID=localStorage.getItem("user_id");
									var USER_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
									$(measurementId).find('[name="headSysIdLines[]"]').val(headId);
									$(measurementId).find('[name="USER_ID[]"]').val(USER_ID);
									$(measurementId).find('[name="USER_COMP_CODE[]"]').val(USER_COMP_CODE);
									$(measurementId).find('[name="LINE_SYS_ID[]"]').val($windowParentSysId);
									$(measurementId).find('[name="buildingValue[]"]').val($buildingValue);
									$(measurementId).find('[name="floorValue[]"]').val($floorValue);
									$(measurementId).find('[name="appartmentValue[]"]').val($appartmentValue);
									$(measurementId).find('[name="roomValue[]"]').val($roomValue);
									$(measurementId).find('[name="wallValue[]"]').val($wallValue);
									$(measurementId).find('[name="windowValue[]"]').val($windowValue);
									$(measurementId).find('[name="buildingTypeValue[]"]').val($buildingTypeValue);
									var ML_UNIT_TEST=$(measurementId).find('[name="ML_UNIT[]"]').val();
									//alert("ML_UNIT_TEST->"+ML_UNIT_TEST);
									if(ML_UNIT_TEST == ""){
										var MlUnit = localStorage.getItem("NEW_ML_UNIT");
										//alert("MlUnit->"+MlUnit);
										$(measurementId).find('[name="roomTypeValue[]"]').val(MlUnit);
									}else{
										localStorage.removeItem("NEW_ML_UNIT");
										var ML_UNIT_NEW=$(measurementId).find('[name="ML_UNIT[]"]').val();
										//alert("ML_UNIT_NEW->"+ML_UNIT_NEW);
										$(measurementId).find('[name="roomTypeValue[]"]').val(ML_UNIT_NEW);
										localStorage.setItem("NEW_ML_UNIT",ML_UNIT_NEW);
									}
									$(measurementId).find('[name="ML_Line_Value[]"]').val($ML_Line_Value);
									$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val($wallFullHeightValue);
									$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val($wallFullWidthValue);
									var ML_OP_HEAD_SYS_ID_NEW = localStorage.getItem('ML_OP_HEAD_SYS_ID');
									var ML_SC_LINE_SYS_ID_NEW = localStorage.getItem('ML_SC_LINE_SYS_ID');
									//alert(ML_OP_HEAD_SYS_ID_NEW+"=="+ML_SC_LINE_SYS_ID_NEW);
									$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val(ML_OP_HEAD_SYS_ID_NEW);
									$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val(ML_SC_LINE_SYS_ID_NEW);
									var measurementInputs=$(measurementId+' :input').serializeArray();
									insertMeasurementLinesToDbInOffline(measurementId);
								});
							});
						});
					});
				});
			}
		}
		//return errorCount;
		
		<!-- Offline live Edit mode end -->
		
	}else{
		//alert("Logi App edit fn");
		<!-- Offline Edit Mode start -->
		
		<!-- Delete function start  -->
		var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
		db.transaction(function(tx){
			var HeadId=localStorage.getItem("HeadId");
			//alert("HeadId->"+HeadId);
			tx.executeSql('DELETE FROM LOGI_T_MEASURE_TREE WHERE MT_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("Tree deleted");
			});

			tx.executeSql('DELETE FROM LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("Line deleted");
			});

			tx.executeSql('DELETE FROM BluePrintImage WHERE MI_ML_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("BluePrintImage deleted");
			});

			tx.executeSql('DELETE FROM LOGI_T_MEASURE_IMAGE WHERE ML_MH_SYS_ID=? ', [HeadId], function (tx, results) {
				//alert("image deleted");
			});

		});
		
		<!-- Delete function end -->
		/*
		var errorCount=0;
		$('[name="ML_BUILDING[]"]').closest('li').find('p').remove();
		if ($('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').html()==null) {
			$('[name="ML_BUILDING[]"]').closest('li:visible').append('<p style="color:red">Please add until Window</p>');
			errorCount++;
		}
		$('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
		//floor		
		$(this).find('p').remove();
		if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
			$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
			$(this).append('<p style="color:red">Please add until Window</p>');
			errorCount++;
		}
		$(this).children('ul.activeNode').children('li.activeNode').each(function (){
			//appartment
			if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
			$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
			$(this).append('<p style="color:red">Please add until Window</p>');
			errorCount++;
			}
			$(this).children('ul.activeNode').children('li.activeNode').each(function (){
			//room
			if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				$(this).append('<p style="color:red">Please add until Window</p>');
				errorCount++;
			}
			$(this).children('ul.activeNode').children('li.activeNode').each(function (){
				//wall
				if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				$(this).append('<p style="color:red">Please add until Window</p>');
				errorCount++;
				}
				$(this).children('ul.activeNode').children('li.activeNode').each(function (){
				
				});
			});
			});
		});
		});*/
		
		//ajax
		var errorCount=0;
		$ML_Line_Value=0;
		if (errorCount==0) {
			var errorCount=0;
			$headSysId=1;
			if ($headSysId!=""){
				$buildingElement = $('[name="ML_BUILDING[]"]');
				$buildingValue = $buildingElement.val();
				//alert("build->"+$buildingValue);
				localStorage.setItem("fileldName", $buildingValue);
				localStorage.setItem("Data_level_id", '1');
				
				
				if($buildingElement.attr('data-mode')=='edit'){
					insertNodesToDb('', $buildingElement,'edit');
					$parentSysId=$buildingElement.attr('data-sys-id');
				}else if($buildingElement.attr('data-mode')=='noUpdate'){
					$parentSysId=$buildingElement.attr('data-sys-id');
				}else{
					$parentSysId = insertNodesToDb($parentSysId, $buildingElement);
				}
				
				$('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
					//floor
					$floorInputElement=$(this).children('div').children('input');
					$floorValue = $floorInputElement.val();
					//alert("floor->"+$floorValue);
					localStorage.setItem("fileldName", $floorValue);
					if($floorInputElement.attr('data-mode')=='edit'){
						$floorParentSysId=$floorInputElement.attr('data-sys-id');
						//alert("floor"+$floorParentSysId);
						//alert($(this).html());
						localStorage.setItem("Data_level_id", '2');
						insertNodesToDb($parentSysId, $(this).children('div').children('input'),'edit');
					}else if($floorInputElement.attr('data-mode')=='noUpdate'){
						$floorParentSysId=$floorInputElement.attr('data-sys-id');
					}else{
						localStorage.setItem("Data_level_id", '2');
						$floorParentSysId = insertNodesToDb($parentSysId, $(this).children('div').children('input'));
					}
					
					$(this).children('ul.activeNode').children('li.activeNode').each(function (){
						$appartmentInputElement=$(this).children('div').children('input');				    
						$appartmentValue = $appartmentInputElement.val();
						//alert("$appartmentValue->"+$appartmentValue);
						localStorage.setItem("fileldName", $appartmentValue);
						localStorage.setItem("Data_level_id", '3');
						$appartmentParentSysId = insertNodesToDb($floorParentSysId, $(this).children('div').children('input'));
						$(this).children('ul.activeNode').children('li.activeNode').each(function (){
							//room
							//alert("room");
							$roomInputElement=$(this).children('div').children('input');
							$roomValue = $roomInputElement.val();
							//alert("$roomValue->"+$roomValue);
							localStorage.setItem("fileldName", $roomValue);
							localStorage.setItem("Data_level_id", '4');
								$roomParentSysId = insertNodesToDb($appartmentParentSysId, $(this).children('div').children('input'));
							
							var measurementId=$parentSysId;
							$roomTypeValue = $(measurementId).find('[name="ML_UNIT[]"]').val();
							//alert("$roomTypeValue->"+$roomTypeValue);
							$(this).children('ul.activeNode').children('li.activeNode').each(function (){
							
								//wall
								//alert("wall");
								$wallInputElement=$(this).children('div').children('input');
								$wallValue = $wallInputElement.val();
								//alert("$wallValue->"+$wallValue);
								localStorage.setItem("fileldName", $wallValue);
								localStorage.setItem("Data_level_id", '5');
								$wallParentSysId = insertNodesToDb($roomParentSysId, $(this).children('div').children('input'));
								
								$measurementId=localStorage.getItem("measurementId");
								var measurementId=$(this).children('div').find('[ name="measurement[]"]').attr('data-product-id');
								$wallFullWidthValue=$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val();
								$wallFullHeightValue=$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val();
								$levelType=$(measurementId).find('[name="MT_LEVEL_TYPE[]"]').val();
								//alert("$levelType->"+$levelType);
								$(this).children('ul.activeNode').children('li.activeNode').each(function (){
										//window
										//alert("window");
										$windowInputElement=$(this).children('div').children('input');
										$windowValue = $windowInputElement.val();
										//alert("$windowValue->"+$windowValue);
										localStorage.setItem("fileldName", $windowValue);
										localStorage.setItem("Data_level_id", '6');
										$windowParentSysId = insertNodesToDb($wallParentSysId, $(this).children('div').children('input'),'add',$levelType);
										//alert("$windowParentSysId->"+$windowParentSysId);
									//alert("$buildingTypeValue-->"+buildingTypeValue);
									$buildingTypeValue = $(this).parents('div#step2').find('[name="ML_BULD_TYPE"]').val();
									$ML_Line_Value=$ML_Line_Value+1;
									$measurementId=localStorage.getItem("measurementId");
									$measurementId1=localStorage.getItem("measurementId");
									var measurementId=$(this).children('div').find('[name="measurement[]"]').attr('data-product-id');
									$measurementId1++;
									localStorage.setItem("measurementId", $measurementId1);
									$(measurementId).find('[name="LINE_SYS_ID[]"]').val($windowParentSysId);
									$(measurementId).find('[name="buildingValue[]"]').val($buildingValue);
									$(measurementId).find('[name="floorValue[]"]').val($floorValue);
									$(measurementId).find('[name="appartmentValue[]"]').val($appartmentValue);
									$(measurementId).find('[name="roomValue[]"]').val($roomValue);
									$(measurementId).find('[name="wallValue[]"]').val($wallValue);
									$(measurementId).find('[name="windowValue[]"]').val($windowValue);
									$(measurementId).find('[name="buildingTypeValue[]"]').val($buildingTypeValue);
									var ML_UNIT_TEST=$(measurementId).find('[name="ML_UNIT[]"]').val();
									//alert("ML_UNIT_TEST->"+ML_UNIT_TEST);
									if(ML_UNIT_TEST == ""){
										var MlUnit = localStorage.getItem("NEW_ML_UNIT");
										//alert("MlUnit->"+MlUnit);
										$(measurementId).find('[name="roomTypeValue[]"]').val(MlUnit);
									}else{
										localStorage.removeItem("NEW_ML_UNIT");
										var ML_UNIT_NEW=$(measurementId).find('[name="ML_UNIT[]"]').val();
										//alert("ML_UNIT_NEW->"+ML_UNIT_NEW);
										$(measurementId).find('[name="roomTypeValue[]"]').val(ML_UNIT_NEW);
										localStorage.setItem("NEW_ML_UNIT",ML_UNIT_NEW);
									}
									$(measurementId).find('[name="ML_Line_Value[]"]').val($ML_Line_Value);
									$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val($wallFullHeightValue);
									$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val($wallFullWidthValue);
									var ML_OP_HEAD_SYS_ID_NEW = localStorage.getItem('ML_OP_HEAD_SYS_ID');
									var ML_SC_LINE_SYS_ID_NEW = localStorage.getItem('ML_SC_LINE_SYS_ID');
									//alert(ML_OP_HEAD_SYS_ID_NEW+"=="+ML_SC_LINE_SYS_ID_NEW);
									$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val(ML_OP_HEAD_SYS_ID_NEW);
									$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val(ML_SC_LINE_SYS_ID_NEW);
									$insertMeasurementLinesToDb=insertMeasurementLinesToDb(measurementId);
								});
							});
						});
					});
				});
			}
		}
		//return errorCount;
		
		
		<!-- Offline Edit Mode end -->
	}
	
	<!-- CheckMode function end -->	
}


function OfflineSaveDataProceed(){
	$('body').removeClass('loading').loader('hide');
	alert("Measurement Values Are Successfully Inserted");
	window.location="ScheduleTrackingDashboard_View.html";
	localStorage.setItem("GetDataTree","OfflineNewData");
	//alert("pro");
	localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
}

function OfflineSaveDataWait(){
	//alert("wait");
	localStorage.setItem("GetDataTree","OfflineNewData");
	$('body').removeClass('loading').loader('hide');
	window.location="Measure_Edit.html";
	localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
}

function OfflineSaveDataType(){
	$('body').removeClass('loading').loader('hide');
	alert("Measurement Values Are Successfully Inserted");
	window.location="ScheduleTrackingDashboard_View.html";
	localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
	//window.location="index.html";
	
}


<!-- Online Edit Mode Data Insert Fn Start -->
	
	function insertNodesToDbInOffline($parentSysId,$inputElement,$mode,$levelType) {
			
			firstcount=parseInt(firstcount)+1;
			localStorage.setItem("WindowTypeLocal", $levelType);
			var MT_MH_SYS_ID=localStorage.getItem("HeadId");
			var MT_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
			//var MT_SYS_ID=$inputElement.attr('data-sys-id');
			var SYS_ID=$inputElement.attr('data-sys-id');
			if(SYS_ID==undefined){
				//var MT_SYS_ID=$inputElement.attr('data-sys-id');
				var id = localStorage.getItem("MeasureTreeID");
				//alert(id);
				var MT_SYS_ID=parseInt(id)+10;
				//alert(MT_SYS_ID);
				localStorage.setItem("MeasureTreeID",MT_SYS_ID);
			}else{
				var MT_SYS_ID=$inputElement.attr('data-sys-id');
				localStorage.setItem("MeasureTreeID",MT_SYS_ID);
			}
			var MT_DESC=localStorage.getItem("fileldName");
			var MT_LEVEL_ID=$inputElement.attr('data-level-id');
			var MT_LEVEL_TYPE=localStorage.getItem("Data_level_id");
			var MT_BUILD_TYPE=$('[name="ML_BULD_TYPE"]').val();
			var LANG_CODE="en";
			var USER_ID=localStorage.getItem("user_id");
			var Local_SelectNodeToDb;
			var treeHeadId = localStorage.getItem("treeHeadId");
			
			var MT_PARENT_SYS_ID=$parentSysId;
			var LEVEL_ID=$inputElement.attr('data-level-id');
			if(LEVEL_ID==1){
				var MT_LEVEL_ID=1;
			}else if(LEVEL_ID==3){
				var MT_LEVEL_ID=3;
			}else if(LEVEL_ID==4){
				var MT_LEVEL_ID=4;
			}else if(LEVEL_ID==5){
				var MT_LEVEL_ID=5;
			}else if(LEVEL_ID==6){
				var MT_LEVEL_ID=6;
			}else{
				var MT_LEVEL_ID=2;
				//var MT_PARENT_SYS_ID=parseInt(MT_SYS_ID)-1;
			}
			var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			db.transaction(function(tx){
				tx.executeSql("INSERT INTO LIVE_LOGI_T_MEASURE_TREE ('MT_MH_SYS_ID' ,'MT_COMP_CODE' ,'MT_SYS_ID' ,'MT_DESC' ,'MT_PARENT_SYS_ID' ,'MT_LEVEL_ID' ,'MT_LEVEL_TYPE' ,'MT_BUILD_TYPE' ,'LANG_CODE' ,'USER_ID','MT_MODE') VALUES (?,?,?,?,?,?,?,?,?,?,?)",[MT_MH_SYS_ID ,MT_COMP_CODE ,MT_SYS_ID ,MT_DESC ,MT_PARENT_SYS_ID ,MT_LEVEL_ID ,MT_LEVEL_TYPE ,MT_BUILD_TYPE ,LANG_CODE ,USER_ID,$mode],function(tx, results){
					Local_SelectNodeToDb = results.insertId;
				});
			});
			return MT_SYS_ID;
		}
		var imageinertCount=1;
		function insertMeasurementLinesToDbInOffline(measurementId){
			var mode = $(measurementId).find('[name="mode[]"]').val();
			//alert("mode->"+mode);
			var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
			var ML_MH_SYS_ID=localStorage.getItem("HeadId");
			var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
			var ML_LANG_CODE="en";
			var currentDate = moment();
			//var ML_TXN_DT=$(measurementId).find('[name="MH_TXN_DT[]"]').val();
			var ML_TXN_DT=moment(currentDate).format('DD-MMM-YYYY');
			var ML_LOCN_CODE=$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val();
			if(ML_LOCN_CODE==""){
				var ML_LOCN_CODE=localStorage.getItem("locationCode");
			}else{
				var ML_LOCN_CODE=$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val();
				localStorage.setItem("locationCode",ML_LOCN_CODE);
			}
			var ML_LINE=$(measurementId).find('[name="ML_Line_Value[]"]').val();
			var ML_BULD_TYPE=$(measurementId).find('[name="buildingTypeValue[]"]').val();
			var ML_BUILD=$(measurementId).find('[name="buildingValue[]"]').val();    	
			var ML_FLOOR=$(measurementId).find('[name="floorValue[]"]').val();
			var ML_FLAT=$(measurementId).find('[name="appartmentValue[]"]').val();
			var ML_UNIT=$(measurementId).find('[name="roomTypeValue[]"]').val();
			var ML_WIDTH=$(measurementId).find('[name="ML_WIDTH[]"]').val();
			var ML_HEIGHT=$(measurementId).find('[name="ML_HEIGHT[]"]').val();
			var ML_MOUNT_TYPE=$(measurementId).find('[name="ML_MOUNT_TYPE[]"]').val();
			var ML_MOUNT_ON=$(measurementId).find('[name="ML_MOUNT_ON[]"]').val();
			var ML_OPERATE=$(measurementId).find('[name="ML_OPERATE[]"]').val();
			var ML_CONTROL=$(measurementId).find('[name="ML_CONTROL[]"]').val();
			var ML_OPENING=$(measurementId).find('[name="ML_OPENING[]"]').val();
			var ML_PELMET=$(measurementId).find('[name="ML_PELMET[]"]').val();
			var ML_DESIGN_DEPTH=$(measurementId).find('[name="ML_DESIGN_DEPTH[]"]').val();
			var ML_PROJECTION=$(measurementId).find('[name="ML_PROJECTION[]"]').val();
			var ML_FASICA=$(measurementId).find('[name="ML_FASICA[]"]').val();
			var ML_REMARKS=$(measurementId).find('[name="ML_REMARKS[]"]').val();
			var ML_CLOSE_YN="'N'";
			var ML_OP_HEAD_SYS_ID=$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val();
			var ML_SC_LINE_SYS_ID=$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val();
			if(ML_OP_HEAD_SYS_ID==""){
				var ML_OP_HEAD_SYS_ID = localStorage.getItem("ML_OP_headSysId");
			}else{
				var ML_OP_HEAD_SYS_ID=$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val();
				localStorage.setItem("ML_OP_headSysId",ML_OP_HEAD_SYS_ID);
			}
			if(ML_SC_LINE_SYS_ID==""){
				var ML_SC_LINE_SYS_ID = localStorage.getItem("ML_OP_lineSysId");
			}else{
				var ML_SC_LINE_SYS_ID=$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val();
				localStorage.setItem("ML_OP_lineSysId",ML_SC_LINE_SYS_ID);
			}
			var ML_FULL_WIDTH=$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val();
			var ML_FULL_HEIGHT=$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val();
			var ML_LEFT_WALL=$(measurementId).find('[name="ML_LEFT_WALL[]"]').val();
			var ML_RIGHT_WALL=$(measurementId).find('[name="ML_RIGHT_WALL[]"]').val();
			var ML_CEILING_UP=$(measurementId).find('[name="ML_CEILING_UP[]"]').val();
			var ML_FLOOR_DOWN=$(measurementId).find('[name="ML_FLOOR_DOWN[]"]').val();
			var ML_WINDOW_DEPTH=$(measurementId).find('[name="ML_WINDOW_DEPTH[]"]').val();
			var ML_WINDOW_OPENING=$(measurementId).find('[name="ML_WINDOW_OPENING[]"]').val();
			var ML_HANDLE_POSITION=$(measurementId).find('[name="ML_HANDLE_POSITION[]"]').val();
			var ML_HANDLE_SIZE=$(measurementId).find('[name="ML_HANDLE_SIZE[]"]').val();
			var ML_POWER_DISTANCE=$(measurementId).find('[name="ML_POWER_DISTANCE[]"]').val();
			var ML_GYPSUM_YN=$(measurementId).find('[name="ML_GYPSUM_YN[]"]').val();
			var ML_GYPSUM_WIDTH=$(measurementId).find('[name="ML_GYPSUM_WIDTH[]"]').val();
			var ML_GYPSUM_HEIGHT=$(measurementId).find('[name="ML_GYPSUM_HEIGHT[]"]').val();
			var ML_GYPSUM_DEPTH=$(measurementId).find('[name="ML_GYPSUM_DEPTH[]"]').val();
			
			var ML_ROOM_NO=$(measurementId).find('[name="roomValue[]"]').val();
			var ML_WINDOW_NO=$(measurementId).find('[name="windowValue[]"]').val();
			var ML_POWER_SIDE=$(measurementId).find('[name="ML_POWER_SIDE[]"]').val();
			var ML_SITE_READY_YN=$(measurementId).find('[name="ML_SITE_READY_YN[]"]').val();
			var ML_WINDOW_TYPE=$(measurementId).find('[name="MT_LEVEL_TYPE[]"]').val();
			var ML_DOME_HEIGHT=$(measurementId).find('[name="ML_DOME_HEIGHT[]"]').val();
			var ML_CORNER_DEGREE=$(measurementId).find('[name="ML_CORNER_DEGREE[]"]').val();
			var ML_CORVE_DEPTH=$(measurementId).find('[name="ML_CORVE_DEPTH[]"]').val();
			var ML_PARTITIONED_WINDOW_YN=$(measurementId).find('[name="ML_PARTITIONED_WINDOW_YN[]"]').val();
			var ML_NO_OF_PARTITION=$(measurementId).find('[name="ML_NO_OF_PARTITION[]"]').val();
			var partitionNewWidth1="";
			var partitionNewWidth2="";
			var partitionNewWidth3="";
			var partitionNewWidth4="";
			var partitionNewWidth5="";
			var partitionNewWidth6="";
			var partitionNewWidth7="";
			var partitionNewWidth8="";
			var partitionNewWidth9="";
			var partitionNewWidth10="";
			var count=0;
			$(measurementId).find('[name="partitionNewWidth[]"]').each(function(){
			count++;
				if(count==1){
				partitionNewWidth1=$(this).val();
				}
				if(count==2){
				partitionNewWidth2=$(this).val();
				}
				if(count==3){
				partitionNewWidth3=$(this).val();
				}
				if(count==4){
				partitionNewWidth4=$(this).val();
				}
				if(count==5){
				partitionNewWidth5=$(this).val();
				}
				if(count==6){
				partitionNewWidth6=$(this).val();
				}
				if(count==7){
				partitionNewWidth7=$(this).val();
				}
				if(count==8){
				partitionNewWidth8=$(this).val();
				}
				if(count==9){
				partitionNewWidth9=$(this).val();
				}
				if(count==10){
				partitionNewWidth10=$(this).val();
				}
			});
			var ML_PARTITION_01_WIDTH=partitionNewWidth1;
			var ML_PARTITION_02_WIDTH=partitionNewWidth2;
			var ML_PARTITION_03_WIDTH=partitionNewWidth3;
			var ML_PARTITION_04_WIDTH=partitionNewWidth4;
			var ML_PARTITION_05_WIDTH=partitionNewWidth5;
			var ML_PARTITION_06_WIDTH=partitionNewWidth6;
			var ML_PARTITION_07_WIDTH=partitionNewWidth7;
			var ML_PARTITION_08_WIDTH=partitionNewWidth8;
			var ML_PARTITION_09_WIDTH=partitionNewWidth9;
			var ML_PARTITION_10_WIDTH=partitionNewWidth10;
			var LANG_CODE="en";
			var USER_ID=localStorage.getItem("user_id");
			var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
			
			var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			db.transaction(function(tx){
				tx.executeSql('INSERT INTO LIVE_LOGI_T_MEASURE_LINES (ML_SYS_ID ,ML_MH_SYS_ID ,ML_COMP_CODE ,ML_LANG_CODE ,ML_TXN_DT ,ML_LOCN_CODE ,ML_LINE ,ML_BULD_TYPE ,ML_BUILD ,ML_FLOOR ,ML_FLAT ,ML_UNIT ,ML_WIDTH ,ML_HEIGHT ,ML_MOUNT_TYPE ,ML_MOUNT_ON ,ML_OPERATE ,ML_CONTROL ,ML_OPENING ,ML_PELMET ,ML_DESIGN_DEPTH ,ML_PROJECTION ,ML_FASICA ,ML_REMARKS ,ML_CLOSE_YN ,ML_OP_HEAD_SYS_ID ,ML_SC_LINE_SYS_ID ,ML_FULL_WIDTH ,ML_FULL_HEIGHT ,ML_LEFT_WALL ,ML_RIGHT_WALL ,ML_CEILING_UP ,ML_FLOOR_DOWN ,ML_WINDOW_DEPTH ,ML_WINDOW_OPENING ,ML_HANDLE_POSITION ,ML_HANDLE_SIZE ,ML_POWER_DISTANCE ,ML_GYPSUM_YN ,ML_GYPSUM_WIDTH ,ML_GYPSUM_HEIGHT ,ML_GYPSUM_DEPTH ,ML_ROOM_NO ,ML_WINDOW_NO ,ML_POWER_SIDE ,ML_SITE_READY_YN ,ML_WINDOW_TYPE ,ML_DOME_HEIGHT ,ML_CORNER_DEGREE ,ML_CORVE_DEPTH ,ML_PARTITIONED_WINDOW_YN ,ML_NO_OF_PARTITION ,ML_PARTITION_01_WIDTH ,ML_PARTITION_02_WIDTH ,ML_PARTITION_03_WIDTH ,ML_PARTITION_04_WIDTH ,ML_PARTITION_05_WIDTH ,ML_PARTITION_06_WIDTH ,ML_PARTITION_07_WIDTH ,ML_PARTITION_08_WIDTH ,ML_PARTITION_09_WIDTH ,ML_PARTITION_10_WIDTH ,LANG_CODE ,USER_ID,ML_MODE ) VALUES ("'+ML_SYS_ID +'","'+ ML_MH_SYS_ID +'","'+ ML_COMP_CODE +'","'+ ML_LANG_CODE +'","'+ ML_TXN_DT +'","'+ ML_LOCN_CODE +'","'+ ML_LINE +'","'+ ML_BULD_TYPE +'","'+ ML_BUILD +'","'+ ML_FLOOR +'","'+ ML_FLAT +'","'+ ML_UNIT +'","'+ ML_WIDTH +'","'+ ML_HEIGHT +'","'+ ML_MOUNT_TYPE +'","'+ ML_MOUNT_ON +'","'+ ML_OPERATE +'","'+ ML_CONTROL +'","'+ ML_OPENING +'","'+ ML_PELMET +'","'+ ML_DESIGN_DEPTH +'","'+ ML_PROJECTION +'","'+ ML_FASICA +'","'+ ML_REMARKS +'","'+ ML_CLOSE_YN +'","'+ ML_OP_HEAD_SYS_ID +'","'+ ML_SC_LINE_SYS_ID +'","'+ ML_FULL_WIDTH +'","'+ ML_FULL_HEIGHT +'","'+ ML_LEFT_WALL +'","'+ ML_RIGHT_WALL +'","'+ ML_CEILING_UP +'","'+ ML_FLOOR_DOWN +'","'+ ML_WINDOW_DEPTH +'","'+ ML_WINDOW_OPENING +'","'+ ML_HANDLE_POSITION +'","'+ ML_HANDLE_SIZE +'","'+ ML_POWER_DISTANCE +'","'+ ML_GYPSUM_YN +'","'+ ML_GYPSUM_WIDTH +'","'+ ML_GYPSUM_HEIGHT +'","'+ ML_GYPSUM_DEPTH +'","'+ ML_ROOM_NO +'","'+ ML_WINDOW_NO +'","'+ ML_POWER_SIDE +'","'+ ML_SITE_READY_YN +'","'+ ML_WINDOW_TYPE +'","'+ ML_DOME_HEIGHT +'","'+ ML_CORNER_DEGREE +'","'+ ML_CORVE_DEPTH +'","'+ ML_PARTITIONED_WINDOW_YN +'","'+ ML_NO_OF_PARTITION +'","'+ ML_PARTITION_01_WIDTH +'","'+ ML_PARTITION_02_WIDTH +'","'+ ML_PARTITION_03_WIDTH +'","'+ ML_PARTITION_04_WIDTH +'","'+ ML_PARTITION_05_WIDTH +'","'+ ML_PARTITION_06_WIDTH +'","'+ ML_PARTITION_07_WIDTH +'","'+ ML_PARTITION_08_WIDTH +'","'+ ML_PARTITION_09_WIDTH +'","'+ ML_PARTITION_10_WIDTH +'","'+ LANG_CODE +'","'+ USER_ID +'","'+mode+'")', successID);
				SelectLocalLineValuesInOffline();
				insertImagesInOffline(measurementId);
				BluePrintImageSaveInOffline();
			});
			function successID(){
			  return true;
			}
			/* BluePrintImage Save Method Start */
			function BluePrintImageSaveInOffline(){
				var imageId=measurementId+'_modal_data';
				var mode = $(measurementId).find('[name="mode[]"]').val();
				//alert("Bp mode"+mode);
				var BP_MI_SYS_ID = $(imageId).find('[name="BP_MI_SYS_ID[]"]').val();
				//alert("BP_MI_SYS_ID-"+BP_MI_SYS_ID)
				//alert("Bpmode->"+mode);
				var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
				var blobBin = atob(dataURL.split(',')[1]);
				var array   = [];
				for(var i = 0; i < blobBin.length; i++) {
					array.push(blobBin.charCodeAt(i));
				}
				var file=new Blob([new Uint8Array(array)], {type: 'image/png'});
				var sizeInMB = (file.size/1024).toFixed(2)+"KB";
				var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
				var ML_MH_SYS_ID=localStorage.getItem("HeadId");
				var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
				var USER_ID=localStorage.getItem("user_id");
				var NameImage = Math.floor((Math.random() * 10000000000) + 1)+".png";
				var imgSrc = "https://sedarspine.s3.amazonaws.com/LOGI/"+NameImage;
				var MI_DESC = "bluePrintImage";
				var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
				db.transaction(function(tx){
					tx.executeSql('SELECT * FROM LIVE_BluePrintImage ', [], function (tx, results1) {
						var treeHeadIdlength=results1.rows.length;
						//alert(treeHeadIdlength+"<----Blueprintlength")
						for (var i=0;i<treeHeadIdlength;i++){
							//prompt("Blueprint",JSON.stringify(results1.rows.item(i)));
						}
					});
					tx.executeSql('INSERT INTO LIVE_BluePrintImage (MI_SYS_ID,MI_ML_SYS_ID ,MI_ML_MH_SYS_ID ,MI_ML_IMAGE,MI_USER_ID,MI_LANG_CODE,MI_ML_COMP_CODE,MI_IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+BP_MI_SYS_ID+'","'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ dataURL +'","'+ MI_DESC +'","'+ sizeInMB +'","'+mode+'")', successID);
				});
				function successID(){
				  return true;
				}
			}
			
			/* BluePrintImage Save Method Ends */
			
			
			function SelectLocalLineValuesInOffline(){
			   var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			   db.transaction(Local_Measure_Line, errorCB);
			   function Local_Measure_Line(tx) {
				   tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_LINES ', [], function (tx, results) {
					   var LocalHeadline = results.rows.length;
					   localStorage.setItem("LocalHeadline", LocalHeadline);
					   for(var i=0;i<LocalHeadline;i++){
							//insertImages(results.rows.item(i).ML_SYS_ID);
							//alert("ML_SYS_ID==="+results.rows.item(i).ML_SYS_ID);
							//alert("ML_SYS_ID==="+results.rows.item(i).ML_MH_SYS_ID);
					   }
					   //alert("LocalHeadline Linelength-->"+LocalHeadline);
				   });
			   }
			   function errorCB(tx, err) {
				   //alert("Error");
				   //alert("Error processing SQL: "+err);
			   }
			}
			
			//images insert
			//FOR IMAGES
			function insertImagesInOffline(measurementId){
				var imageId=measurementId+'_modal_data';
				var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
				var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
				$(imageId).find('[name="imgProfile[]"]').each(function(){
					var desc=$(this).attr('data-desc');
					if(desc=='bluePrintImage'){
						var imgSrc=$(this).attr('data-src');
						//alert("Bp->"+imgSrc);
						var FileSize =$(this).attr('data-val');
						var mode =$(this).attr('data-mode');
						//alert("img mode-"+mode)
						if(mode=='add'){
							var FileSize = $(imageId).find('[name="size[]"]').attr('value');
						}
						
						var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
						var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						var MI_SYS_ID = $(imageId).find('[name="BP_MI_SYS_ID[]"]').val();
						var ML_MH_SYS_ID=localStorage.getItem("HeadId");
						var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
						var USER_ID=localStorage.getItem("user_id");
						var MI_DESC = "bluePrintImage";
						var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
						db.transaction(function(tx){
							tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_IMAGE ', [], function (tx, results1) {
								var treeHeadIdlength=results1.rows.length;
								//alert(treeHeadIdlength+"<----imagelength")
								for (var i=0;i<treeHeadIdlength;i++){
									//prompt("image",JSON.stringify(results1.rows.item(i)));
								}
							});
							tx.executeSql('INSERT INTO LIVE_LOGI_T_MEASURE_IMAGE (MI_SYS_ID,ML_SYS_ID ,ML_MH_SYS_ID ,ML_IMAGE,USER_ID,LANG_CODE,ML_COMP_CODE,IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+MI_SYS_ID+'","'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ path +'","'+ MI_DESC +'","'+ FileSize +'","'+mode+'")', successID);
							SelectLocalLineiMAGESInOffline();
						});
						function successID(){
						  return true;
						}
					}else{
						var imgSrc=$(this).attr('src');
						var FileSize =$(this).attr('data-val');
						var mode =$(this).attr('data-mode');
						//alert(mode)
						if(mode=='add'){
							var FileSize = $(imageId).find('[name="size[]"]').attr('value');
						}
						
						var imgType=$(this).attr('data-imgType');
						//alert("imgType-"+imgType);
						if(imgType=="Browse"){
							var img = $(this).attr('data-src');
							var FileName=img.substr(img.lastIndexOf('/') + 1);
							var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						}else{
							var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
							var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						}
						
						//var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
						//var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						var MI_SYS_ID = $(imageId).find('[name="MI_SYS_ID[]"]').val();
						var ML_MH_SYS_ID=localStorage.getItem("HeadId");
						var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
						var USER_ID=localStorage.getItem("user_id");
						var MI_DESC = "otherImage";
						var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
						db.transaction(function(tx){
							tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_IMAGE ', [], function (tx, results1) {
								var treeHeadIdlength=results1.rows.length;
								//alert(treeHeadIdlength+"<----imagelength")
								for (var i=0;i<treeHeadIdlength;i++){
									//prompt("image",JSON.stringify(results1.rows.item(i)));
								}
							});
							tx.executeSql('INSERT INTO LIVE_LOGI_T_MEASURE_IMAGE (MI_SYS_ID,ML_SYS_ID ,ML_MH_SYS_ID ,ML_IMAGE,USER_ID,LANG_CODE,ML_COMP_CODE,IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+MI_SYS_ID+'","'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ path +'","'+ MI_DESC +'","'+ FileSize +'","'+mode+'")', successID);
							SelectLocalLineiMAGESInOffline();
						});
						function successID(){
						  return true;
						}
					}
					
				});
			
			/*	var imageId=measurementId+'_modal_data';
				var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
				var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
				var MI_SYS_ID = $(imageId).find('[name="MI_SYS_ID[]"]').val();
				var imgs = "Test";
				if(imgs == ""){
				
				}else{
					$(imageId).find('[name="imgProfile[]"]').each(function(){
						var imgSrc=$(this).attr('src');
						var FileSize =$(this).attr('data-val');
						var mode =$(this).attr('data-mode');
						//alert(mode)
						if(mode=='add'){
							var FileSize = $(imageId).find('[name="size[]"]').attr('value');
						}
						var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
						var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						var ML_MH_SYS_ID=localStorage.getItem("HeadId");
						var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
						var USER_ID=localStorage.getItem("user_id");
						var MI_DESC = "otherImage";
						var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
						db.transaction(function(tx){
							tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_IMAGE ', [], function (tx, results1) {
								var treeHeadIdlength=results1.rows.length;
								//alert(treeHeadIdlength+"<----imagelength")
								for (var i=0;i<treeHeadIdlength;i++){
									//prompt("image",JSON.stringify(results1.rows.item(i)));
								}
							});
							tx.executeSql('INSERT INTO LIVE_LOGI_T_MEASURE_IMAGE (MI_SYS_ID,ML_SYS_ID ,ML_MH_SYS_ID ,ML_IMAGE,USER_ID,LANG_CODE,ML_COMP_CODE,IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+MI_SYS_ID+'","'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ path +'","'+ MI_DESC +'","'+ FileSize +'","'+mode+'")', successID);
							SelectLocalLineiMAGESInOffline();
						});
						function successID(){
						  return true;
						}
					});
					
				} */ 
				
				function SelectLocalLineiMAGESInOffline(){
					var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
					var LocalTestImgValue = [];
					db.transaction(SelectiMAGES, errorCB);
					function SelectiMAGES(tx){
					   tx.executeSql('SELECT * FROM LIVE_LOGI_T_MEASURE_IMAGE ', [], function (tx, results) {
							var LocalHeadlineImages = results.rows.length;
							for(var i=0;i<LocalHeadlineImages;i++){
								var row = results.rows.item(i);
								var LocalIdData = {ML_SYS_ID:row.ML_SYS_ID,LIVE_PATH:row.IMAGE_PATH,LOCAL_PATH:row.ML_IMAGE,MI_SIZE:row.MI_SIZE}
								LocalTestImgValue.push(LocalIdData);
							}
							/*
							var getMode = localStorage.getItem("SubmitMode"); 
							if(getMode=='proceed'){
								localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
								alert("Measurement Values Are Successfully Inserted");
								window.location="ScheduleTrackingDashboard_View.html";
							}else if(getMode=='wait'){
								localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
							}else{
								localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
								alert("Measurement Values Are Successfully Inserted");
								window.location="ScheduleTrackingDashboard_View.html";
							}*/
					   });	
					}
					function errorCB(tx, err) {
					   //alert("Error");
					   //alert("Error processing SQL: "+err);
					}
				}
			}
		}
<!-- Online Edit Mode Data Insert Fn End -->
	
	
		
		<!-- Get The Measure Edit Data End  -->
		
		
		<!-- Offline Edit Mode Data Insert Fn Start -->
		
		function insertNodesToDb($parentSysId,$inputElement,$mode,$levelType) {
			//alert("Tree");
			firstcount=parseInt(firstcount)+1;
			localStorage.setItem("WindowTypeLocal", $levelType);
		    var MT_MH_SYS_ID=localStorage.getItem("HeadId");
		    //alert("tree id->"+MT_MH_SYS_ID);
		    var MT_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
		    //var MT_SYS_ID=firstcount;
		    var MT_DESC=localStorage.getItem("fileldName");
		    var MT_LEVEL_ID=$inputElement.attr('data-level-id');
		    var MT_LEVEL_TYPE=localStorage.getItem("Data_level_id");
		    var MT_BUILD_TYPE=$('[name="ML_BULD_TYPE"]').val();
		    var LANG_CODE="en";
		    var USER_ID=localStorage.getItem("user_id");
		    var Local_SelectNodeToDb;
			var treeHeadId = localStorage.getItem("treeHeadId");
			
			var SYS_ID=$inputElement.attr('data-sys-id');
			if(SYS_ID==undefined){
				//var MT_SYS_ID=$inputElement.attr('data-sys-id');
				var id = localStorage.getItem("MeasureTreeID");
				//alert(id);
				var MT_SYS_ID=parseInt(id)+10;
				//alert(MT_SYS_ID);
				localStorage.setItem("MeasureTreeID",MT_SYS_ID);
			}else{
				var MT_SYS_ID=$inputElement.attr('data-sys-id');
				localStorage.setItem("MeasureTreeID",MT_SYS_ID);
			}
			
			//var MT_SYS_ID=$inputElement.attr('data-sys-id');
			var MT_PARENT_SYS_ID=$parentSysId;
			//alert("parent-"+MT_PARENT_SYS_ID);
			//var MT_LEVEL_ID=$inputElement.attr('data-level-id');
			var LEVEL_ID=$inputElement.attr('data-level-id');
			//alert(LEVEL_ID);
			if(LEVEL_ID==1){
				var MT_LEVEL_ID=1;
				//var MT_PARENT_SYS_ID=$parentSysId;
			}else if(LEVEL_ID==3){
				var MT_LEVEL_ID=3;
				//var MT_PARENT_SYS_ID=parseInt(MT_SYS_ID)-1;
			}else if(LEVEL_ID==4){
				var MT_LEVEL_ID=4;
				//var MT_PARENT_SYS_ID=parseInt(MT_SYS_ID)-1;
			}else if(LEVEL_ID==5){
				var MT_LEVEL_ID=5;
				//var MT_PARENT_SYS_ID=parseInt(MT_SYS_ID)-1;
			}else if(LEVEL_ID==6){
				var MT_LEVEL_ID=6;
				//var MT_PARENT_SYS_ID=parseInt(MT_SYS_ID)-1;
			}else{
				var MT_LEVEL_ID=2;
				//localStorage.setItem("TreeLevelparentId",$parentSysId);
				//var MT_PARENT_SYS_ID=parseInt(MT_SYS_ID)-1;
			}
			
			//alert("Tree->"+MT_MH_SYS_ID +"--"+ MT_COMP_CODE  +"--"+MT_SYS_ID  +"--"+MT_DESC  +"--"+MT_PARENT_SYS_ID  +"--"+MT_LEVEL_ID  +"--"+MT_LEVEL_TYPE  +"--"+MT_BUILD_TYPE  +"--"+LANG_CODE  +"--"+USER_ID);
			
		    var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			db.transaction(function(tx){
				tx.executeSql("INSERT INTO LOGI_T_MEASURE_TREE ('MT_MH_SYS_ID' ,'MT_COMP_CODE' ,'MT_SYS_ID' ,'MT_DESC' ,'MT_PARENT_SYS_ID' ,'MT_LEVEL_ID' ,'MT_LEVEL_TYPE' ,'MT_BUILD_TYPE' ,'LANG_CODE' ,'USER_ID','MT_MODE') VALUES (?,?,?,?,?,?,?,?,?,?,?)",[MT_MH_SYS_ID ,MT_COMP_CODE ,MT_SYS_ID ,MT_DESC ,MT_PARENT_SYS_ID ,MT_LEVEL_ID ,MT_LEVEL_TYPE ,MT_BUILD_TYPE ,LANG_CODE ,USER_ID,$mode],function(tx, results){
					Local_SelectNodeToDb = results.insertId;
				  });
				
			});
			return MT_SYS_ID;
		}
		var imageinertCount=1;
		function insertMeasurementLinesToDb(measurementId){		  
		   //alert("Lines");
		   //alert("measurementId->"+measurementId);
		   // var ML_SYS_ID=$(measurementId).find('[name="headSysIdLines[]"]').val();
		    var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
			var mode = $(measurementId).find('[name="mode[]"]').val();
			//alert("Line ML_SYS_ID->"+ML_SYS_ID);
			var ML_MH_SYS_ID=localStorage.getItem("HeadId");
			//alert(ML_MH_SYS_ID+"--"+ML_SYS_ID);
		    var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
		    var ML_LANG_CODE="en";
		    var currentDate = moment();
			//var ML_TXN_DT=$(measurementId).find('[name="MH_TXN_DT[]"]').val();
			var ML_TXN_DT=moment(currentDate).format('DD-MMM-YYYY');
		    var ML_LOCN_CODE=$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val();
			if(ML_LOCN_CODE==""){
				var ML_LOCN_CODE=localStorage.getItem("locationCode");
			}else{
				var ML_LOCN_CODE=$(measurementId).find('[name="LSL_LOCN_CODE[]"]').val();
				localStorage.setItem("locationCode",ML_LOCN_CODE);
			}
		    var ML_LINE=$(measurementId).find('[name="ML_Line_Value[]"]').val();
		    var ML_BULD_TYPE=$(measurementId).find('[name="buildingTypeValue[]"]').val();
		    var ML_BUILD=$(measurementId).find('[name="buildingValue[]"]').val();    	
		    var ML_FLOOR=$(measurementId).find('[name="floorValue[]"]').val();
		    var ML_FLAT=$(measurementId).find('[name="appartmentValue[]"]').val();
		    //var ML_UNIT=$(measurementId).find('[name="ML_UNIT[]"]').val();
			//alert("ML_UNIT->"+ML_UNIT);
			var ML_UNIT=$(measurementId).find('[name="roomTypeValue[]"]').val();
			//alert("ML_UNIT12->"+ML_UNIT);
		    var ML_WIDTH=$(measurementId).find('[name="ML_WIDTH[]"]').val();
		    var ML_HEIGHT=$(measurementId).find('[name="ML_HEIGHT[]"]').val();
		    var ML_MOUNT_TYPE=$(measurementId).find('[name="ML_MOUNT_TYPE[]"]').val();
		    var ML_MOUNT_ON=$(measurementId).find('[name="ML_MOUNT_ON[]"]').val();
		    var ML_OPERATE=$(measurementId).find('[name="ML_OPERATE[]"]').val();
		    var ML_CONTROL=$(measurementId).find('[name="ML_CONTROL[]"]').val();
		    var ML_OPENING=$(measurementId).find('[name="ML_OPENING[]"]').val();
		    var ML_PELMET=$(measurementId).find('[name="ML_PELMET[]"]').val();
			var ML_DESIGN_DEPTH=$(measurementId).find('[name="ML_DESIGN_DEPTH[]"]').val();
		    var ML_PROJECTION=$(measurementId).find('[name="ML_PROJECTION[]"]').val();
		    var ML_FASICA=$(measurementId).find('[name="ML_FASICA[]"]').val();
			//alert(ML_PELMET+"-"+ML_DESIGN_DEPTH+"-"+ML_PROJECTION+"-"+ML_FASICA);
		    var ML_REMARKS=$(measurementId).find('[name="ML_REMARKS[]"]').val();
		    var ML_CLOSE_YN="'N'";
		    var ML_OP_HEAD_SYS_ID=$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val();
		    var ML_SC_LINE_SYS_ID=$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val();
			if(ML_OP_HEAD_SYS_ID==""){
				var ML_OP_HEAD_SYS_ID = localStorage.getItem("ML_OP_headSysId");
			}else{
				var ML_OP_HEAD_SYS_ID=$(measurementId).find('[name="MH_SALE_REF_SYS_ID[]"]').val();
				localStorage.setItem("ML_OP_headSysId",ML_OP_HEAD_SYS_ID);
			}
			if(ML_SC_LINE_SYS_ID==""){
				var ML_SC_LINE_SYS_ID = localStorage.getItem("ML_OP_lineSysId");
			}else{
				var ML_SC_LINE_SYS_ID=$(measurementId).find('[name="LSL_REF_SYS_ID[]"]').val();
				localStorage.setItem("ML_OP_lineSysId",ML_SC_LINE_SYS_ID);
			}
		    var ML_FULL_WIDTH=$(measurementId).find('[name="ML_FULL_WIDTH[]"]').val();
		    var ML_FULL_HEIGHT=$(measurementId).find('[name="ML_FULL_HEIGHT[]"]').val();
		    var ML_LEFT_WALL=$(measurementId).find('[name="ML_LEFT_WALL[]"]').val();
		    var ML_RIGHT_WALL=$(measurementId).find('[name="ML_RIGHT_WALL[]"]').val();
		    var ML_CEILING_UP=$(measurementId).find('[name="ML_CEILING_UP[]"]').val();
		    var ML_FLOOR_DOWN=$(measurementId).find('[name="ML_FLOOR_DOWN[]"]').val();
		    var ML_WINDOW_DEPTH=$(measurementId).find('[name="ML_WINDOW_DEPTH[]"]').val();
		    var ML_WINDOW_OPENING=$(measurementId).find('[name="ML_WINDOW_OPENING[]"]').val();
		    var ML_HANDLE_POSITION=$(measurementId).find('[name="ML_HANDLE_POSITION[]"]').val();
		    var ML_HANDLE_SIZE=$(measurementId).find('[name="ML_HANDLE_SIZE[]"]').val();
		    var ML_POWER_DISTANCE=$(measurementId).find('[name="ML_POWER_DISTANCE[]"]').val();
		    var ML_GYPSUM_YN=$(measurementId).find('[name="ML_GYPSUM_YN[]"]').val();
			//alert(measurementId);
			//alert("ML_PELMET->"+ML_PELMET);
			//alert("GYPSUM->"+ML_GYPSUM_YN);
			var ML_GYPSUM_WIDTH=$(measurementId).find('[name="ML_GYPSUM_WIDTH[]"]').val();
		    var ML_GYPSUM_HEIGHT=$(measurementId).find('[name="ML_GYPSUM_HEIGHT[]"]').val();
		    var ML_GYPSUM_DEPTH=$(measurementId).find('[name="ML_GYPSUM_DEPTH[]"]').val();
		    
			var ML_ROOM_NO=$(measurementId).find('[name="roomValue[]"]').val();
			var ML_WINDOW_NO=$(measurementId).find('[name="windowValue[]"]').val();
			//alert(ML_ROOM_NO+""+ML_WINDOW_NO);
			//var ML_ROOM_NO=$('[name="ML_ROOM_NO[]"]').attr('data-level-id');
		    //var ML_WINDOW_NO=$('[name="ML_WINDOW_NO[]"]').attr('data-level-id');
		    var ML_POWER_SIDE=$(measurementId).find('[name="ML_POWER_SIDE[]"]').val();
		    var ML_SITE_READY_YN=$(measurementId).find('[name="ML_SITE_READY_YN[]"]').val();
		    var ML_WINDOW_TYPE=$(measurementId).find('[name="MT_LEVEL_TYPE[]"]').val();
		    var ML_DOME_HEIGHT=$(measurementId).find('[name="ML_DOME_HEIGHT[]"]').val();
		    var ML_CORNER_DEGREE=$(measurementId).find('[name="ML_CORNER_DEGREE[]"]').val();
		    var ML_CORVE_DEPTH=$(measurementId).find('[name="ML_CORVE_DEPTH[]"]').val();
		    var ML_PARTITIONED_WINDOW_YN=$(measurementId).find('[name="ML_PARTITIONED_WINDOW_YN[]"]').val();
		    var ML_NO_OF_PARTITION=$(measurementId).find('[name="ML_NO_OF_PARTITION[]"]').val();
		    var partitionNewWidth1="";
		    var partitionNewWidth2="";
		    var partitionNewWidth3="";
		    var partitionNewWidth4="";
		    var partitionNewWidth5="";
		    var partitionNewWidth6="";
		    var partitionNewWidth7="";
		    var partitionNewWidth8="";
		    var partitionNewWidth9="";
		    var partitionNewWidth10="";
		    var count=0;
		    $(measurementId).find('[name="partitionNewWidth[]"]').each(function(){
		    count++;
				if(count==1){
				partitionNewWidth1=$(this).val();
				}
				if(count==2){
				partitionNewWidth2=$(this).val();
				}
				if(count==3){
				partitionNewWidth3=$(this).val();
				}
				if(count==4){
				partitionNewWidth4=$(this).val();
				}
				if(count==5){
				partitionNewWidth5=$(this).val();
				}
				if(count==6){
				partitionNewWidth6=$(this).val();
				}
				if(count==7){
				partitionNewWidth7=$(this).val();
				}
				if(count==8){
				partitionNewWidth8=$(this).val();
				}
				if(count==9){
				partitionNewWidth9=$(this).val();
				}
				if(count==10){
				partitionNewWidth10=$(this).val();
				}
		    });
		    var ML_PARTITION_01_WIDTH=partitionNewWidth1;
		    var ML_PARTITION_02_WIDTH=partitionNewWidth2;
		    var ML_PARTITION_03_WIDTH=partitionNewWidth3;
		    var ML_PARTITION_04_WIDTH=partitionNewWidth4;
		    var ML_PARTITION_05_WIDTH=partitionNewWidth5;
		    var ML_PARTITION_06_WIDTH=partitionNewWidth6;
		    var ML_PARTITION_07_WIDTH=partitionNewWidth7;
		    var ML_PARTITION_08_WIDTH=partitionNewWidth8;
		    var ML_PARTITION_09_WIDTH=partitionNewWidth9;
		    var ML_PARTITION_10_WIDTH=partitionNewWidth10;
		    var LANG_CODE="en";
		    var USER_ID=localStorage.getItem("user_id");
			//var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
			
			//alert("Line->"+'"'+ML_SYS_ID +'","'+ ML_MH_SYS_ID +'","'+ ML_COMP_CODE +'","'+ ML_LANG_CODE +'","'+ ML_TXN_DT +'","'+ ML_LOCN_CODE +'","'+ ML_LINE +'","'+ ML_BULD_TYPE +'","'+ ML_BUILD +'","'+ ML_FLOOR +'","'+ ML_FLAT +'","'+ ML_UNIT +'","'+ ML_WIDTH +'","'+ ML_HEIGHT +'","'+ ML_MOUNT_TYPE +'","'+ ML_MOUNT_ON +'","'+ ML_OPERATE +'","'+ ML_CONTROL +'","'+ ML_OPENING +'","'+ ML_PELMET +'","'+ ML_DESIGN_DEPTH +'","'+ ML_PROJECTION +'","'+ ML_FASICA +'","'+ ML_REMARKS +'","'+ ML_CLOSE_YN +'","'+ ML_OP_HEAD_SYS_ID +'","'+ ML_SC_LINE_SYS_ID +'","'+ ML_FULL_WIDTH +'","'+ ML_FULL_HEIGHT +'","'+ ML_LEFT_WALL +'","'+ ML_RIGHT_WALL +'","'+ ML_CEILING_UP +'","'+ ML_FLOOR_DOWN +'","'+ ML_WINDOW_DEPTH +'","'+ ML_WINDOW_OPENING +'","'+ ML_HANDLE_POSITION +'","'+ ML_HANDLE_SIZE +'","'+ ML_POWER_DISTANCE +'","'+ ML_GYPSUM_YN +'","'+ ML_GYPSUM_WIDTH +'","'+ ML_GYPSUM_HEIGHT +'","'+ ML_GYPSUM_DEPTH +'","'+ ML_ROOM_NO +'","'+ ML_WINDOW_NO +'","'+ ML_POWER_SIDE +'","'+ ML_SITE_READY_YN +'","'+ ML_WINDOW_TYPE +'","'+ ML_DOME_HEIGHT +'","'+ ML_CORNER_DEGREE +'","'+ ML_CORVE_DEPTH +'","'+ ML_PARTITIONED_WINDOW_YN +'","'+ ML_NO_OF_PARTITION +'","'+ ML_PARTITION_01_WIDTH +'","'+ ML_PARTITION_02_WIDTH +'","'+ ML_PARTITION_03_WIDTH +'","'+ ML_PARTITION_04_WIDTH +'","'+ ML_PARTITION_05_WIDTH +'","'+ ML_PARTITION_06_WIDTH +'","'+ ML_PARTITION_07_WIDTH +'","'+ ML_PARTITION_08_WIDTH +'","'+ ML_PARTITION_09_WIDTH +'","'+ ML_PARTITION_10_WIDTH +'","'+ LANG_CODE +'","'+ USER_ID +'"');
			
			/* spine live start */
			var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
			//alert("line->"+dataURL);
			//var test = prompt("Line Data",dataURL);
			var blobBin = atob(dataURL.split(',')[1]);
			var array   = [];
			for(var i = 0; i < blobBin.length; i++) {
			    array.push(blobBin.charCodeAt(i));
			}
			var file=new Blob([new Uint8Array(array)], {type: 'image/png'});
			var sizeInMB = (file.size/1024).toFixed(2)+"KB";
			
			var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			
			db.transaction(function(tx){
			  //alert("Line insert");
			 
			 
			tx.executeSql('SELECT * FROM LOGI_T_MEASURE_LINES WHERE ML_MH_SYS_ID=? ', [ML_MH_SYS_ID], function (tx, results1) {
				var treeHeadIdlength=results1.rows.length;
				//alert(treeHeadIdlength+"<----Linelength")
				for (var i=0;i<treeHeadIdlength;i++){
					//prompt("Line",JSON.stringify(results1.rows.item(i)));
				}
			});
			 
			 
			  tx.executeSql('INSERT INTO LOGI_T_MEASURE_LINES (ML_SYS_ID ,ML_MH_SYS_ID ,ML_COMP_CODE ,ML_LANG_CODE ,ML_TXN_DT ,ML_LOCN_CODE ,ML_LINE ,ML_BULD_TYPE ,ML_BUILD ,ML_FLOOR ,ML_FLAT ,ML_UNIT ,ML_WIDTH ,ML_HEIGHT ,ML_MOUNT_TYPE ,ML_MOUNT_ON ,ML_OPERATE ,ML_CONTROL ,ML_OPENING ,ML_PELMET ,ML_DESIGN_DEPTH ,ML_PROJECTION ,ML_FASICA ,ML_REMARKS ,ML_CLOSE_YN ,ML_OP_HEAD_SYS_ID ,ML_SC_LINE_SYS_ID ,ML_FULL_WIDTH ,ML_FULL_HEIGHT ,ML_LEFT_WALL ,ML_RIGHT_WALL ,ML_CEILING_UP ,ML_FLOOR_DOWN ,ML_WINDOW_DEPTH ,ML_WINDOW_OPENING ,ML_HANDLE_POSITION ,ML_HANDLE_SIZE ,ML_POWER_DISTANCE ,ML_GYPSUM_YN ,ML_GYPSUM_WIDTH ,ML_GYPSUM_HEIGHT ,ML_GYPSUM_DEPTH ,ML_ROOM_NO ,ML_WINDOW_NO ,ML_POWER_SIDE ,ML_SITE_READY_YN ,ML_WINDOW_TYPE ,ML_DOME_HEIGHT ,ML_CORNER_DEGREE ,ML_CORVE_DEPTH ,ML_PARTITIONED_WINDOW_YN ,ML_NO_OF_PARTITION ,ML_PARTITION_01_WIDTH ,ML_PARTITION_02_WIDTH ,ML_PARTITION_03_WIDTH ,ML_PARTITION_04_WIDTH ,ML_PARTITION_05_WIDTH ,ML_PARTITION_06_WIDTH ,ML_PARTITION_07_WIDTH ,ML_PARTITION_08_WIDTH ,ML_PARTITION_09_WIDTH ,ML_PARTITION_10_WIDTH ,LANG_CODE ,USER_ID, ML_MODE) VALUES ("'+ML_SYS_ID +'","'+ ML_MH_SYS_ID +'","'+ ML_COMP_CODE +'","'+ ML_LANG_CODE +'","'+ ML_TXN_DT +'","'+ ML_LOCN_CODE +'","'+ ML_LINE +'","'+ ML_BULD_TYPE +'","'+ ML_BUILD +'","'+ ML_FLOOR +'","'+ ML_FLAT +'","'+ ML_UNIT +'","'+ ML_WIDTH +'","'+ ML_HEIGHT +'","'+ ML_MOUNT_TYPE +'","'+ ML_MOUNT_ON +'","'+ ML_OPERATE +'","'+ ML_CONTROL +'","'+ ML_OPENING +'","'+ ML_PELMET +'","'+ ML_DESIGN_DEPTH +'","'+ ML_PROJECTION +'","'+ ML_FASICA +'","'+ ML_REMARKS +'","'+ ML_CLOSE_YN +'","'+ ML_OP_HEAD_SYS_ID +'","'+ ML_SC_LINE_SYS_ID +'","'+ ML_FULL_WIDTH +'","'+ ML_FULL_HEIGHT +'","'+ ML_LEFT_WALL +'","'+ ML_RIGHT_WALL +'","'+ ML_CEILING_UP +'","'+ ML_FLOOR_DOWN +'","'+ ML_WINDOW_DEPTH +'","'+ ML_WINDOW_OPENING +'","'+ ML_HANDLE_POSITION +'","'+ ML_HANDLE_SIZE +'","'+ ML_POWER_DISTANCE +'","'+ ML_GYPSUM_YN +'","'+ ML_GYPSUM_WIDTH +'","'+ ML_GYPSUM_HEIGHT +'","'+ ML_GYPSUM_DEPTH +'","'+ ML_ROOM_NO +'","'+ ML_WINDOW_NO +'","'+ ML_POWER_SIDE +'","'+ ML_SITE_READY_YN +'","'+ ML_WINDOW_TYPE +'","'+ ML_DOME_HEIGHT +'","'+ ML_CORNER_DEGREE +'","'+ ML_CORVE_DEPTH +'","'+ ML_PARTITIONED_WINDOW_YN +'","'+ ML_NO_OF_PARTITION +'","'+ ML_PARTITION_01_WIDTH +'","'+ ML_PARTITION_02_WIDTH +'","'+ ML_PARTITION_03_WIDTH +'","'+ ML_PARTITION_04_WIDTH +'","'+ ML_PARTITION_05_WIDTH +'","'+ ML_PARTITION_06_WIDTH +'","'+ ML_PARTITION_07_WIDTH +'","'+ ML_PARTITION_08_WIDTH +'","'+ ML_PARTITION_09_WIDTH +'","'+ ML_PARTITION_10_WIDTH +'","'+ LANG_CODE +'","'+ USER_ID +'","'+mode+'")', successID);
			  SelectLocalLineValues();
			  //BluePrintImageSave(); 
			  //insertImages();
				insertImages(measurementId);
				BluePrintImageSave();
			});
			function successID(){
			  return true;
			}
			/* BluePrintImage Save Method Start */
			function BluePrintImageSave(){
				//alert("BP->"+measurementId);
				//var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
				var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
				var mode = $(measurementId).find('[name="mode[]"]').val();
				//alert("dataURL->"+dataURL);
				var blobBin = atob(dataURL.split(',')[1]);
				var array   = [];
				for(var i = 0; i < blobBin.length; i++) {
					array.push(blobBin.charCodeAt(i));
				}
				var file=new Blob([new Uint8Array(array)], {type: 'image/png'});
				var sizeInMB = (file.size/1024).toFixed(2)+"KB";
				//alert("sizeInMB->"+sizeInMB);
				var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
				var ML_MH_SYS_ID=localStorage.getItem("HeadId");
				var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
				var USER_ID=localStorage.getItem("user_id");
				//alert(ML_SYS_ID+"=="+dataURL);
				//var date = new Date();
				//var NameImage = Math.floor(date.getTime()/1000)+".png";
				var NameImage = Math.floor((Math.random() * 10000000000) + 1)+".png";
				var imgSrc = "https://sedarspine.s3.amazonaws.com/LOGI/"+NameImage;
				var MI_DESC = "bluePrintImage";
				//alert("Bp->"+ML_SYS_ID+"-"+USER_ID+"-"+ML_MH_SYS_ID+"-"+ML_COMP_CODE+"-"+MI_DESC+"-"+imgSrc);
				//alert("imgSrc->"+imgSrc);
				var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
				db.transaction(function(tx){
				
					tx.executeSql('SELECT * FROM BluePrintImage ', [], function (tx, results1) {
						var treeHeadIdlength=results1.rows.length;
						//alert(treeHeadIdlength+"<----Blueprintlength")
						for (var i=0;i<treeHeadIdlength;i++){
							//prompt("Blueprint",JSON.stringify(results1.rows.item(i)));
						}
					});
					
					tx.executeSql('INSERT INTO BluePrintImage (MI_ML_SYS_ID ,MI_ML_MH_SYS_ID ,MI_ML_IMAGE,MI_USER_ID,MI_LANG_CODE,MI_ML_COMP_CODE,MI_IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ dataURL +'","'+ MI_DESC +'","'+ sizeInMB +'","'+mode+'")', successID);
				});
				function successID(){
				  return true;
				}
			}
			
			/* BluePrintImage Save Method Ends */
			
			function SelectLocalLineValues(){
			   var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			   db.transaction(Local_Measure_Line, errorCB);
			   function Local_Measure_Line(tx) {
				   tx.executeSql('SELECT * FROM LOGI_T_MEASURE_LINES ', [], function (tx, results) {
					   var LocalHeadline = results.rows.length;
					   //alert("linelength"+LocalHeadline);
					   localStorage.setItem("LocalHeadline", LocalHeadline);
					   for(var i=0;i<LocalHeadline;i++){
							//insertImages(results.rows.item(i).ML_SYS_ID);
							//alert("ML_SYS_ID==="+results.rows.item(i).ML_SYS_ID);
							//alert("ML_SYS_ID==="+results.rows.item(i).ML_MH_SYS_ID);
					   }
					   //alert("LocalHeadline Linelength-->"+LocalHeadline);
				   });
			   }
			   function errorCB(tx, err) {
				   //alert("Error");
				   //alert("Error processing SQL: "+err);
			   }
			}
					   
					   //images insert
					   //FOR IMAGES
			function insertImages(measurementId){
				var imageId=measurementId+"_modal_data";
				//alert("imageId->"+imageId);
				var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
				//alert("dataURL->"+dataURL);
				var ML_SYS_ID = $(measurementId).find('[name="LINE_SYS_ID[]"]').val();
				$(imageId).find('[name="imgProfile[]"]').each(function(){
					var desc=$(this).attr('data-desc');
					//alert(desc);
					if(desc=='bluePrintImage'){
						var imgSrc=$(this).attr('data-src');
						//alert("Bp->"+imgSrc);
						var FileSize =$(this).attr('data-val');
						//alert("BP-"+FileSize);
						var mode =$(this).attr('data-mode');
						//alert("img mode-"+mode)
						/*if(mode=='add'){
							var FileSize = $(imageId).find('[name="size[]"]').attr('value');
						}*/
						var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
						var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						//var MI_SYS_ID = $(imageId).find('[name="BP_MI_SYS_ID[]"]').val();
						var ML_MH_SYS_ID=localStorage.getItem("HeadId");
						var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
						var USER_ID=localStorage.getItem("user_id");
						var MI_DESC = "bluePrintImage";
						var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
						db.transaction(function(tx){
							//tx.executeSql("CREATE TABLE IF NOT EXISTS LOGI_T_MEASURE_IMAGE (ID INTEGER PRIMARY KEY AUTOINCREMENT,ML_SYS_ID INTEGER,ML_MH_SYS_ID INTEGER,ML_IMAGE TEXT,USER_ID TEXT, LANG_CODE TEXT, ML_COMP_CODE TEXT,IMAGE_PATH TEXT,MI_DESC TEXT,MI_SIZE TEXT,MI_MODE TEXT)",[]);
							//tx.executeSql('INSERT INTO LOGI_T_MEASURE_IMAGE (ML_SYS_ID ,ML_MH_SYS_ID ,ML_IMAGE,USER_ID,LANG_CODE,ML_COMP_CODE,IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ path +'","'+ MI_DESC +'","'+ FileSize +'","'+mode+'")', successID);
						});
						function successID(){
						  return true;
						}
					}else{
						var imgSrc=$(this).attr('src');
						//alert("Bp->"+imgSrc);
						var FileSize =$(this).attr('data-val');
						//alert("img-"+FileSize);
						var mode =$(this).attr('data-mode');
						//alert("img mode-"+mode)
						if(mode=='add'){
							var FileSize = $(imageId).find('[name="size[]"]').attr('value');
							//alert("add img-"+FileSize);
						}
						
						var imgType=$(this).attr('data-imgType');
						//alert("imgType-"+imgType);
						if(imgType=="Browse"){
							var img = $(this).attr('data-src');
							var FileName=img.substr(img.lastIndexOf('/') + 1);
							var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						}else{
							var FileName=imgSrc.substr(imgSrc.lastIndexOf('/') + 1);
							var path="https://sedarspine.s3.amazonaws.com/LOGI/"+FileName;
						}
						
						//var MI_SYS_ID = $(imageId).find('[name="BP_MI_SYS_ID[]"]').val();
						var ML_MH_SYS_ID=localStorage.getItem("HeadId");
						var ML_COMP_CODE=localStorage.getItem("USER_COMP_CODE");
						var USER_ID=localStorage.getItem("user_id");
						var MI_DESC = "otherImage";
						var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
						db.transaction(function(tx){
							tx.executeSql("CREATE TABLE IF NOT EXISTS LOGI_T_MEASURE_IMAGE (ID INTEGER PRIMARY KEY AUTOINCREMENT,ML_SYS_ID INTEGER,ML_MH_SYS_ID INTEGER,ML_IMAGE TEXT,USER_ID TEXT, LANG_CODE TEXT, ML_COMP_CODE TEXT,IMAGE_PATH TEXT,MI_DESC TEXT,MI_SIZE TEXT,MI_MODE TEXT)",[]);
							tx.executeSql('INSERT INTO LOGI_T_MEASURE_IMAGE (ML_SYS_ID ,ML_MH_SYS_ID ,ML_IMAGE,USER_ID,LANG_CODE,ML_COMP_CODE,IMAGE_PATH,MI_DESC,MI_SIZE,MI_MODE) VALUES ("'+ML_SYS_ID+'","'+ ML_MH_SYS_ID +'","'+ imgSrc +'","'+ USER_ID +'","en","'+ ML_COMP_CODE +'","'+ path +'","'+ MI_DESC +'","'+ FileSize +'","'+mode+'")', successID);
						});
						function successID(){
						  return true;
						}
					}
				}); 
				
				function SelectLocalLineiMAGES(){
					var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
					var LocalTestImgValue = [];
					db.transaction(SelectiMAGES, errorCB);
					function SelectiMAGES(tx) {
					   tx.executeSql('SELECT * FROM LOGI_T_MEASURE_IMAGE ', [], function (tx, results) {
							var LocalHeadlineImages = results.rows.length;
						    //alert(JSON.stringify(results.rows));
						    //alert("LocalHeadlineImages"+LocalHeadlineImages);
							for(var i=0;i<LocalHeadlineImages;i++){
								//alert("img ML_SYS_ID==="+results.rows.item(i).ML_SYS_ID);
								var row = results.rows.item(i);
								var LocalIdData = {ML_SYS_ID:row.ML_SYS_ID,LIVE_PATH:row.IMAGE_PATH,LOCAL_PATH:row.ML_IMAGE,MI_SIZE:row.MI_SIZE}
								LocalTestImgValue.push(LocalIdData);
								//alert("img ML_MH_SYS_ID==="+results.rows.item(i).ML_MH_SYS_ID);
								//alert("Local ID"+JSON.stringify(LocalTestImgValue));
							}
							
							/*
							var getMode = localStorage.getItem("SubmitMode"); 
							//alert("getMode->"+getMode);
							if(getMode=='proceed'){
								localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
								alert("Measurement Values Are Successfully Inserted");
								//window.location="index.html";
								window.location="ScheduleTrackingDashboard_View.html";
							}else if(getMode=='wait'){
								localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
								//alert("Measurement Values Are Successfully Updated");
								//window.location="index.html";
								//window.location="ScheduleTrackingDashboard_View.html";
							}else{
								localStorage.setItem("LocalHeadlineImages", LocalHeadlineImages);
								alert("Measurement Values Are Successfully Inserted");
								//window.location="index.html";
								window.location="ScheduleTrackingDashboard_View.html";
							}*/
					   });	
					}
					function errorCB(tx, err) {
					   //alert("Error");
					   //alert("Error processing SQL: "+err);
					}
				}
			}
		}
		
		
		<!-- Offline Edit Mode Data Insert Fn End -->
		
		
		/* Measurement Head Insert Start */

		function insertMeasurementHeadToDb(){
			//alert("Head insert");
			var measureId = localStorage.getItem("mesurementTransaction_id");
			var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
			db.transaction(New_Measure_Head, errorCB);
			function New_Measure_Head(tx) {
				tx.executeSql('SELECT * FROM Live_Measure_Head where MH_REF_SYS_ID=? ', [measureId], function (tx, results) {
					var Headlength = results.rows.length;
					if(Headlength==0){
						/* New Measure Head Insert start*/
						//alert("New Data");
						var resultSysId=localStorage.getItem("HeadId");
						var resultSysLineId=localStorage.getItem("LineId");
						localStorage.setItem("HeadDataInsert", "New");
						//alert(resultSysId+"-Head-"+resultSysLineId);
						var MH_TXN_CODE			="MS";         
						var MH_TXN_DT			=$('#defaultdate1').val();         	
						var MH_DOC_REF			=$('#LSH_DOC_REF').val();         	
						var MH_LOCN_CODE		=$('#LSL_LOCN_CODE').val();        
						var MH_SR_CODE			=$('#LSL_SR_CODE').val(); 
						//alert("MH_SR_CODE"+MH_SR_CODE);
						var MH_REF_SYS_ID		=$('#LSL_REF_SYS_ID').val();       
						var MH_REF_TXN_CODE		=$('#LSH_TXN_CODE').val();
						var MH_REF_TXN_NO		=$('#LSH_TXN_NO').val();
						var MH_REF_TXN_DT		=$('#LSH_TXN_DT').val();  
						//alert(MH_REF_TXN_CODE+"-"+MH_REF_TXN_NO+"-"+MH_REF_TXN_DT);
						var MH_SALE_REF_SYS_ID		=$('#MH_SALE_REF_SYS_ID').val();  
						var MH_SALE_REF_TXN_CODE	=$('#MH_SALE_REF_TXN_CODE').val();
						var MH_SALE_REF_TXN_NO		=$('#MH_SALE_REF_TXN_NO').val(); 	
						var MH_SALE_REF_TXN_DT		=$('#P_MH_SALE_REF_TXN_DT').val();
						var MH_CONTACT_NO		=$('#LSL_CONTACT_NO').val();       
						var MH_CONTACT_PERSON		=$('#MH_CONTACT_PERSON').val();   
						var MH_CUST_TYPE		="N";        
						var MH_CUST_AC_CODE		=$('#LSL_CUST_AC_CODE').val();     
						var MH_CUST_AC_DESC		=$('#MH_CUST_AC_DESC').val();     
						var MH_ADD1			=$('#MH_ADD1').val();         	
						var MH_ADD2			=$('#LSL_ADD2').val();         	
						var MH_ADD3			=$('#LSL_ADD3').val();        	
						var MH_ADD4			=$('#LSL_ADD4').val();    		
						var MH_CN_CODE			=$('#LSL_CN_CODE').val();		
						var MH_ST_CODE			=$('#LSL_ST_CODE').val();  
						var MH_CT_CODE			=$('#MH_CT_CODE').val();   	
						var MH_CT_AR_CODE		=$('#LSL_CT_AREA_CODE').val();
						var MH_POSTAL			=$('#LSL_POSTAL').val(); 		
						var MH_MOBILE			=$('#LSL_MOBILE').val();  		
						var MH_PHONE			=$('#LSL_PHONE').val(); 		
						var MH_FAX			=$('#LSL_FAX').val(); 	        
						var MH_EMAIL			=$('#LSL_EMAIL').val(); 		
						var MH_DESC		      	=$('#LSL_DESC').val(); 		
						var MH_STATUS			="Incomplete";  		
						var MH_APPOINT_DT		=$('#defaultdate2').val(); 	
						//alert(MH_APPOINT_DT);
						var LANG_CODE			="en";
						var USER_ID			=localStorage.getItem("user_id");
						var SYS_ID			=localStorage.getItem("HeadId");
						var TXN_NO			="54321";
						var MH_COMP_CODE	=localStorage.getItem("USER_COMP_CODE");
						
						//alert("Head->"+MH_TXN_CODE+"-"+MH_TXN_DT+"-"+MH_DOC_REF+"-"+MH_LOCN_CODE+"-"+MH_SR_CODE+"-"+MH_REF_SYS_ID+"-"+MH_REF_TXN_CODE+"-"+MH_REF_TXN_NO+"-"+MH_REF_TXN_DT+"-"+MH_SALE_REF_SYS_ID+"-"+MH_SALE_REF_TXN_CODE+"-"+MH_SALE_REF_TXN_NO+"-"+MH_SALE_REF_TXN_DT+"-"+MH_CONTACT_NO+"-"+MH_CONTACT_PERSON+"-"+MH_CUST_TYPE+"-"+MH_CUST_AC_CODE+"-"+MH_CUST_AC_DESC+"-"+MH_ADD1+"-"+MH_ADD2+"-"+MH_ADD3+"-"+MH_ADD4+"-"+MH_CN_CODE+"-"+MH_ST_CODE+"-"+MH_CT_CODE+"-"+MH_CT_AR_CODE+"-"+MH_POSTAL+"-"+MH_MOBILE+"-"+MH_PHONE+"-"+MH_FAX+"-"+MH_EMAIL+"-"+MH_DESC+"-"+MH_STATUS+"-"+MH_APPOINT_DT+"-"+LANG_CODE+"-"+USER_ID+"-"+SYS_ID+"-"+TXN_NO+"-"+MH_COMP_CODE);
						
						var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
						db.transaction(function(tx){
							
							//tx.executeSql('INSERT OR REPLACE INTO LOGI_T_MEASURE_HEAD (MH_TXN_CODE ,MH_TXN_DT ,MH_DOC_REF ,MH_LOCN_CODE ,MH_SR_CODE ,MH_REF_SYS_ID ,MH_REF_TXN_CODE ,MH_REF_TXN_NO ,MH_REF_TXN_DT ,MH_SALE_REF_SYS_ID ,MH_SALE_REF_TXN_CODE ,MH_SALE_REF_TXN_NO ,MH_SALE_REF_TXN_DT ,MH_CONTACT_NO ,MH_CONTACT_PERSON ,MH_CUST_TYPE ,MH_CUST_AC_CODE ,MH_CUST_AC_DESC ,MH_ADD1 ,MH_ADD2 ,MH_ADD3 ,MH_ADD4 ,MH_CN_CODE ,MH_ST_CODE ,MH_CT_CODE ,MH_CT_AR_CODE ,MH_POSTAL ,MH_MOBILE ,MH_PHONE ,MH_FAX ,MH_EMAIL ,MH_DESC ,MH_STATUS ,MH_APPOINT_DT ,LANG_CODE ,USER_ID ,SYS_ID ,TXN_NO ,MH_COMP_CODE) VALUES ("'+MH_TXN_CODE +'","'+MH_TXN_DT +'","'+MH_DOC_REF +'","'+MH_LOCN_CODE +'","'+MH_SR_CODE +'","'+MH_REF_SYS_ID +'","'+MH_REF_TXN_CODE +'","'+MH_REF_TXN_NO +'","'+MH_REF_TXN_DT +'","'+MH_SALE_REF_SYS_ID +'","'+MH_SALE_REF_TXN_CODE +'","'+MH_SALE_REF_TXN_NO +'","'+MH_SALE_REF_TXN_DT +'","'+MH_CONTACT_NO +'","'+MH_CONTACT_PERSON +'","'+MH_CUST_TYPE +'","'+MH_CUST_AC_CODE +'","'+MH_CUST_AC_DESC +'","'+MH_ADD1 +'","'+MH_ADD2 +'","'+MH_ADD3 +'","'+MH_ADD4 +'","'+MH_CN_CODE +'","'+MH_ST_CODE +'","'+MH_CT_CODE +'","'+MH_CT_AR_CODE +'","'+MH_POSTAL +'","'+MH_MOBILE +'","'+MH_PHONE +'","'+MH_FAX +'","'+MH_EMAIL +'","'+MH_DESC +'","'+MH_STATUS +'","'+MH_APPOINT_DT +'","'+LANG_CODE +'","'+USER_ID +'","'+SYS_ID +'","'+TXN_NO +'","'+MH_COMP_CODE+'")', successID);
							SelectLocalHeadValues();
						});
						function successID(){
							return true;
						}
						function SelectLocalHeadValues(){
							var db = window.openDatabase("Spine", "1.0", "Spine Demo", 100 * 1024 * 1024);
							  db.transaction(Local_Measure_Head, errorCB);
							  function Local_Measure_Head(tx) {
								  tx.executeSql('SELECT * FROM LOGI_T_MEASURE_HEAD ', [], function (tx, results) {
									  var LocalHeadlength = results.rows.length;
									  //alert("Head Data length->"+LocalHeadlength);
									  //alert("Head Data"+JSON.stringify(results.rows.item(0)));
									  //alert("ID"+ results.rows.item(0).MH_REF_SYS_ID);
									  localStorage.setItem("LocalHeadlengthCheckData", LocalHeadlength);
									  localStorage.setItem("LocalHeadlength", LocalHeadlength);
								  });
							  }
							  function errorCB(tx, err) {
								  //alert("Error");
								  //alert("Error processing SQL: "+err);
							  }
						}

						/* New Measure Head Insert end */
					}else{
						//alert("Head Already Inserted");
						var SysId = results.rows.item(0).MH_SYS_ID;
						//alert("All Ready->"+SysId);
						//$('[name="headSysId"]').val(SysId);
						var LineSysId = SysId+1;
						//alert(LineSysId);
						//$('[name="headSysIdLines[]"]').val(LineSysId);
						localStorage.setItem("HeadId", SysId);
						localStorage.setItem("LineId", LineSysId);
						localStorage.setItem("HeadDataInsert", "Exist");
					}
					
				});
			}
			function errorCB(tx, err) {
			 	//alert("Error");
			 	//alert("Error processing SQL: "+err);
			}
		}

		/* Measurement Head Insert End */


		function deleteMeasurementLinesInDb($id){
			//alert("Delete Line");
			//alert($id);
			var USER_ID = localStorage.getItem("user_id");
			var USER_COMP_CODE = localStorage.getItem("USER_COMP_CODE");
			$.ajax({
				type:"POST",
				url:"http://test.sedarspine.com/en/spineLogisticsApp/OnlineMeasurementLine_Delete",
				data:{ML_SYS_ID:$id,USER_ID:USER_ID,USER_COMP_CODE:USER_COMP_CODE},
				dataType:"json",
				async:false,
				success: function ()
				{
					return true;			    
				}
			});
		}
		function deleteMeasurementTreeInDb($id){
			//alert($id);
			var USER_ID = localStorage.getItem("user_id");
			var USER_COMP_CODE = localStorage.getItem("USER_COMP_CODE");
			$.ajax({
				type:"POST",
				url:"http://test.sedarspine.com/en/spineLogisticsApp/OnlineMeasurementTree_Delete",
				data:{MT_SYS_ID:$id,USER_ID:USER_ID,USER_COMP_CODE:USER_COMP_CODE},
				dataType:"json",
				async:false,
				success: function ()
				{
					return true;			    
				}
			});
		
		}
	      </script> 
	 
		<script>
		
		function previewChanges($this, paramType)
		{
		    $parentClosest = $this.parents('.active_measurement');
		    var canvas = $parentClosest.find('#myCanvas')[0];
		    var touchedTimes=parseInt($parentClosest.find('#myCanvas').attr('data-touched-times'));
		    $parentClosest.find('#myCanvas').attr('data-touched-times',++touchedTimes);
		    var context = canvas.getContext('2d');
		    context.clearRect(0, 0, canvas.width, canvas.height);
		    context.fillStyle = "#FFFFFF";
		    context.fillRect(0,0,canvas.width,canvas.height);//canvas
		    var wallWidth= $parentClosest.find('[name="ML_FULL_WIDTH[]"]').val().replace(/,/g,'');
		    var wallHeight=$parentClosest.find('[name="ML_FULL_HEIGHT[]"]').val().replace(/,/g,'');
		    var windowWidth=$this.parents('.windowTab').find('[name="ML_WIDTH[]"]').val().replace(/,/g,'');
		    var windowHeight=$this.parents('.windowTab').find('[name="ML_HEIGHT[]"]').val().replace(/,/g,'');
		    var depth=$this.parents('.windowTab').find('[name="ML_WINDOW_DEPTH[]"]').val().replace(/,/g,'');
		    var wallToLeft = $this.parents('.windowTab').find('[name="ML_LEFT_WALL[]"]').val().replace(/,/g,'');
		    var wallToRight = wallWidth-(wallToLeft+windowWidth);
		    var upToCeiling = $this.parents('.windowTab').find('[name="ML_CEILING_UP[]"]').val().replace(/,/g,'');
		    var partition = $this.parents('.windowTab').find('[name="ML_NO_OF_PARTITION[]"]').val().replace(/,/g,'');
		    var partitionWidth = $this.parents('.windowTab').find('[name="partitionNewWidth[]"]');
		    var downToCeiling = 20;
		    var domeHeight = $this.parents('.windowTab').find('[name="ML_DOME_HEIGHT[]"]').val().replace(/,/g,'');
		    var corveDepth = $this.parents('.windowTab').find('[name="ML_CORVE_DEPTH[]"]').val().replace(/,/g,'');
		    var cornerDegree = $this.parents('.windowTab').find('[name="ML_CORNER_DEGREE[]"]').val().replace(/,/g,'');
		    var levelType = $this.parents('.windowTab').find("[name='MT_LEVEL_TYPE[]']").val().replace(/,/g,'');		    
		    if (domeHeight<=0) {
			domeHeight=0;
		    }else if (corveDepth<=0) {
			corveDepth=0;
		    }else if (cornerDegree<=0) {
			cornerDegree=0;
		    }
		    var startAngle = 1 * Math.PI;
		    var endAngle = 2 * Math.PI;
		    canvas.height=parseInt(wallHeight)+25;
		    canvas.width=parseInt(wallWidth)+185;
		    var fromLeftForWall=(parseInt(canvas.width)-parseInt(wallWidth))/2;
		    var fromTopForWall=1;
		    var fromLeft = parseInt(wallToLeft)+parseInt(fromLeftForWall);
		    var arcXaxis = fromLeft + (parseInt(windowWidth)/2);
		    var fromTop  = parseInt(upToCeiling)+parseInt(domeHeight)+parseInt(fromTopForWall);
		    //console.log(domeHeight,fromTop,arcXaxis);
		    context.fillStyle = "#747474";
		    context.strokeStyle="#747474";
		    context.beginPath();
		    context.rect(fromLeftForWall,parseInt(fromTopForWall)+parseInt(wallHeight)+7,wallWidth,0);//wallWidthDimemsionline
		    leftArrow(context,fromLeftForWall,parseInt(fromTopForWall)+parseInt(wallHeight)+7);
		    rightArrow(context,parseInt(fromLeftForWall)+parseInt(wallWidth),parseInt(fromTopForWall)+parseInt(wallHeight)+7);
		    context.rect(parseInt(fromLeftForWall)+parseInt(wallWidth)+7,fromTopForWall,0,wallHeight);//wallHeightDimemsionline
		    topArrow(context,parseInt(fromLeftForWall)+parseInt(wallWidth)+7,fromTopForWall);
		    downArrow(context,parseInt(fromLeftForWall)+parseInt(wallWidth)+7,parseInt(fromTopForWall)+parseInt(wallHeight));	    
		    labelForHorizantalDimensions(context,wallWidth,parseInt(fromLeftForWall)+parseInt(wallWidth)/2,parseInt(fromTopForWall)+parseInt(wallHeight)+7);
		    labelForVerticalDimensions(context,wallHeight,parseInt(fromLeftForWall)+parseInt(wallWidth),parseInt(fromTopForWall)+parseInt(wallHeight)/2);		    
		    context.stroke();
		    context.beginPath();
		    context.fillStyle = "#0C6CD0";
		    context.strokeStyle="#FFFFFF";
		    context.fillRect(fromLeftForWall,fromTopForWall,wallWidth,wallHeight);//wall
		    if ((levelType==1 && depth>=1) || (domeHeight>=1 && depth>=1)) {
			context.strokeRect(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(depth), parseInt(windowWidth)-parseInt(2*depth), parseInt(windowHeight)-parseInt(2*depth));//windowDepthBorder
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(depth));
			context.lineTo(fromLeft, fromTop);
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(windowHeight)-parseInt(depth));
			context.lineTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));
			context.moveTo(parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth),parseInt(fromTop)+parseInt(windowHeight)-parseInt(depth));
			context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),parseInt(fromTop)+parseInt(windowHeight));
			context.moveTo(parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth),parseInt(fromTop)+parseInt(depth));
			context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),fromTop);			
		    }
		    if (domeHeight>=1 && depth>=1) {
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(depth));
			context.quadraticCurveTo(parseInt(fromLeft)+parseInt(depth)+parseInt(windowWidth/2)-parseInt(depth), parseInt(fromTop-domeHeight*2)+parseInt(depth), parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth), parseInt(fromTop)+parseInt(depth));//arch
			//context.arc(parseInt(arcXaxis), parseInt(fromTop)+parseInt(depth), domeHeight-parseInt(depth), startAngle, endAngle);//archDepth
			context.stroke();
			context.beginPath();
		    }
		    if (corveDepth>=1 && depth>=1) {
			context.strokeStyle='#FFFFFF';
			fromLeftForDepth = parseInt(wallToLeft)+parseInt(fromLeftForWall)+parseInt(depth);
			fromTopForDepth = parseInt(upToCeiling)+parseInt(domeHeight)+parseInt(fromTopForWall)+parseInt(depth);
			context.moveTo(fromLeftForDepth, fromTopForDepth);//from
			context.quadraticCurveTo(parseInt(fromLeftForDepth)+parseInt(windowWidth/2)-parseInt(depth), parseInt(fromTopForDepth)+parseInt(corveDepth*2)-parseInt(depth), parseInt(fromLeftForDepth)+parseInt(windowWidth)-parseInt(2*depth), fromTopForDepth);			
			context.moveTo(fromLeftForDepth, parseInt(fromTopForDepth)+parseInt(windowHeight)-parseInt(2*depth));
			context.quadraticCurveTo(parseInt(fromLeftForDepth)+parseInt(windowWidth/2)-parseInt(depth), parseInt(fromTopForDepth)+parseInt(windowHeight)-parseInt(corveDepth*2)-parseInt(depth), parseInt(fromLeftForDepth)+parseInt(windowWidth)-parseInt(2*depth), parseInt(fromTopForDepth)+parseInt(windowHeight)-parseInt(2*depth));			
			context.lineTo(parseInt(fromLeftForDepth)+parseInt(windowWidth)-parseInt(2*depth), fromTopForDepth);
			context.moveTo(fromLeftForDepth, fromTopForDepth);
			context.lineTo(fromLeftForDepth, parseInt(fromTopForDepth)+parseInt(windowHeight)-parseInt(2*depth));
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(depth));
			context.lineTo(fromLeft, fromTop);
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(windowHeight)-parseInt(depth));
			context.lineTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));
			context.moveTo(parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth),parseInt(fromTop)+parseInt(windowHeight)-parseInt(depth));
			context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),parseInt(fromTop)+parseInt(windowHeight));
			context.moveTo(parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth),parseInt(fromTop)+parseInt(depth));
			context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),fromTop);
			context.stroke();
		    }
		    if (domeHeight>=1) {
			context.moveTo(fromLeft,fromTop);
			context.quadraticCurveTo(parseInt(fromLeft)+parseInt(windowWidth/2), fromTop-domeHeight*2, parseInt(fromLeft)+parseInt(windowWidth), fromTop);//arch
			context.rect(parseInt(fromLeft)+(parseInt(windowWidth)/2),fromTop-domeHeight,0,domeHeight);
			topArrow(context,parseInt(fromLeft)+(parseInt(windowWidth)/2),fromTop-domeHeight);
			downArrow(context,parseInt(fromLeft)+(parseInt(windowWidth)/2),fromTop);
			context.fillStyle='#FFFFFF';
			labelForVerticalDimensions(context,domeHeight,parseInt(fromLeft)+(parseInt(windowWidth)/2)-7,fromTop-(domeHeight/2));//domeDimension
		    }
		    context.fillStyle='#0C6CD0';
		    if (levelType==1 || domeHeight>=1) {
			context.rect(fromLeft, fromTop, windowWidth, windowHeight);//window
		    }		    
		    context.rect(parseInt(fromLeft), parseInt(fromTop)+parseInt(windowHeight)+7, windowWidth, 0);//windowHeightDimensionLine		   
		    if (depth>=1 && cornerDegree>=1) {
			fromLeftForDepth = parseInt(wallToLeft)+parseInt(fromLeftForWall)+parseInt(depth);
			fromTopForDepth = parseInt(upToCeiling)+parseInt(domeHeight)+parseInt(fromTopForWall)+parseInt(depth);
			context.moveTo(parseInt(fromLeftForDepth)+parseInt(windowWidth/2)-parseInt(depth),  parseInt(fromTopForDepth)+parseInt(cornerDegree));//from
			context.lineTo(fromLeftForDepth, fromTopForDepth);//topLeft
			context.moveTo(parseInt(fromLeftForDepth)+parseInt(windowWidth/2)-parseInt(depth),  parseInt(fromTopForDepth)+parseInt(cornerDegree));//from
			context.lineTo(parseInt(fromLeftForDepth)+parseInt(windowWidth)-parseInt(2*depth), fromTopForDepth);//topRight
			context.strokeStyle="white";
			context.moveTo(parseInt(fromLeftForDepth)+parseInt(windowWidth/2)-parseInt(depth),  parseInt(fromTopForDepth)-parseInt(cornerDegree)+parseInt(windowHeight)-parseInt(2*depth));//from
			context.lineTo(fromLeftForDepth, parseInt(fromTopForDepth)+parseInt(windowHeight)-parseInt(2*depth));//downLeft
			context.moveTo(parseInt(fromLeftForDepth)+parseInt(windowWidth/2)-parseInt(depth),  parseInt(fromTopForDepth)-parseInt(cornerDegree)+parseInt(windowHeight)-parseInt(2*depth));//from
			context.lineTo(parseInt(fromLeftForDepth)+parseInt(windowWidth)-parseInt(2*depth),parseInt(fromTopForDepth)+parseInt(windowHeight)-parseInt(2*depth));//downRight
			context.strokeStyle="white";
			context.rect(fromLeftForDepth, fromTopForDepth, 0, parseInt(windowHeight)-parseInt(2*depth));
			context.rect(parseInt(fromLeftForDepth)+parseInt(windowWidth)-parseInt(2*depth), fromTopForDepth, 0, parseInt(windowHeight)-parseInt(2*depth));
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(depth));
			context.lineTo(fromLeft, fromTop);
			context.moveTo(parseInt(fromLeft)+parseInt(depth), parseInt(fromTop)+parseInt(windowHeight)-parseInt(depth));
			context.lineTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));
			context.moveTo(parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth),parseInt(fromTop)+parseInt(windowHeight)-parseInt(depth));
			context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),parseInt(fromTop)+parseInt(windowHeight));
			context.moveTo(parseInt(fromLeft)+parseInt(windowWidth)-parseInt(depth),parseInt(fromTop)+parseInt(depth));
			context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),fromTop);
			context.stroke();
		    }
		    context.fillStyle = "#FFFFFF";
		    labelForHorizantalDimensions(context,windowWidth,parseInt(fromLeft)+(parseInt(windowWidth)/2),parseInt(fromTop)+parseInt(windowHeight)+7,parseInt(fromTopForWall)+parseInt(wallHeight));//windowWidthDimension
		    labelForVerticalDimensions(context,windowHeight,parseInt(fromLeft)+parseInt(windowWidth),parseInt(fromTop)+(parseInt(windowHeight)/2),"0",parseInt(fromLeftForWall)+parseInt(wallWidth));//windowHeightDimension
		    context.fillStyle = "#0C6CD0";
		    $parentClosest.find('[name="partitionNewWidth[]"]').each(function(){
			$partitionWidthValue=$(this).val().replace(/,/g,'');
			//console.log($partitionWidthValue);
			if ($partitionWidthValue!=null) {
			    fromLeft=parseInt(fromLeft)+parseInt($partitionWidthValue);
			    //console.log($partitionWidthValue,fromLeft);
			    context.strokeRect(fromLeft, fromTop, 0, windowHeight);//paritition
			}
		    });
		    if (corveDepth>=1 || cornerDegree>=1) {
			if (cornerDegree>=1) {			       
			    fromLeft = parseInt(wallToLeft)+parseInt(fromLeftForWall);
			    context.beginPath();
			    context.moveTo(parseInt(fromLeft)+parseInt(windowWidth/2),  parseInt(fromTop)+parseInt(cornerDegree));//from
			    context.lineTo(fromLeft, fromTop);//topLeft
			    context.moveTo(parseInt(fromLeft)+parseInt(windowWidth/2),  parseInt(fromTop)+parseInt(cornerDegree));//from
			    context.lineTo(parseInt(fromLeft)+parseInt(windowWidth), fromTop);//topRight
			    context.strokeStyle="white";
			    context.lineTo(fromLeft, fromTop);//topLeft
			    context.stroke();
			    context.fillStyle = "#0C6CD0";
			    context.fill();
			    context.moveTo(parseInt(fromLeft)+parseInt(windowWidth/2),  parseInt(fromTop)-parseInt(cornerDegree)+parseInt(windowHeight));//from
			    context.lineTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));//downLeft
			    context.moveTo(parseInt(fromLeft)+parseInt(windowWidth/2),  parseInt(fromTop)-parseInt(cornerDegree)+parseInt(windowHeight));//from
			    context.lineTo(parseInt(fromLeft)+parseInt(windowWidth),parseInt(fromTop)+parseInt(windowHeight));//downRight
			    context.strokeStyle="white";
			    context.lineTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));//downLeft
			    context.rect(fromLeft, fromTop, 0, windowHeight);
			    context.rect(parseInt(fromLeft)+parseInt(windowWidth), fromTop, 0, windowHeight);
			    context.stroke();
			    context.fillStyle = "#0C6CD0";
			    context.fill();
			    context.beginPath();
			    context.fillStyle = "#0C6CD0";
			    context.globalCompositeOperation='source-over';
			    context.fillRect(fromLeft, fromTop-1, windowWidth, 1);
			    context.fillRect(fromLeft, parseInt(fromTop)+parseInt(windowHeight), windowWidth, 1);
			    context.strokeStyle="#FFFFFF";
			    context.fillStyle="#FFFFFF";
			    labelForVerticalDimensions(context,cornerDegree,parseInt(fromLeft)+parseInt(windowWidth/2),parseInt(fromTop)+parseInt(cornerDegree)+7,'corner');
			    context.stroke();
			}else{
			    fromLeft = parseInt(wallToLeft)+parseInt(fromLeftForWall);
			    context.beginPath();
			    context.moveTo(fromLeft, fromTop);//from
			    context.quadraticCurveTo(parseInt(fromLeft)+parseInt(windowWidth/2), parseInt(fromTop)+parseInt(corveDepth*2), parseInt(fromLeft)+parseInt(windowWidth), fromTop);			
			    context.fillStyle = "#0C6CD0";
			    context.fill();
			    context.moveTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));
			    context.quadraticCurveTo(parseInt(fromLeft)+parseInt(windowWidth/2), parseInt(fromTop)+parseInt(windowHeight)-parseInt(corveDepth*2), parseInt(fromLeft)+parseInt(windowWidth), parseInt(fromTop)+parseInt(windowHeight));			
			    context.fillStyle = "#0C6CD0";
			    context.fill();
			    context.lineTo(parseInt(fromLeft)+parseInt(windowWidth), fromTop);
			    context.moveTo(fromLeft, fromTop);
			    context.lineTo(fromLeft, parseInt(fromTop)+parseInt(windowHeight));
			    context.strokeStyle="#0C6CD0";			    
			    context.stroke();
			    context.strokeStyle="#FFFFFF";
			    context.fillStyle="#FFFFFF";
			    context.moveTo(parseInt(fromLeft)+parseInt(windowWidth/2)-5, parseInt(fromTop)+parseInt(windowHeight));
			    context.lineTo(parseInt(fromLeft)+parseInt(windowWidth/2)+5, parseInt(fromTop)+parseInt(windowHeight));
			    context.moveTo(parseInt(fromLeft)+parseInt(windowWidth/2), parseInt(fromTop)+parseInt(windowHeight));
			    context.lineTo(parseInt(fromLeft)+parseInt(windowWidth/2),parseInt(fromTop)+parseInt(windowHeight)-parseInt(corveDepth));
			    topArrow(context,parseInt(fromLeft)+parseInt(windowWidth/2),parseInt(fromTop)+parseInt(windowHeight)-parseInt(corveDepth));
			    downArrow(context,parseInt(fromLeft)+parseInt(windowWidth/2), parseInt(fromTop)+parseInt(windowHeight));
			    labelForVerticalDimensions(context,corveDepth,parseInt(fromLeft)+parseInt(windowWidth/2),parseInt(fromTop)-parseInt(corveDepth/2)+parseInt(windowHeight));
			    context.stroke();
			}
		    }
		    context.fillStyle = "#0C6CD0";
		    context.strokeStyle="#FFFFFF";
		    fromLeft = parseInt(wallToLeft)+parseInt(fromLeftForWall);
		    context.strokeRect(parseInt(fromLeft), parseInt(fromTop)+parseInt(windowHeight)+7, windowWidth, 0);//windowWidthDimensionLine
		    leftArrow(context,parseInt(fromLeft),parseInt(fromTop)+parseInt(windowHeight)+7);
		    rightArrow(context,parseInt(fromLeft)+parseInt(windowWidth),parseInt(fromTop)+parseInt(windowHeight)+7);
		    context.strokeRect(parseInt(fromLeft)+parseInt(windowWidth)+7,parseInt(fromTop),0,windowHeight);//windowHeightDimemsionline
		    topArrow(context,parseInt(fromLeft)+parseInt(windowWidth)+7,parseInt(fromTop));
		    downArrow(context,parseInt(fromLeft)+parseInt(windowWidth)+7,parseInt(fromTop)+parseInt(windowHeight)); 
		    context.stroke();
		    $parentClosest.find('[name="ML_FLOOR_DOWN[]"]').val(wallHeight-windowHeight-upToCeiling-domeHeight).formatCurrency();
		    $parentClosest.find('[name="ML_RIGHT_WALL[]"]').val(wallWidth-windowWidth-wallToLeft).formatCurrency();
		}
		function leftArrow(context,x,y) {
		    context.moveTo(x,y);
		    context.lineTo(x+10,y+5);
		    context.moveTo(x,y);
		    context.lineTo(x+10,y-5);
		}
		function rightArrow(context,x,y) {
		    context.moveTo(x,y);
		    context.lineTo(x-10,y+5);
		    context.moveTo(x,y);
		    context.lineTo(x-10,y-5);		    
		}
		function topArrow(context,x,y) {
		    context.moveTo(x,y);
		    context.lineTo(x+5,y+10);
		    context.moveTo(x,y);
		    context.lineTo(x-5,y+10);
		}
		function downArrow(context,x,y) {
		    context.moveTo(x,y);
		    context.lineTo(x+5,y-10);
		    context.moveTo(x,y);
		    context.lineTo(x-5,y-10);
		}
		function labelForHorizantalDimensions(context,dimension,x,y,wallHeight){
		    context.font="20px calibri";
		    context.textAlign = "center";
		    if (y>wallHeight-20) {
			y=y-20;
		    }
		    context.fillText(''+dimension+' cm',x,y+15);
		}
		function labelForVerticalDimensions(context,dimension,x,y,corner,wallWidth){
		    context.font="20px calibri";
		    if (x>wallWidth-70) {
			x=x-62;
		    }
		    if (corner==null || corner==0) {			
			context.textAlign = "left";
			context.fillText(''+dimension+' cm',x+9,y);
		    }else{
			context.textAlign = "center";
			context.fillText(''+dimension+' degree',x+5,y);
		    }
		}
	    </script>
		
		<script type="text/javascript">
		
		function linesModeCheck($this,args) {
		$modeElement=$this.parents('.active_measurement').find('[name="mode[]"]');
		if (args=='roomMeasurement' || args=='wallMeasurement') {
		    $measurementId=$this.parents('.active_measurement').attr('id');
		    $windows=$('button.'+args+'[data-product-id="#'+$measurementId+'"]').closest('li.activeNode').find('.windowMeasurement');
		    $windows.each(function(){
			var productId=$(this).attr('data-product-id');
			$modeElement=$(productId+'.active_measurement').find('[name="mode[]"]');
			if($modeElement.val()!='add'){
			    $modeElement.val('edit');
			}
			if (args=='roomMeasurement') {
			    $currentVal=$this.val();
			    $(productId+'.active_measurement').find('[name="ML_UNIT[]"]').val($currentVal);
			    console.log($(productId+'.active_measurement').find('[name="ML_UNIT[]"]'));
			    console.log($currentVal);
			    console.log(productId);
			}else if (args=='wallMeasurement') {
			    $(productId).find('.activeWindowTab').find('[name="ML_WIDTH[]"]').trigger('keyup');
			}
			//console.log($(productId+'.active_measurement'));
		    });
		}else{
		    if (args=='img') {
			var modalId=$this.parents('form').attr('id');
			console.log(modalId);
			modalId=modalId.replace('_modal_data','');
			console.log(modalId);
			$modeElement=$('#'+modalId).find('[name="mode[]"]');
		    }
		    if($modeElement.val()!='add' ){
			$modeElement.val('edit');
			console.log($this);
		    }
		}
	    }
		
		$('body').delegate('#ML_GYPSUM_YN', 'lcs-statuschange', function()
	    {
		if($(this).is(":checked"))
		{
		    $(this).parent('div').parent('section').find('#mlGypsumYN').val('Y').change();
		    $(this).parent('div').parent('section').parent('div.row').find('.gypsumDetail').removeClass('hide');
		    $('#form_validation').formValidation('addField', 'ML_GYPSUM_WIDTH[]');
		    $('#form_validation').formValidation('addField', 'ML_GYPSUM_HEIGHT[]');
		    $('#form_validation').formValidation('addField', 'ML_GYPSUM_DEPTH[]');
		}
		else
		{
		    $(this).parent('div').parent('section').find('#mlGypsumYN').val('N').change();
		    $gypsumDetail=$(this).parent('div').parent('section').parent('div.row').find('.gypsumDetail').removeClass('has-success has-error').addClass('hide')
		    $gypsumDetail.find('input:text').val('').change();
		    $gypsumDetail.find('i').hide();
		    //$('#form_validation').formValidation('updateStatus', 'ML_GYPSUM_WIDTH[]', 'NOT_VALIDATED');
		}
	    });
	    
	    $('body').delegate('#ML_PELMET', 'lcs-statuschange', function()
	    {
		if($(this).is(":checked"))
		{
		    $(this).parent('div').parent('section').find('#mlPelment').val('Y');
		    $(this).parent('div').parent('section').parent('div.row').find('.designDetail').removeClass('hide');
		    $('#form_validation').formValidation('addField', 'ML_PROJECTION[]');
		    $('#form_validation').formValidation('addField', 'ML_FASICA[]');
		    $('#form_validation').formValidation('addField', 'ML_DESIGN_DEPTH[]');
		}
		else
		{
		    $(this).parent('div').parent('section').find('#mlPelment').val('N');
		    $designDetail=$(this).parent('div').parent('section').parent('div.row').find('.designDetail').removeClass('has-success has-error').addClass('hide')
		    $designDetail.find("[name='ML_PROJECTION[]']").val("");
		    $designDetail.find("[name='ML_FASICA[]']").val("");
		    $designDetail.find("[name='ML_DESIGN_DEPTH[]']").val("");
		    $designDetail.find('i').hide();
		    $('#form_validation').formValidation('removeField', 'ML_PROJECTION[]');
		    $('#form_validation').formValidation('removeField', 'ML_FASICA[]');
		    $('#form_validation').formValidation('removeField', 'ML_DESIGN_DEPTH[]');
		    //$('#form_validation').formValidation('updateStatus', 'ML_GYPSUM_WIDTH[]', 'NOT_VALIDATED');
		}
	    });
	    
	    $('body').delegate('#ML_PARTITIONED_WINDOW_YN', 'lcs-statuschange', function()
	    {
		if($(this).is(":checked"))
		{
		    $(this).parent('div').parent('section').find('#partitionYN').val('Y');
		    $(this).parent('div').parent('section').parent('div.row').next('div.row').find('.partitionDetail').removeClass('hide');
		    //$('#form_validation').formValidation('addField', 'ML_NO_OF_PARTITION[]');
		    
		}
		else
		{
		    $(this).parent('div').parent('section').find('#partitionYN').val('N');
		    $partition=$(this).parent('div').parent('section').parent('div.row').next('div.row');
		    $partitionDetail=$partition.find('.partitionDetail').removeClass('has-success has-error').addClass('hide');
		    $partitionDetail.find('input:text').val('');
		    $partitionDetail.find('i').hide();
		    $partition.find('.partitionRemove').remove();
		    $('#form_validation').formValidation('removeField', 'partitionNewWidth[]');
		}
	    });
	    
	    $('body').delegate('#ML_SITE_READY_YN', 'lcs-statuschange', function()
	    {
		if($(this).is(":checked"))
		{
		    $(this).parent('div').parent('section').find('#SITE_READY_YN').val('Y').change();
		}
		else
		{
		    $(this).parent('div').parent('section').find('#SITE_READY_YN').val('N').change();
		}
	    });
		
	    </script>
		
	    <script type="text/javascript">
	    $(document).ready(function()
	    {
		$('body').addClass('loading').loader('show', { overlay: true });
		$('ul.pager > li:last-child').addClass('disabled').attr('aria-disabled', true);
		setTimeout(function(){
			$('ul.pager > li:last-child').removeClass('disabled');
			$('ul.pager > li:last-child').addClass('enabled').attr('aria-disabled', false);
			$('body').removeClass('loading').loader('hide');
		},2500);
		var elem = document.querySelector('.js-switch');
		var switchery = new Switchery(elem, { size: 'small' });
		FormPlugins.init();
		$('#form_validation').formValidation
		({
		    message: 'This value is not valid',
		    excluded: [':disabled'],
		    container: 'tooltip',
		    feedbackIcons:
		    {
			valid: 'fa fa-check',
			invalid: 'fa fa-times',
			validating: 'fa fa-refresh'
		    },
		    fields:
		    {
			MH_CUST_AC_DESC:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Customer name is required and can\'t be empty'
				}
			    }
			},
			
			MH_CONTACT_PERSON:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Contact person is required and can\'t be empty'
				}
			    }
			},
			
			MH_ADD1:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Address is required and can\'t be empty'
				}
			    }
			},
			
			City:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'City code is required and can\'t be empty'
				}
			    }
			},
			MH_SALE_REF_TXN_CODE:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Reference transaction code is required and can\'t be empty'
				}
			    }
			},
			
			MH_SALE_REF_TXN_NO:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Reference transaction number is required and can\'t be empty'
				}
			    }
			},
			
			ML_BULD_TYPE:
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Building type is required and can\'t be empty'
				}
			    }
			},
			
			'ML_BUILDING[]':
			{
			    group: 'input',
			    validators:
			    {
				notEmpty:
				{
				    message: 'Building name is required and can\'t be empty'
				}
			    }
			},
			'ML_FLOOR[]':
			{
			    group: 'input',
			    validators:
			    {
				notEmpty:
				{
				    message: 'Floor number is required and can\'t be empty'
				}
			    }
			},
			
			'ML_FLAT[]':
			{
			    group: 'input',
			    validators:
			    {
				notEmpty:
				{
				    message: 'Appartment number is required and can\'t be empty'
				}
			    }
			},
			
			'ML_UNIT[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Room type is required and can\'t be empty'
				}
			    }
			},
			
			'ML_ROOM_NO[]':
			{
			    group: 'input',
			    validators:
			    {
				notEmpty:
				{
				    message: 'Room number is required and can\'t be empty'
				}
			    }
			},
			
			'ML_WALL[]':
			{
			    group: 'input',
			    validators:
			    {
				notEmpty:
				{
				    message: 'Wall desc is required and can\'t be empty'
				}
			    }
			},
			
			'ML_WINDOW_NO[]':
			{
			    group: 'input',
			    validators:
			    {
				notEmpty:
				{
				    message: 'Window number is required and can\'t be empty'
				},
				callback:
				{
				    callback: function(value, validator, $field){
					console.log(value);
					if ($.isNumeric(value)==false) {
					    var valu=value.replace(/\D/g,'');
					    $field.val(valu);
					    console.log(valu);
					    if (valu!='') {
						return true;
					    }else{
						return false;						
					    }
					}else{
					    return true;	
					}
				    }
				}
			    }
			},
			
			'ML_WIDTH[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Width is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'Width must be Numeric and Should be in a Format Like:999.99 only'
				},
			    },
			},
			
			'ML_HEIGHT[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Height is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'Height must be Numeric and Should be in a Format Like:999.99 only'
				},
			    },
			},
			
			'MT_LEVEL_TYPE[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Window type is required and can\'t be empty'
				}
			    }
			},
			
			'ML_MOUNT_TYPE[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Mount type is required and can\'t be empty'
				}
			    }
			},
			
			'ML_MOUNT_ON[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Mount on is required and can\'t be empty'
				}
			    }
			},
			
			'ML_OPERATE[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Operation is required and can\'t be empty'
				}
			    }
			},
			
			'ML_CONTROL[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Control is required and can\'t be empty'
				}
			    }
			},
			
			'ML_OPENING[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Opening is required and can\'t be empty'
				}
			    }
			},
			
			'ML_PROJECTION[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_FASICA[]':
			{
			    validators:
			    {
				//notEmpty:
				//{
				//    message: 'FASICA is required and can\'t be empty'
				//}
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			'ML_DESIGN_DEPTH[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			'ML_FULL_WIDTH[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Full width is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			'ML_FULL_HEIGHT[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Full height is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_LEFT_WALL[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Left wall is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_CEILING_UP[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Ceiling up is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_WINDOW_DEPTH[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Window depth is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_WINDOW_OPENING[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Window opening is required and can\'t be empty'
				}
				
			    }
			},
			
			'ML_HANDLE_POSITION[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Handle position is required and can\'t be empty'
				}
			    }
			},
			'ML_HANDLE_SIZE[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Handle size is required and can\'t be empty'
				},
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_POWER_DISTANCE[]':
			{
			    validators:
			    {
				notEmpty:
				{
				    message: 'Power Distance is required and can\'t be empty'
				}
			    }
			},
			/*
			'ML_GYPSUM_WIDTH[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_GYPSUM_HEIGHT[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_GYPSUM_DEPTH[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			
			'ML_NO_OF_PARTITION[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
			*/
			'partitionNewWidth[]':
			{
			    validators:
			    {
				regexp:
				{
				    regexp: /^[0-9.,]+$/,
				    message: 'This Field must be Numeric and Should be in a Format Like:999.99 only'
				},
			    }
			},
		    }
		});
	    });
		var isValidTab='';
		function saveWholeData(arg){
			$('body').addClass('loading').loader('show', { overlay: true });
			if(localStorage.getItem("DeletedWindow")){
				
			}else{
				$('#form_validation').formValidation('validate');
			}
			$('div.pager').find('[name="save"]').attr('class','btn btn-sm btn-success disabled');
			$('div.pager').find('[name="saveAndEdit"]').attr('class','btn btn-sm btn-primary disabled');
			var retVal=errorDataCall();
			if(retVal==0){
				getWholeData(arg);
			}else{
				$('body').removeClass('loading').loader('hide');
				rmDisableSave();
			}
			//setTimeout(getWholeData,500,arg);
			setTimeout(rmDisableSave,3000);
			//errorDataCall();
		}
		
		function errorDataCall(){
			var errorCount=0;
		    $('[name="ML_BUILDING[]"]').closest('li').find('p').remove();
			if ($('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').html()==null) {
			    $('[name="ML_BUILDING[]"]').closest('li:visible').append('<p style="color:red">Please add until Window</p>');
			    errorCount++;
			}
		    $('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
			//floor		
			$(this).find('p').remove();
			if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
			    $(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
			    $(this).append('<p style="color:red">Please add until Window</p>');
			    errorCount++;
			}
			$(this).children('ul.activeNode').children('li.activeNode').each(function (){
			    //appartment
			    if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				$(this).append('<p style="color:red">Please add until Window</p>');
				errorCount++;
			    }
			    $(this).children('ul.activeNode').children('li.activeNode').each(function (){
				//room
				if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				    $(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				    $(this).append('<p style="color:red">Please add until Window</p>');
				    errorCount++;
				}
				$(this).children('ul.activeNode').children('li.activeNode').each(function (){
				    //wall
				    if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
					$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
					$(this).append('<p style="color:red">Please add until Window</p>');
					errorCount++;
				    }
				    $(this).children('ul.activeNode').children('li.activeNode').each(function (){
					
				    });
				});
			    });
			});
		    });
			return errorCount;
		}
		
		function getWholeData(arg){
			//alert(arg);
			//$('#form_validation').formValidation('validate');
			var isValidTab = windowCheck(1,2);
			if (isValidTab!=true || $.isPlainObject(isValidTab)==true)
			{
				$('#step2').find('.validationAlert').remove();
				if (isValidTab!=false) {
					$('body').removeClass('loading').loader('hide');
					$('div.pager').find('[name="save"]').attr('class','btn btn-sm btn-success');
					$('div.pager').find('[name="saveAndEdit"]').attr('class','btn btn-sm btn-primary');
					$('#step2').prepend('<div class="validationAlert alert alert-danger outer"><a href="#" class="close" data-dismiss="alert" aria-label="close" title="close">&times;</a><strong>'+isValidTab.tree+', '+isValidTab.room+', '+isValidTab.wall+', '+isValidTab.window+' </strong>fields are empty! please fill it</div>');  
				}
				return false;
			}else if (isValidTab==true){
				$('#step2').find('.validationAlert').remove();
				//alert(arg);
				//errorDataCall();
				var treeTabValid;
				setTimeout(function(){
					treeTabValid = submitTreeFields(arg);
					//alert(treeTabValid);
					if (treeTabValid==0 && arg=='proceed') {
						setTimeout(function(){
							$('body').removeClass('loading').loader('hide');
							alert("Measurement Values Are Successfully Inserted");
							window.location="ScheduleTrackingDashboard_View.html";
						},30000);
					}else{
						localStorage.setItem("Mode", "edit_mode");
						localStorage.setItem("GetDataTree","OfflineNewData");
						setTimeout(function(){
							if(arg=='proceed'){
								//$('body').removeClass('loading').loader('hide');
								alert("Measurement Values Are Successfully Inserted");
								window.location="ScheduleTrackingDashboard_View.html";
							}else{
								//$('body').removeClass('loading').loader('hide');
								window.location="Measure_Edit.html";
							}
						},30000);
					}
				},500);
				//submitTreeFields(arg);
			}
		}
		
		function rmDisableSave(){
			//$('body').removeClass('loading').loader('hide');
			$('div.pager').find('[name="save"]').attr('class','btn btn-sm btn-success');
			$('div.pager').find('[name="saveAndEdit"]').attr('class','btn btn-sm btn-primary');
		}
		
	    $('#wizard').bwizard
	    ({
		validating: function (e, ui)
		{
		    var numTabs= $('#form_validation').find('.tab-pane').length;
		    $('#form_validation').formValidation('validate');
		    var index=ui['index'];
		    var nextIndex=ui['nextIndex'];
		    if (index==0 && nextIndex==1) {
				/*var CheckMode = localStorage.getItem("LiveMode");
				//alert("CheckMode->"+CheckMode);
				if(CheckMode=="live_edit_mode"){
					generateLiveEditModeMeasurementTree();
				}else{
					//var Mode = localStorage.getItem("Mode", "edit_mode");
					var Mode = localStorage.getItem("Mode");
					//alert("Mode->"+Mode);
					if(Mode == "edit_mode"){
						//generateMeasurementTree();
						tets123();
					}
				}*/
				setTimeout(function(){
					setTimeout(PreviousDisableEdit, 1000);
					mappingProductIdToWallAndRoom();
					labelNumbering();
					setTimeout(function(){
						$('body').removeClass('loading').loader('hide');
					},5000);
					$('.lcs_check').trigger('lcs-statuschange');
					$('[name="ML_PELMET[]"]').trigger('change');
					$('[name="measurement[]"]').click();
					$('[name="MT_LEVEL_TYPE[]"]').trigger('change');
					isValidTab = validateTab1(index);
					$("#buildingDetails").find('.room:first').click();
					$('#form_validation').formValidation('addField','ML_BUILDING[]');
					$('#form_validation').formValidation('addField','ML_FLOOR[]');
					$('#form_validation').formValidation('addField','ML_FLAT[]');
					$('#form_validation').formValidation('addField','ML_ROOM_NO[]');
					$('#form_validation').formValidation('addField','ML_WALL[]');
					$('#form_validation').formValidation('addField','ML_WINDOW_NO[]');
				},500);
				$('body').addClass('loading').loader('show', { overlay: true });
			
		    }
		    $('.selectpicker').selectpicker('refresh');
		    $('#form_validation').formValidation('updateStatus', 'ML_BUILDING[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_BULD_TYPE', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_UNIT[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'MT_LEVEL_TYPE[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_MOUNT_TYPE[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_MOUNT_ON[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_OPERATE[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_CONTROL[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_OPENING[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_PELMET[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_WINDOW_OPENING[]', 'NOT_VALIDATED');
		    $('#form_validation').formValidation('updateStatus', 'ML_HANDLE_POSITION[]', 'NOT_VALIDATED');
		}
	    });
	    
	    function validateTab1(index)
	    {
		var fv = $('#form_validation').data('formValidation');
		$tab = $('#form_validation').find('.headTab');
		//console.log($tab);
		var isValidStep = fv.isValidContainer($tab);
		if (isValidStep === false || isValidStep === null)
		{
		    return false;
		}
		return true;
	    }
		
		function PreviousDisableEdit(){
			$('ul.pager > li:first-child').addClass('disabled').attr('aria-disabled', true);
		}
		
	    function windowCheck(index,nextIndex) {		
		if (index==1 && nextIndex==2) {
		    $('.active_measurement').find('[name="MT_LEVEL_TYPE[]"]').trigger('change');
		}
		var errorCount=0;
		$('[name="ML_BUILDING[]"]').closest('li').find('p').remove();
		    if ($('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').html()==null) {
			$('[name="ML_BUILDING[]"]').closest('li:visible').append('<p style="color:red">Please add until Wall</p>');
			errorCount++;
		    }
		$('[name="ML_BUILDING[]"]').closest('li.activeNode').children('ul.activeNode').children('li.activeNode').each(function (){
		    //floor		
		    $(this).find('p').remove();
		    if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
			$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
			$(this).append('<p style="color:red">Please add until Window</p>');
			errorCount++;
		    }
		    $(this).children('ul.activeNode').children('li.activeNode').each(function (){
			//appartment
			if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
			    $(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
			    $(this).append('<p style="color:red">Please add until Window</p>');
			    errorCount++;
			}
			$(this).children('ul.activeNode').children('li.activeNode').each(function (){
			    //room
			    if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				$(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				$(this).append('<p style="color:red">Please add until Window</p>');
				errorCount++;
			    }
			    $(this).children('ul.activeNode').children('li.activeNode').each(function (){
				//wall
				if($(this).children('ul.activeNode').children('li.activeNode').html()==null){
				    $(this).parents('ul#measurementTab').find('.glyphicon-plus').click();
				    $(this).append('<p style="color:red">Please add until Window</p>');
				    errorCount++;
				}
			    });
			});
		    });
		});
		//console.log(errorCount,'errCount');
		//alert(errorCount);
		if(errorCount==0){
		    return $returnValue=validateTab(index);
		}else{
		    return false;
		}
	    }
	    //console.log(windowCheck());
	    function validateTab(index)
	    {
		//alert("validateTab");
		$windowCount='';
		$treeValidationResult='';
		$roomValidationResult='';
		$wallValidationResult='';
		$windowValidationResult='';
		$treeValidationResults=[];
		$roomValidationResults=[];
		$wallValidationResults=[];
		$windowValidationResults=[];
		$treeTab = $('#form_validation').find('fieldset.treeTab');
		$roomTab = $('#form_validation').find('.tab-pane.active_measurement').find('.activeRoomTab');
		$wallTab = $('#form_validation').find('.tab-pane.active_measurement').find('.activeWallTab');
		$windowTab = $('#form_validation').find('.tab-pane.active_measurement').find('.activeWindowTab');
		$windowCount=$windowTab.length;
		console.log($windowCount);
		$treeCountAfterValidation=0;
		if ($treeTab.find('.has-error').length >= 1) {
		    $treeValidationResult='Tree';
		    $treeValidationResults.push($treeValidationResult);
		    $treeCountAfterValidation++;
		}else{
		    $treeValidationResult=true;
		}
		$roomCountAfterValidation=0;
		$roomTab.each(function(){
		    $isValidRoom=$(this).find('.has-error');
		    console.log($isValidRoom.length,'isvalidrrom');
		    if ($isValidRoom.length >= 1) {
			$roomCountAfterValidation++;
			$roomValidationHeading=$(this).find('legend').text();
			$roomValidationDivId=$(this).parents('.tab-pane.active_measurement').attr('id');
			$roomValidationResult='<button data-product-id="#'+$roomValidationDivId+'" onclick="showRoomTab($(this))" >'+$roomValidationHeading+'</button>';
			$roomValidationResults.push($roomValidationResult);
			console.log($roomValidationResults,'b4return');		   
		    }else{
			$roomValidationResult=true;
			console.log('$roomValidationResult :',$roomValidationResult);
		    }
		});
		$wallCountAfterValidation=0;
		$wallTab.each(function(){
		    $isValidWall=$(this).find('.has-error');
		    console.log($isValidWall.length,'isvalidwall');
		    if ($isValidWall.length >= 1) {
			$wallCountAfterValidation++;
			$wallValidationHeading = $(this).find('legend').text();
			$wallValidationDivId=$(this).parents('.tab-pane.active_measurement').attr('id');
			$wallValidationResult='<button data-product-id="#'+$wallValidationDivId+'" onclick="showWallTab($(this))" >'+$wallValidationHeading+'</button>';
			$wallValidationResults.push($wallValidationResult);
			console.log($wallValidationResults,'b4return');
		    }else{
			$wallValidationResult=true;
		    }
		    console.log('$wallValidationResult :',$wallValidationResult);
		});
		$windowCountAfterValidation=0;
		$windowCheck=0;
		$windowTab.each(function(){
		    $(this).find('.panel').removeClass('panel-danger').addClass('panel-success');
		    $isValidWindow=$(this).find('.has-error');
		    $isValidWinodowDiv=$isValidWindow.parents('.panel.panel-success').removeClass('panel-success').addClass('panel-danger');
		    console.log($isValidWinodowDiv);
		    $windowCheck++;
		    console.log($isValidWindow.length,'isvalidwndw');
		    if ($isValidWindow.length >= 1) {
			$windowCountAfterValidation++;
			$windowValidationHeading = $(this).find('legend').text();
			$windowValidationDivId=$(this).parents('.tab-pane.active_measurement').attr('id');
			$windowValidationResult='<button data-product-id="#'+$windowValidationDivId+'" onclick="showWindowTab($(this))" >'+$windowValidationHeading+'</button>';
			$windowValidationResults.push($windowValidationResult);
			console.log($windowValidationResults,$isValidWindow,'b4return');
		    }else{
			$windowValidationResult=true;
		    }
		    console.log('$windowValidationResult :',$windowValidationResult);
		    
		});
		    console.log($treeValidationResults,$roomValidationResults,$wallValidationResults,$windowValidationResults);
		    console.log($windowCountAfterValidation,$windowCount,$windowValidationResults);
		if ($windowCountAfterValidation!=0 || $wallCountAfterValidation!=0 || $roomCountAfterValidation!=0 || $treeCountAfterValidation!=0) {			    
		    var validationResult = {};
		    validationResult.tree = $treeValidationResults;
		    validationResult.room = $roomValidationResults;
		    validationResult.wall = $wallValidationResults;
		    validationResult.window = $windowValidationResults;
		    validationResult.status = false;
		    console.log(validationResult,'bn4returnreustl');
		}console.log(validationResult,'bn4returnreustl');
		console.log('$treeValidationResult:',$treeValidationResult,'$roomValidationResult:',$roomValidationResult,'$wallValidationResult:',$wallValidationResult,'$windowValidationResult:',$windowValidationResult,'$treeValidationResult:',$windowCountAfterValidation,'$wallCountAfterValidation:',$wallCountAfterValidation,'$roomCountAfterValidation:', $roomCountAfterValidation,'$treeCountAfterValidation:',$treeCountAfterValidation);
		if ($treeValidationResult==true && $roomValidationResult==true && $wallValidationResult==true && $windowValidationResult==true && $windowCountAfterValidation==0 && $wallCountAfterValidation==0 && $roomCountAfterValidation==0 && $treeCountAfterValidation==0) {
		    return true;
		}else{
		    return validationResult;
		
		}
	    }
	    
	    $(document).ready(function()
	    {
		FormWizard.init();
		switcherRefresh();
		mappingProductIdToWallAndRoom();
		labelNumbering();
		//$('.lcs_check').trigger('lcs-statuschange');
		$('.room').trigger('click');
		$('.wall').trigger('click');
		$('.window').trigger('click');
	    });
	    
	</script>
    </body>
</html>
<script>

    $(document).ready(function()
    {
	$("#ML_BULD_TYPE").change(function()
	{
	    var ML_BULD_TYPE = $("#ML_BULD_TYPE").val();
	    if(ML_BULD_TYPE=="BLGD")
	    {
		$("#buildingDetails").show();
		$('[name="ML_BUILDING[]"]').closest('div').prev().text('Building');
	    }
	    else if(ML_BULD_TYPE=="VILLA")
	    {
		$("#buildingDetails").show();
		$('[name="ML_BUILDING[]"]').closest('div').prev().text('Villa');
	    }
	});
    });
    
</script>
<div class="modal fade" id="imgPreview" role="dialog">
    <div class="modal-dialog">
	<div class="modal-content">
	    <div class="modal-header">
		<img src="assets/img/mantis_logo.jpg" data-id="login-cover-image" alt="" />
		<button aria-hidden="true" data-dismiss="modal" class="close" type="button" onClick="onClickHandler(this)"><i class="fa  fa-times-circle "></i></button>
	    </div>
	    <div class="modal-body displayImg">
		
	    </div>
	    <div class="modal-footer">
		<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	    </div>
	</div>
    </div>
</div>
<script>

/*
    function getImagePreview($this)
    {
		var CheckMode = localStorage.getItem("SubmitMode");
		if(CheckMode=='wait'){
			var Imgid=$this.attr('data-target')
			var id=$this.attr('data-target').split('_');			
			var currentId=id[1];
			//alert(Imgid+"=="+currentId);
			var measurementId='#measurementId_'+currentId;
			var dataURL = $(measurementId).find('#myCanvas')[0].toDataURL();
			//alert(dataURL);
			$(Imgid).find("."+currentId).remove();
			$(Imgid).find("#Imagecount").append('<div id="RemoveImg" class="form-group '+currentId+'"><span onclick="DeleteImgServe($(this),'+currentId+')" class="close glyphicon glyphicon-trash"></span><img id="imgProfile" name="imgProfile[]" src="'+dataURL+'" style="width:50%;height:50%"><input type="hidden" name="mode[]" value="edit"></div>');
		}	
    }    */
</script>
<script>
    
    function switcherRefresh()
    {
	$('.lcs_check').lc_switch('Y','N');
    }
    $(".ML_BUILD").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
    
    $(".ML_REMARKS").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
    
    $(".ML_PROJECTION").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
 
    $(".ML_FASICA").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
    
    $(".ML_WINDOW_NO").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
    
    $(".ML_FLAT").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
    
    $(".ML_ROOM_NO").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
 
    $(".ML_FLOOR").keyup(function ()
    {
	$(this).val($(this).val().replace(/^\s+/,""));
    });
    
    function partitiontest($this)
    {
	$parent = $this.parents('div.active_measurement');
	$partition = $this.val();
	if ($partition<=10)
	{
	    $parent.find('.partitionRemove').remove();
	    for(i=1;i<=$partition;i++)
	    {
		$this.parent('section').parent('div.row').append("<section class='col-md-3 partitionRemove form-group'><label class='control-label'>Partition Width-"+i+"</label><input maxlength='12' type='text' name='partitionNewWidth[]' onkeyup='previewChanges($(this));' class='form-control input-sm'></section>");
		$('#form_validation').formValidation('addField', 'partitionNewWidth[]');
	    }
	}
	else if ($partition>=10)
	{
	    bootbox.confirm("No.of Partition Should be 10 and less than 10", function(confirmed)
	    {   
		if (confirmed)
		{
		    $('.partitionRemove').remove();
		}    
	    });
	}
    }
    </script>
	<script>
	function windowTypeInputs($this) {
	$windowType=$this.val();
	$parent=$this.parent().parent();
	if ($windowType==01) {
	    $this.parents('.windowTab').find('.noWindow').show();
	    $parent.find('.ML_DOME_HEIGHT_SECTION').hide().find('[name="ML_DOME_HEIGHT[]"]').val('');
	    $parent.find('.ML_CORNER_DEGREE_SECTION').hide().find('[name="ML_CORNER_DEGREE[]"]').val('');
	    $parent.find('.ML_CORVE_DEPTH_SECTION').hide().find('[name="ML_CORVE_DEPTH[]"]').val('');
	}else if ($windowType==02) {
	    $this.parents('.windowTab').find('.noWindow').show();
	    $parent.find('.ML_DOME_HEIGHT_SECTION').show();
	    $parent.find('.ML_CORNER_DEGREE_SECTION').hide().find('[name="ML_CORNER_DEGREE[]"]').val('');
	    $parent.find('.ML_CORVE_DEPTH_SECTION').hide().find('[name="ML_CORVE_DEPTH[]"]').val('');
	}else if ($windowType==03) {
	    $this.parents('.windowTab').find('.noWindow').show();
	    $parent.find('.ML_DOME_HEIGHT_SECTION').hide().find('[name="ML_DOME_HEIGHT[]"]').val('');
	    $parent.find('.ML_CORNER_DEGREE_SECTION').show();
	    $parent.find('.ML_CORVE_DEPTH_SECTION').hide().find('[name="ML_CORVE_DEPTH[]"]').val('');
	}else if ($windowType==04) {
	    $this.parents('.windowTab').find('.noWindow').show();
	    $parent.find('.ML_DOME_HEIGHT_SECTION').hide().find('[name="ML_DOME_HEIGHT[]"]').val('');
	    $parent.find('.ML_CORNER_DEGREE_SECTION').hide().find('[name="ML_CORNER_DEGREE[]"]').val('');
	    $parent.find('.ML_CORVE_DEPTH_SECTION').show();
	}else if ($windowType==05) {
	    $this.parents('.windowTab').find('.noWindow').hide();
	    $parent.find('.ML_DOME_HEIGHT_SECTION').hide().find('[name="ML_DOME_HEIGHT[]"]').val('');
	    $parent.find('.ML_CORNER_DEGREE_SECTION').hide().find('[name="ML_CORNER_DEGREE[]"]').val('');
	    $parent.find('.ML_CORVE_DEPTH_SECTION').hide().find('[name="ML_CORVE_DEPTH[]"]').val('');
	    $this.parents('.windowTab').find('.noWindow').find('input, select').val('');
	    $mode=$this.parents('.active_measurement').find('[name="mode[]"]').val();
	    if ($mode=='edit') {
		$this.parents('.windowTab').find('.noWindow').each(function (){
		    $(this).find('input').each(function(){
			$('#form_validation').formValidation('updateStatus', $(this), 'VALID');
		    });
		    $(this).find('select').each(function(){
			$('#form_validation').formValidation('updateStatus', $(this), 'VALID');
		    });
		});
	    }else{
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_WIDTH[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_HEIGHT[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_LEFT_WALL[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_RIGHT_WALL[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_FLOOR_DOWN[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_CEILING_UP[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_WINDOW_DEPTH[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_WINDOW_OPENING[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_HANDLE_POSITION[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_HANDLE_SIZE[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_POWER_DISTANCE[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='MT_LEVEL_TYPE[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_MOUNT_TYPE[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_MOUNT_ON[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_OPERATE[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_CONTROL[]']"));
		$('#form_validation').formValidation('updateStatus', $this.parents('.active_measurement').find("[name='ML_OPENING[]']"));	    
	    }
	}		    
	if ($windowType!=05 && $windowType!=null) {
	    $this.parents('.windowTab').find('.noWindowValidation').each(function (){
		$(this).find('input').each(function(){
		    $('#form_validation').formValidation('revalidateField', $(this));
		});
		$(this).find('select').each(function(){
		    $('#form_validation').formValidation('revalidateField', $(this));
		});
	    });
	}
    }
</script>

<ul class="floorList hide collapse in">
    <li class="input-group"><span class="label sedar-color">Floor</span>
        <div class="input-group">
            <span class="input-group-btn">
                <button type="button" class="btn sedar-color btn-xs glyphicon glyphicon-minus" onclick="closeChildren($(this))"></button>				
            </span>					    
            <input disabled name="ML_FLOOR[]" class='form-control input-sm sedar' type='text' data-level-id='2' data-mode="add" data-toggle="tooltip" onchange="treeModeCheck($(this))"/>
            <span class="input-group-btn">
                <button type="button" class='btn btn-success btn-sm' onclick="addChildNode($(this),'.appartmentList')"><i class="fa fa-plus"></i></button>					    
                <button type="button" class='btn sedar-white btn-sm' onclick="removeCurrentNodeForAdd($(this),'deleteProduct')"><i class="fa fa-trash"></i></button>
            </span>
        </div>
    </li>
</ul>
<ul class="appartmentList hide collapse in">
  <li class="input-group"><span class="label sedar-color">Apartment</span>
      <div class="input-group">
          <span class="input-group-btn">
              <button type="button" class="btn sedar-color btn-xs glyphicon glyphicon-minus" onclick="closeChildren($(this))"></button>				
          </span>					    
          <input disabled name="ML_FLAT[]" class='form-control input-sm sedar' type='text' data-level-id='3' data-mode="add" data-toggle="tooltip" onchange="treeModeCheck($(this))"/>
          <span class="input-group-btn">
              <button type="button" class='btn btn-success btn-sm' onclick=addWindowAndProduct($(this),"room",".roomList")><i class="fa fa-plus"></i></button>					    
              <button type="button" class='btn sedar-white btn-sm' onclick="removeCurrentNodeForAdd($(this),'deleteProduct')"><i class="fa fa-trash"></i></button>
          </span>
      </div>
    </li>
</ul>
<ul class="roomList hide collapse in">
  <li class="input-group"><span class="label sedar-color">Room</span>
      <div class="input-group">
          <span class="input-group-btn">
              <button type="button" class="btn sedar-color btn-xs glyphicon glyphicon-minus" onclick="closeChildren($(this))"></button>				
          </span>					    
          <input disabled name="ML_ROOM_NO[]" class='form-control input-sm sedar' type='text' data-level-id='4' data-mode="add" onkeyup="headingChange($(this),'.roomTab')" data-toggle="tooltip" onchange="treeModeCheck($(this))"/>
          <span class="input-group-btn">
              <button type="button" class='btn btn-success btn-sm' onclick="showRoomTab($(this))" name="measurement[]"><i class="fa fa-road"></i></button>
              <button type="button" class='btn btn-success btn-sm' onclick=addWindowAndProduct($(this),"wall",".wallList")><i class="fa fa-plus"></i></button>					    
              <button type="button" class='btn sedar-white btn-sm' onclick="removeCurrentNodeForAdd($(this),'deleteProduct')"><i class="fa fa-trash"></i></button>
          </span>
      </div>
    </li>
</ul>
<ul class="wallList  hide collapse in">
  <li class="Wall input-group"><span class="label sedar-color">Wall</span>
    <div class="input-group">
        <span class="input-group-btn">
            <button type="button" class="btn sedar-color btn-xs glyphicon glyphicon-minus" onclick="closeChildren($(this))"></button>				
        </span>					    
        <input disabled name="ML_WALL[]" class='form-control input-sm sedar' type='text' data-level-id='5' data-mode="add" onkeyup="headingChange($(this),'.wallTab')" data-toggle="tooltip" onchange="treeModeCheck($(this))"/>
        <span class="input-group-btn">
            <button type="button" class='btn btn-success btn-sm' onclick="showWallTab($(this))" name="measurement[]"><i class="fa fa-road"></i></button>
            <button type="button" class='btn btn-success btn-sm' onclick=addWindowAndProduct($(this),"window",".windowList") ><i class="fa fa-plus"></i></button>					    
            <button type="button" class='btn sedar-white btn-sm' onclick="removeCurrentNodeForAdd($(this),'wall')"><i class="fa fa-trash"></i></button>
        </span>
    </div>
    </li>
</ul>
<ul class="windowList hide collapse in">
    <input type="hidden" name="mode[]" value="add">
    <li class="input-group"><span class="label sedar-color">Window</span>
        <div class="input-group">
            <span class="input-group-btn">
                <button type="button" class="btn sedar-color btn-xs glyphicon glyphicon-minus" onclick="closeChildren($(this))"></button>				
            </span>					    
            <input disabled name="ML_WINDOW_NO[]" class='form-control input-sm sedar' type='text' data-level-id='6' data-mode="add" onkeyup="headingChange($(this),'.windowTab')" data-toggle="tooltip" onchange="treeModeCheck($(this))"/>
            <span class="input-group-btn">
                <button type="button" class='btn btn-success btn-sm' onclick="showWindowTab($(this))" name="measurement[]"><i class="fa fa-road"></i></button>					    
                <button type="button" class='btn sedar-white btn-sm' onclick="removeCurrentNodeForAdd($(this),'window')"><i class="fa fa-trash"></i></button>
            </span>
        </div>
    </li>
</ul>